<!DOCTYPE html>
<html lang="ce">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hayahayao.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="ã•ãŠã‚Šã®Blog">
<meta property="og:url" content="https://hayahayao.github.io/index.html">
<meta property="og:site_name" content="ã•ãŠã‚Šã®Blog">
<meta property="og:locale">
<meta property="article:author" content="hayahayao">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://hayahayao.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'ce'
  };
</script>

  <title>ã•ãŠã‚Šã®Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ã•ãŠã‚Šã®Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">ç‡ƒãˆã¦æ•£ã£ãŸèŠ±ã¨ãªã‚Œã€‚</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="ce">
    <link itemprop="mainEntityOfPage" href="https://hayahayao.github.io/2022/04/12/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="hayahayao">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ã•ãŠã‚Šã®Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/12/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" class="post-title-link" itemprop="url">å‰ç«¯æ€§èƒ½ä¼˜åŒ–</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-04-12 21:22:00" itemprop="dateCreated datePublished" datetime="2022-04-12T21:22:00+08:00">2022-04-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-08-23 01:33:51" itemprop="dateModified" datetime="2023-08-23T01:33:51+08:00">2023-08-23</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="å‰ç«¯æ€§èƒ½ä¼˜åŒ–"><a href="#å‰ç«¯æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="å‰ç«¯æ€§èƒ½ä¼˜åŒ–"></a>å‰ç«¯æ€§èƒ½ä¼˜åŒ–</h1><h2 id="æ€§èƒ½æŒ‡æ ‡"><a href="#æ€§èƒ½æŒ‡æ ‡" class="headerlink" title="æ€§èƒ½æŒ‡æ ‡"></a>æ€§èƒ½æŒ‡æ ‡</h2><h3 id="FCP"><a href="#FCP" class="headerlink" title="FCP"></a>FCP</h3><h3 id="LCP"><a href="#LCP" class="headerlink" title="LCP"></a>LCP</h3><h3 id="äº§å“çš„å…³é”®è·¯å¾„"><a href="#äº§å“çš„å…³é”®è·¯å¾„" class="headerlink" title="äº§å“çš„å…³é”®è·¯å¾„"></a>äº§å“çš„å…³é”®è·¯å¾„</h3><p>è‡ªè¡ŒåŸ‹ç‚¹</p>
<h2 id="å¦‚ä½•åˆ†ææ€§èƒ½"><a href="#å¦‚ä½•åˆ†ææ€§èƒ½" class="headerlink" title="å¦‚ä½•åˆ†ææ€§èƒ½"></a>å¦‚ä½•åˆ†ææ€§èƒ½</h2><h3 id="Performance-Lighthouse"><a href="#Performance-Lighthouse" class="headerlink" title="Performance Lighthouse"></a>Performance Lighthouse</h3><h3 id="å…¨é“¾è·¯åŸ‹ç‚¹"><a href="#å…¨é“¾è·¯åŸ‹ç‚¹" class="headerlink" title="å…¨é“¾è·¯åŸ‹ç‚¹"></a>å…¨é“¾è·¯åŸ‹ç‚¹</h3><p>åˆ†æè¿‡åï¼Œå¸Œæœ›èƒ½å¤Ÿå¾—åˆ°ä¸€ä¸ªåŠ è½½çš„æµç¨‹å›¾ï¼Œæ ‡æ˜æ¯ä¸ªæ­¥éª¤çš„ç”¨æ—¶</p>
<p>ç„¶åå°±å¯ä»¥é’ˆå¯¹æ€§åœ°è§£å†³ç”¨æ—¶é•¿çš„é‚£äº›æ­¥éª¤</p>
<p>ä¸€äº›å¸¸è§çš„ç”¨æ—¶é•¿çš„æ­¥éª¤ï¼š</p>
<ul>
<li>é™æ€èµ„æºåŠ è½½&amp;è§£ææ‰§è¡Œ</li>
<li>å›¾ç‰‡çš„åŠ è½½</li>
<li>æ¥å£è°ƒç”¨</li>
</ul>
<h2 id="å¸¸è§çš„æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µ"><a href="#å¸¸è§çš„æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µ" class="headerlink" title="å¸¸è§çš„æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µ"></a>å¸¸è§çš„æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µ</h2><h3 id="å‡å°èµ„æºä½“ç§¯"><a href="#å‡å°èµ„æºä½“ç§¯" class="headerlink" title="å‡å°èµ„æºä½“ç§¯"></a>å‡å°èµ„æºä½“ç§¯</h3><h4 id="js-cssèµ„æº"><a href="#js-cssèµ„æº" class="headerlink" title="js&#x2F;cssèµ„æº"></a>js&#x2F;cssèµ„æº</h4><ul>
<li>åˆ†åŒ…ï¼Œæå–å…¬å…±ä»£ç </li>
<li>å¼‚æ­¥ï¼ˆåŠ¨æ€ï¼‰ç»„ä»¶ï¼Œéé¦–å±éœ€è¦çš„ä»£ç ä¸åŠ è½½</li>
<li>babelçš„ç²¾ç»†åŒ–é…ç½®ï¼Œä»¿vue-cliçš„modern mode</li>
</ul>
<p>åˆ†æå·¥å…·ï¼š<br>webpack analyze plugin</p>
<h4 id="å›¾ç‰‡èµ„æº"><a href="#å›¾ç‰‡èµ„æº" class="headerlink" title="å›¾ç‰‡èµ„æº"></a>å›¾ç‰‡èµ„æº</h4><ul>
<li>å›¾ç‰‡å‹ç¼©<ul>
<li>ä¸Šä¼ æ—¶å‹ç¼©</li>
<li>ä¸è®¾è®¡è¾¾æˆå›¾ç‰‡ä½“ç§¯é™åˆ¶å…±è¯†</li>
</ul>
</li>
<li>å›¾ç‰‡è½¬webpæ ¼å¼<ul>
<li>å¯¹äºå›ºå®šçš„ä»£ç å¦‚webpæ£€æµ‹ï¼Œå¦‚ä½•è‡ªåŠ¨æ³¨å…¥ï¼Ÿ</li>
<li>postcssï¼Œè‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„cssï¼Ÿ</li>
</ul>
</li>
</ul>
<h3 id="æ›´å¥½åœ°åˆ©ç”¨ç¼“å­˜"><a href="#æ›´å¥½åœ°åˆ©ç”¨ç¼“å­˜" class="headerlink" title="æ›´å¥½åœ°åˆ©ç”¨ç¼“å­˜"></a>æ›´å¥½åœ°åˆ©ç”¨ç¼“å­˜</h3><ul>
<li>åˆç†åˆ†åŒ…ï¼Œåˆ’åˆ†å‡ºâ€œç»å¸¸æ”¹åŠ¨çš„ä»£ç â€â€œåŸºæœ¬ä¸ä¼šå˜çš„ä»£ç â€ï¼Œé…åˆcontenthashå’Œèµ„æºçš„ETagï¼Œå®ç°æ¯æ¬¡éƒ¨ç½²ååªæœ‰æ”¹åŠ¨çš„é‚£äº›ä»£ç å¯¹åº”çš„æ–‡ä»¶å˜äº†ï¼Œè€Œå…¶ä»–æ–‡ä»¶éƒ½è¿˜å¯ä»¥ç”¨ç¼“å­˜çš„</li>
<li>åŸºäºDLLå®ç°ä¾èµ–å…±äº«ï¼Œå¦‚vueç­‰åŸºç¡€æ¡†æ¶åŒ… å›¢é˜Ÿå…¬å…±sdkåŒ…ç­‰<ul>
<li>å¦‚ä½•åˆç†æ‹†åˆ†DLL</li>
<li>å¦‚ä½•è¿›è¡ŒDLLçš„ç‰ˆæœ¬æ§åˆ¶</li>
</ul>
</li>
<li>å®¢æˆ·ç«¯çš„ç¦»çº¿åŒ…æœºåˆ¶</li>
</ul>
<h3 id="ç½‘ç»œå±‚"><a href="#ç½‘ç»œå±‚" class="headerlink" title="ç½‘ç»œå±‚"></a>ç½‘ç»œå±‚</h3><ul>
<li>preconnect</li>
<li>gzipå‹ç¼©</li>
<li>http2</li>
</ul>
<h3 id="è®©ç”¨æˆ·â€œè§‰å¾—å¿«â€"><a href="#è®©ç”¨æˆ·â€œè§‰å¾—å¿«â€" class="headerlink" title="è®©ç”¨æˆ·â€œè§‰å¾—å¿«â€"></a>è®©ç”¨æˆ·â€œè§‰å¾—å¿«â€</h3><ul>
<li>æŠŠLoadingæ”¾åœ¨htmlæ¨¡æ¿ä¸­<ul>
<li>å¦‚ä½•é¿å…æ‰‹å†™htmlæ¨¡æ¿ï¼Ÿå¦‚ä½•ç»´æŠ¤è·¨ç«¯é¡¹ç›®çš„ä¸¤ä»½ä»£ç ï¼Ÿ</li>
</ul>
</li>
<li>åŠ è½½å®Œé¦–å±ä¹‹åå¯¹å…¶ä»–å¯èƒ½ç”¨åˆ°çš„èµ„æºè¿›è¡Œé¢„åŠ è½½ï¼ŒåŒ…æ‹¬å›¾ç‰‡&#x2F;js&#x2F;cssç­‰<ul>
<li>é…åˆå¼‚æ­¥ç»„ä»¶ï¼Œå¦‚ä½•è‡ªåŠ¨åŒ–è¿™ä¸ªè¿‡ç¨‹ï¼Ÿ</li>
</ul>
</li>
</ul>
<p>è¿™éƒ¨åˆ†å¦‚ä½•è¡¡é‡æ”¶ç›Š</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="ce">
    <link itemprop="mainEntityOfPage" href="https://hayahayao.github.io/2020/11/12/%E6%B5%8F%E8%A7%88%E5%99%A8%E8%AF%86%E5%88%AB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="hayahayao">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ã•ãŠã‚Šã®Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/12/%E6%B5%8F%E8%A7%88%E5%99%A8%E8%AF%86%E5%88%AB/" class="post-title-link" itemprop="url">æµè§ˆå™¨è¯†åˆ«</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-11-12 17:47:00" itemprop="dateCreated datePublished" datetime="2020-11-12T17:47:00+08:00">2020-11-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-08-23 01:34:39" itemprop="dateModified" datetime="2023-08-23T01:34:39+08:00">2023-08-23</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="æµè§ˆå™¨è¯†åˆ«"><a href="#æµè§ˆå™¨è¯†åˆ«" class="headerlink" title="æµè§ˆå™¨è¯†åˆ«"></a>æµè§ˆå™¨è¯†åˆ«</h1><h2 id="Javascript-å¼•æ“-æµè§ˆå™¨å¼•æ“"><a href="#Javascript-å¼•æ“-æµè§ˆå™¨å¼•æ“" class="headerlink" title="Javascript å¼•æ“ &amp; æµè§ˆå™¨å¼•æ“"></a>Javascript å¼•æ“ &amp; æµè§ˆå™¨å¼•æ“</h2><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/JavaScript_engine">Javascript å¼•æ“</a></p>
<ul>
<li>V8: chrome, chromium, edge</li>
<li>SpiderMonkey: firefox</li>
<li>JavaScriptCore: safari, other webkit-based browser</li>
<li>chakra: ie</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Browser_engine">æµè§ˆå™¨å¼•æ“</a></p>
<p>layout&#x2F;rendering å¼•æ“ + js å¼•æ“</p>
<ul>
<li>gecko: firefox</li>
<li>webkit: safari, ä»¥å‰çš„ chrome</li>
<li>blink: ç°åœ¨çš„ chrome</li>
<li>trident: ie</li>
<li>presto: opera</li>
</ul>
<p>é€šè¿‡å…¨å±€å¯¹è±¡ <code>navigator.userAgent</code> å¯ä»¥è·å¾—å…³äºæµè§ˆå™¨å¼•æ“çš„ä¿¡æ¯</p>
<h2 id="å¥—å£³æµè§ˆå™¨"><a href="#å¥—å£³æµè§ˆå™¨" class="headerlink" title="å¥—å£³æµè§ˆå™¨"></a>å¥—å£³æµè§ˆå™¨</h2><ul>
<li>å›½å†…æµè§ˆå™¨åŸºæœ¬éƒ½æ˜¯æ‰€è°“å¥—å£³æµè§ˆå™¨ï¼Œå³åœ¨ chrome &amp; ie åŸºç¡€ä¸ŠåŠ ç‚¹ä¸œè¥¿ï¼Œä¸€èˆ¬æé€Ÿæ¨¡å¼å¯¹åº” chromeï¼Œå…¼å®¹æ¨¡å¼å¯¹åº” ie</li>
<li>ä½†æ˜¯å¥—å£³æµè§ˆå™¨å¯èƒ½ç”¨çš„ä¸æ˜¯æœ€æ–°ç‰ˆå†…æ ¸ï¼Œæˆ–è€…æŸäº› api è¡¨ç°ä¸ä¸€æ ·..</li>
<li>ä¸€èˆ¬å¥—å£³æµè§ˆå™¨ä¼šåœ¨ <code>userAgent</code> ä¸ŠåŠ ä¸Šè‡ªå·±çš„å‚å•†æ ‡è¯†ï¼Œä¸è¿‡ç›®å‰å‘ç° 360 æ²¡æœ‰ï¼ˆåé¢ç»™å‡ºä¸€ç§æš‚æ—¶å¯ç”¨çš„ hackï¼‰</li>
<li>ps. è°ƒè¯•è¿‡ç¨‹ä¸­å‘ç° 360 è¿˜å¯ä»¥æ¢ ie11&#x2F;10&#x2F;9&#x2F;8â€¦ çš„å†…æ ¸ï¼Œç”¨æ¥æµ‹è¯•å…¼å®¹æ€§è¿˜æ˜¯æŒºå¥½ç”¨çš„</li>
</ul>
<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>å‘ç° 360 çš„ <code>navigator.mimeTypes</code> ä¸ chrome æœ‰å¾ˆå¤§ä¸åŒï¼Œå…¶ä¸­æœ‰ä¸€äº›é¡¹å¸¦ç€ 360 æ ‡è¯†ï¼Œåº”è¯¥åˆ«çš„æµè§ˆå™¨ä¸ä¼šæœ‰å§..</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mime = navigator.<span class="property">mimeTypes</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> mime) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">/360/</span>.<span class="title function_">test</span>(mime[key].<span class="property">type</span>)) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;360&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><ul>
<li>æ³¨æ„ä½ç‰ˆæœ¬æµè§ˆå™¨å¯èƒ½ä¸æ”¯æŒ es6 ç”šè‡³ es5 è¯­æ³•</li>
<li>å¦‚æœæ•´åˆè¿›é¡¹ç›®ä¸­ï¼Œæœ€å¥½å°†è¿™éƒ¨åˆ†ä¸å…¶ä»–éƒ¨åˆ†åˆ†ç¦»ï¼Œä¸ç„¶ä¸ºäº†å…¼å®¹ä½ç‰ˆæœ¬å’Œ ie éœ€è¦ webpack åŠ å¾ˆå¤š babel é…ç½®ï¼Œè€Œä¸”å¯èƒ½è¿˜ä¸è¡Œâ€¦</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="ce">
    <link itemprop="mainEntityOfPage" href="https://hayahayao.github.io/2020/09/16/%E5%89%8D%E7%AB%AF%E5%A4%A7%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%96%B9%E6%A1%88/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="hayahayao">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ã•ãŠã‚Šã®Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/16/%E5%89%8D%E7%AB%AF%E5%A4%A7%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%96%B9%E6%A1%88/" class="post-title-link" itemprop="url">å‰ç«¯å¤§æ–‡ä»¶ä¸‹è½½æ–¹æ¡ˆ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-09-16 11:26:00" itemprop="dateCreated datePublished" datetime="2020-09-16T11:26:00+08:00">2020-09-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-08-23 01:34:11" itemprop="dateModified" datetime="2023-08-23T01:34:11+08:00">2023-08-23</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="å‰ç«¯å¤§æ–‡ä»¶ä¸‹è½½æ–¹æ¡ˆ"><a href="#å‰ç«¯å¤§æ–‡ä»¶ä¸‹è½½æ–¹æ¡ˆ" class="headerlink" title="å‰ç«¯å¤§æ–‡ä»¶ä¸‹è½½æ–¹æ¡ˆ"></a>å‰ç«¯å¤§æ–‡ä»¶ä¸‹è½½æ–¹æ¡ˆ</h1><blockquote>
<p>tags: </p>
<ul>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/Streams_API">Streams API</a> </li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/Service_Worker_API">Service Worker</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/jimmywarting/StreamSaver.js">StreamSaver.js</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/Stuk/jszip">JSZip</a></li>
</ul>
</blockquote>
<p>åœ¨ä¸šåŠ¡ä¸­é‡åˆ°éœ€è¦ç”¨æˆ·ä¸‹è½½ä¸€ä¸ªå¾ˆå·¨å¤§çš„ zip åŒ…çš„åœºæ™¯ï¼Œå†…å®¹é€šå¸¸æ˜¯ä¸€å †å¾ˆå°çš„ï¼ˆå›¾ç‰‡ï¼‰æ–‡ä»¶æ‰“åŒ…åˆ°ä¸€èµ·ã€‚ä¼ ç»Ÿçš„ä¸‹è½½æ–¹æ¡ˆæ˜¯ç›´æ¥ä¿®æ”¹ <code>window.location.href=åç«¯æä¾›çš„ä¸‹è½½é“¾æ¥</code>ï¼Œä¹‹ååç«¯ä¸€è¾¹å»ä¸‹è½½è¦æ‰“åŒ…çš„æ–‡ä»¶ï¼Œä¸€è¾¹æŠŠæ‰“åŒ…å¥½çš„ä¸œè¥¿å†™å…¥è¿™ä¸ªé“¾æ¥ã€‚</p>
<p>å­˜åœ¨çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœæ–‡ä»¶å¾ˆå¤§ï¼Œè¿™ä¸ªé“¾æ¥éœ€è¦ä¸€ç›´ä¿æŒï¼Œç›¸å½“äºè¿™ä¸ªæ¥å£ä¸€ç›´å¼€ç€æ²¡æœ‰ç»“æŸï¼ˆè¿ç»´åŒå­¦å¾ˆä¸å¼€å¿ƒï¼‰ï¼›è€Œä¸”ä¸€æ—¦ä¸­é—´å‡ºäº†ä»€ä¹ˆé—®é¢˜ï¼Œå·²ç»ä¸‹è½½çš„ä¸œè¥¿ä¹Ÿå…¨éƒ¨åºŸäº†ï¼Œä¸‹æ¬¡è¿˜è¦é‡æ–°å¼€å§‹ï¼ˆå¯ä»¥é€šè¿‡è®¾ç½® http range å¤´ç­‰æ–¹æ³•å®ç°æ–­ç‚¹ç»­ä¼ ï¼‰ã€‚</p>
<p>é‚£ä¹ˆï¼Œåæ­£åç«¯ä¹Ÿæ²¡æœ‰å­˜è¿™ä¸ªå¤§æ–‡ä»¶ï¼Œä¹Ÿæ˜¯ç°ç”¨ç°ç”Ÿæˆçš„ï¼Œå¯ä¸å¯ä»¥æŠŠè¿™ä¸ªå·¥ä½œè½¬ç§»åˆ°å‰ç«¯ï¼Ÿå¦‚æœæŠŠè¯·æ±‚ä¸€å †å°æ–‡ä»¶çš„å·¥ä½œè½¬ç§»åˆ°æµè§ˆå™¨ï¼Œé‚£å°±ç»•å¼€äº†ä¸‹è½½æ¥å£çš„æ—¶é—´é™åˆ¶ï¼Œè€Œä¸”æˆ‘ä»¬çŸ¥é“å“ªäº›æ–‡ä»¶å·²ç»ä¸‹è½½äº†ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥é€šè¿‡ä¸€äº›æ“ä½œä¿ç•™ä½å·²ç»ä¸‹è½½çš„æ–‡ä»¶ï¼Ÿ</p>
<h2 id="JSZip"><a href="#JSZip" class="headerlink" title="JSZip"></a>JSZip</h2><p>åœ¨çŸ¥é“ Streams API è¿™ç§é«˜çº§ç©æ„ä¹‹å‰ï¼Œæˆ‘ä¸€ç›´ä»¥ä¸ºæµè§ˆå™¨ä¸­çš„ js ä»£ç æ˜¯ä¸èƒ½åšæµæ“ä½œçš„ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½ä¸€è¾¹ä¸‹ä¸€è¾¹å¾€æœ¬åœ°å†™ã€‚é‚£ä¹ˆä¸€ä¸ªæœ€ç›´æ¥çš„æƒ³æ³•å°±æ˜¯æŠŠæ–‡ä»¶éƒ½ä¸‹åˆ°å†…å­˜ä¸­ï¼Œä¹‹åè°ƒç”¨ <a target="_blank" rel="noopener" href="https://github.com/Stuk/jszip">JSZip</a> ç»Ÿä¸€æ‰“åŒ…ï¼Œå†è°ƒç”¨ <a target="_blank" rel="noopener" href="https://github.com/eligrey/FileSaver.js/">FileSaver.js</a> è§¦å‘ä¿å­˜æ“ä½œã€‚æ–‡ä»¶æ•°æ®ä¸€ç›´æ˜¯ä»¥ blob æ–¹å¼ä¼ é€’çš„ï¼Œç®€å•çš„ä»£ç ç¤ºæ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; saveAs &#125; <span class="keyword">from</span> <span class="string">&#x27;file-saver&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">JSZip</span> <span class="keyword">from</span> <span class="string">&#x27;jszip&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> urls = [xxx] <span class="comment">// ä¸€å †éœ€è¦ä¸‹è½½çš„æ–‡ä»¶ url</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">ZIP</span> = <span class="keyword">new</span> <span class="title function_">JSZIP</span>()</span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">all</span>(urls.<span class="title function_">map</span>(<span class="function">(<span class="params">url, index</span>) =&gt;</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">fetch</span>(url).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (response.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">            zip.<span class="title function_">file</span>(url, response.<span class="title function_">blob</span>()) <span class="comment">// blob å“¦</span></span><br><span class="line">            <span class="title function_">resolve</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;))).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    zip.<span class="title function_">generateAsync</span>(&#123; <span class="attr">type</span>: <span class="string">&#x27;blob&#x27;</span> &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">content</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">saveAs</span>(content, <span class="string">&#x27;hello.zip&#x27;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>å¾ˆå®¹æ˜“æƒ³è±¡ï¼Œè¿™ç§æ–¹å¼å¯¹å†…å­˜æ¶ˆè€—éå¸¸å¤§ï¼Œè€Œä¸”éšç€æ–‡ä»¶æ•°é‡çš„å¢é•¿ï¼Œæ‰“åŒ… zip è¿™ä¸ªè¿‡ç¨‹ä¼šè¶Šæ¥è¶Šæ…¢ï¼Œæ—¶é—´å½“ç„¶ä¹Ÿä¸æ˜¯çº¿æ€§å¢é•¿é‚£ä¹ˆç®€å•ã€‚å®é™…æµ‹è¯•ç»“æœä¹Ÿå¦‚æ­¤ï¼ˆä¸è¿‡å®é™…æµ‹è¯•ï¼Œèƒ½å¤„ç†çš„æ–‡ä»¶å¤§å°è¶…å‡ºäº†æˆ‘çš„æƒ³è±¡ï¼Œå‡ ä¸ª G éƒ½ä¸æ˜¯é—®é¢˜ï¼Œå°±æ˜¯æ…¢è€Œå·²ï¼‰ã€‚</p>
<h2 id="StreamSaver-js"><a href="#StreamSaver-js" class="headerlink" title="StreamSaver.js"></a>StreamSaver.js</h2><p>å‰ç½®é˜…è¯»ï¼š<a target="_blank" rel="noopener" href="https://juejin.im/post/6844904029244358670">ä» Fetch åˆ° Streams â€”â€” ä»¥æµçš„è§’åº¦å¤„ç†ç½‘ç»œè¯·æ±‚</a></p>
<p>å•Šï¼Œæµï¼Œå®Œç¾çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>æœ‰äº†è¯»å†™æµçš„èƒ½åŠ›ï¼Œè¿˜éœ€è¦è§£å†³çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯å¦‚ä½•ç»´æŒä¸€ä¸ªæŒç»­çš„é€šé“ï¼Œä¿è¯èƒ½å¤Ÿä¸€è¾¹åœ¨ä¸‹è½½ï¼Œä¸€è¾¹æŠŠä¸‹è½½çš„ä¸œè¥¿å†™åˆ°æœ¬åœ°ã€‚</p>
<p>å•Šå“ˆï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ¨¡ä»¿åç«¯ï¼Œåˆ¶é€ ä¸€ä¸ªï¼ˆä¸å­˜åœ¨çš„ï¼‰ä¸‹è½½é“¾æ¥ï¼Œç„¶åç”¨ <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/Service_Worker_API">Service Worker</a> å»æ‹¦æˆªå¯¹è¿™ä¸ªé“¾æ¥çš„è¯·æ±‚ï¼ŒæŒç»­å¾€è¿™é‡Œé¢å†™å°±å¯ä»¥äº†ï¼</p>
<p>è¿™å°±æ˜¯ <a target="_blank" rel="noopener" href="https://github.com/jimmywarting/StreamSaver.js">StreamSaver.js</a> æ‰€åšçš„äº‹æƒ…ã€‚ç®€å•çš„ä»£ç ç¤ºæ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">StreamSaver</span> <span class="keyword">from</span> <span class="string">&#x27;streamsaver&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ZipStream</span> <span class="keyword">from</span> <span class="string">&#x27;./zip-stream.js&#x27;</span> <span class="comment">// ä½œè€…æä¾›çš„ zip å·¥å…·</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> urls = [xxx] <span class="comment">// ä¸€å †éœ€è¦ä¸‹è½½çš„æ–‡ä»¶ url</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fileStream = <span class="title class_">StreamSaver</span>.<span class="title function_">createWriteStream</span>(<span class="string">&#x27;hello.zip&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> readableZipStream = <span class="keyword">new</span> <span class="title class_">ZipStream</span>(&#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">pull</span>(<span class="params">control</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> it = url.<span class="title function_">next</span>()</span><br><span class="line">        <span class="keyword">if</span> (it.<span class="property">done</span>) &#123;</span><br><span class="line">            control.<span class="title function_">close</span>()</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(url)</span><br><span class="line">            control.<span class="title function_">enqueue</span>(&#123;</span><br><span class="line">                <span class="attr">name</span>: url,</span><br><span class="line">                <span class="attr">stream</span>: <span class="function">() =&gt;</span> response.<span class="property">body</span> <span class="comment">// è¿™ä¸ªæ˜¯ ReadableStream ç±»å‹ï¼web æ ‡å‡†ä¸‡å²ï¼</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">WritableStream</span> &amp;&amp; readableZipStream.<span class="property">pipeTo</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> readableZipStream.<span class="title function_">pipeTo</span>(fileStream).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            that.<span class="property">dialogExportProcess</span> = <span class="literal">false</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°çš„ä»£ç å®ç°äº†æ¯æ¬¡ä¸‹è½½ä¸€ä¸ªæ–‡ä»¶ -&gt; å‘æµä¸­å†™å…¥ä¸€ä¸ªæ–‡ä»¶è¿™æ ·ç±»ä¼¼å•çº¿ç¨‹ï¼ˆï¼Ÿï¼‰çš„å¤„ç†è¿‡ç¨‹ï¼Œé‚£ä¹ˆèƒ½å¦å®ç°å¦‚<a target="_blank" rel="noopener" href="https://juejin.im/post/6844904029244358670">ä» Fetch åˆ° Streams â€”â€” ä»¥æµçš„è§’åº¦å¤„ç†ç½‘ç»œè¯·æ±‚</a>è¿™ç¯‡ä¸­æ‰€è¯´ï¼Œç»“åˆ JSZipï¼Œåœ¨ä¸€æ¬¡ <code>pull</code> è¿‡ç¨‹ä¸­ä¸‹è½½å¥½å‡ ä¸ªï¼Œç„¶åç”¨ JSZip æŠŠè¿™å¥½å‡ ä¸ªæ–‡ä»¶å‹æˆä¸€å—æµä¸€å£æ°”å†™å…¥å‘¢ï¼Ÿ</p>
<h3 id="ä¸-JSZip-ç»“åˆä½¿ç”¨ï¼Ÿ"><a href="#ä¸-JSZip-ç»“åˆä½¿ç”¨ï¼Ÿ" class="headerlink" title="ä¸ JSZip ç»“åˆä½¿ç”¨ï¼Ÿ"></a>ä¸ JSZip ç»“åˆä½¿ç”¨ï¼Ÿ</h3><p><img src="https://user-gold-cdn.xitu.io/2019/12/23/16f304e310ea9e49?imageslim" alt="ä¸ JSZip ç»“åˆä½¿ç”¨"></p>
<p>é¦–å…ˆï¼Œä½¿ç”¨æ–‡ç« é‡Œæè¿°çš„ <code>generateInternalStream()</code> è¿™ä¸ªæ–¹æ³•æ˜¯è¡Œä¸é€šçš„ï¼ŒJSZip çš„ <code>StreamHelper</code> API åªæ˜¯æ¨¡æ‹Ÿäº†æµçš„å®ç°ï¼Œä½†è¿”å›å€¼å¹¶ä¸æ˜¯ç¬¦åˆ Stream API æ ‡å‡†çš„ <code>ReadableStream</code>&#x2F;<code>WritableStream</code> ç±»å‹ã€‚</p>
<p>ä¸è¿‡ blob æ€»æ˜¯å¯è¡Œçš„ï¼Œå¦‚æœåœ¨ JSZip é‡Œé¢ç”¨ blob å¤„ç†ï¼Œåˆ°æ—¶å€™å†ç”¨ <code>blob.stream()</code> è¿™ç§æ–¹æ³•è½¬æˆ <code>ReadableStream</code> å†™å…¥æµä¸­ï¼Œä¼¼ä¹å¬ä¸Šå»ä¸é”™ã€‚ä¸è¿‡æˆ‘åœ¨å®é™…æ“ä½œçš„è¿‡ç¨‹ä¸­é‡åˆ°çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œ<code>control.enqueue()</code> æ—¶æ–‡ä»¶åæ€ä¹ˆå¤„ç†ï¼Ÿæˆ‘è¯•ç€å†™æˆä»¥ &#x2F; ç»“å°¾è¡¨ç¤ºæˆ‘è¦å†™å…¥ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œä¸è¿‡ä¼¼ä¹å¹¶ä¸èƒ½è¾¾åˆ°é¢„æƒ³æ•ˆæœğŸ¤”â€¦</p>
<h3 id="mitm-sw-é…ç½®"><a href="#mitm-sw-é…ç½®" class="headerlink" title="mitm + sw é…ç½®"></a>mitm + sw é…ç½®</h3><p>æœ€åå†™ä¸€ä¸‹å®é™…ä½¿ç”¨ StreamSaver æ—¶æ‰€éœ€çš„ sw é…ç½®ã€‚</p>
<p>ç›´æ¥è·‘ä½œè€…ç»™å‡ºçš„ç¤ºä¾‹ä»£ç ä¼šå‘ç°ï¼Œè¿è¡Œä¸‹è½½ä¹‹åé¡µé¢ä¸Šä¼šå¤šå‡ºä¸¤ä¸ªè¿™æ ·çš„ iframe</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">hidden</span>=<span class="string">&quot;&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://jimmywarting.github.io/StreamSaver.js/mitm.html?version=2.0.0&quot;</span> <span class="attr">name</span>=<span class="string">&quot;iframe&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">hidden</span>=<span class="string">&quot;&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://jimmywarting.github.io/StreamSaver.js/null/637501/archive.zip&quot;</span> <span class="attr">name</span>=<span class="string">&quot;iframe&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>emmï¼Œç¬¬äºŒä¸ªçœ‹èµ·æ¥åƒæ˜¯ä¸‹è½½é“¾æ¥çš„æ ·å­ï¼ˆå½“ç„¶æ˜¯æˆ‘ä»¬åˆ¶é€ çš„ï¼Œå®é™…æ‰“å¼€é‡Œé¢ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼‰ï¼Œç¬¬ä¸€ä¸ªçš„è¯æ‰“å¼€å‘ç°é‡Œé¢æœ‰ä¸€äº› js ä»£ç ï¼Œä¼¼ä¹æ˜¯æ³¨å†Œäº† sw çš„æ ·å­ã€‚</p>
<p>ä½†æ˜¯è¿™åŸŸåï¼Œè¿™å‰ç¼€ï¼Œéƒ½æ˜¯å•¥ï¼Ÿèƒ½ä¸èƒ½æåˆ°è‡ªå·±æœ¬åœ°ï¼Ÿåˆ°æ—¶å€™é¡¹ç›®ä¸Šçº¿è¿˜å¸¦ç€åˆ«äººçš„ github.io å¯ä¸è¡Œâ€¦</p>
<p>æ¥çœ‹ä¸‹ä½œè€…çš„è§£é‡Šï¼š</p>
<blockquote>
<p>So the one and only other solution is to do what the server does: Send a stream with Content-Disposition header to tell the browser to save the file. But we donâ€™t have a server or the content isnâ€™t on a server! So the solution is to create a service worker that can intercept request and use respondWith() and act as a server.</p>
<p>But a service workers are only allowed in secure contexts and it requires some effort to put up. Most of the time you are working in the main thread and the service worker are only alive for &lt; 5 minutes before it goes idle.</p>
<p>1.So StreamSaver creates a own man in the middle that installs the service worker in a secure context hosted on github static pages. either from a iframe (in secure context) or a new popup if your page is insecure.</p>
<p>2.Transfer the stream (or DataChannel) over to the service worker using postMessage.</p>
<p>3.And then the worker creates a download link that we then open.</p>
<p>if a â€œtransferableâ€ readable stream was not passed to the service worker then the mitm will also try to keep the service worker alive by pinging it every x second to prevent it from going idle.</p>
</blockquote>
<p>å—¯ï¼Œè¿™ä¸ª mitm.html ç¡®å®æ˜¯åœ¨å®Œæˆ service worker æ³¨å†Œçš„å·¥ä½œã€‚è€Œ service worker æ³¨å†Œæœ‰å¾ˆå¤šé™åˆ¶ï¼šï¼ˆä¸ºæ–¹ä¾¿è¯´æ˜ï¼Œä¸‹æ–‡ä¸­ mitm.html ä»£è¡¨â€œæ³¨å†Œ service worker çš„ä½ç½®â€œï¼Œsw.js ä»£è¡¨â€œservice worker æ‰€åœ¨çš„ä½ç½®â€œï¼‰</p>
<ul>
<li>åªèƒ½åœ¨ HTTPS&#x2F;localhost ç¯å¢ƒä¸‹æ³¨å†Œï¼ˆå¦åˆ™æŠ¥é”™å¦‚ <code>Failed to register a ServiceWorker: An SSL certificate error occurred when fetching the script.</code>ï¼‰</li>
<li>è¦æ³¨å†Œçš„ sw.js æ–‡ä»¶å¿…é¡»å’Œæ³¨å†Œå®ƒçš„ mitm.html åŒæºï¼ˆå¦åˆ™æŠ¥é”™å¦‚ <code>Failed to register ServiceWorker. The origin of the provider scriptURL(&#39;sw.js æ‰€åœ¨çš„åŸŸ&#39;) does not match the current origin (&#39;mitm.html æ‰€åœ¨çš„åŸŸ&#39;).</code>ï¼‰</li>
<li>service worker çš„ä½œç”¨åŸŸä¸èƒ½è¶…å‡º sw.js è‡ªå·±æ‰€åœ¨ä½ç½®ï¼ˆå¦åˆ™æŠ¥é”™å¦‚ <code>Failed to register a ServiceWorker: The path of the provided scope (&#39;mitm.html æ‰€åœ¨çš„è·¯å¾„&#39;) is not under the max scope allowed (&#39;sw.js æ‰€åœ¨çš„è·¯å¾„&#39;). Adjust the scope, move the Service Worker script, or use the Service-Worker-Allowed HTTP header to allow the scope.</code>ï¼‰</li>
</ul>
<p>æ‰€ä»¥ä½œè€…é»˜è®¤æŠŠ sw æ³¨å†Œåœ¨äº†ä»–è‡ªå·±çš„çš„ github é™æ€é¡µé¢ä¸Šï¼Œè€Œå¦‚æœæˆ‘ä»¬æƒ³åœ¨è‡ªå·±çš„åŸŸåä¸Šæ³¨å†Œ swï¼Œå°±éœ€è¦æ³¨æ„ä¸Šé¢ä¸‰ç‚¹é™åˆ¶ï¼š</p>
<ul>
<li>https ç¯å¢ƒé™åˆ¶ï¼šå¦‚ä¸º httpï¼Œå¯ä»¥æŠŠç½‘ç«™æ”¹æˆ https ç„¶åæ‰‹åŠ¨ä¿¡ä»»ä¸‹è¯ä¹¦</li>
<li>åŒæºé™åˆ¶ï¼šå¦‚æœä¸åŒæºï¼Œå¯ä»¥é‡‡ç”¨é…ç½® nginx ä»£ç†è®©å®ƒä»¬çœ‹ä¸Šå»æ˜¯åŒæºçš„</li>
<li>ä½œç”¨åŸŸé™åˆ¶ï¼šå¦‚æœä¸æƒ³ä¿®æ”¹è¿™ä¸¤ä¸ªæ–‡ä»¶çš„ä½ç½®ï¼Œå¯ä»¥é€šè¿‡ nginx åœ¨ sw.js çš„ response header ä¸­åŠ å…¥ <code>Service-Worker-Allowed</code> è¿™ä¸ªå¤´</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="ce">
    <link itemprop="mainEntityOfPage" href="https://hayahayao.github.io/2020/08/18/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Javascript%E8%BD%BB%E9%87%8F%E7%BA%A7%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="hayahayao">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ã•ãŠã‚Šã®Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/18/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Javascript%E8%BD%BB%E9%87%8F%E7%BA%A7%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/" class="post-title-link" itemprop="url">è¯»ä¹¦ç¬”è®°-Javascriptè½»é‡çº§å‡½æ•°å¼ç¼–ç¨‹</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-18 11:36:00" itemprop="dateCreated datePublished" datetime="2020-08-18T11:36:00+08:00">2020-08-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-08-23 01:35:07" itemprop="dateModified" datetime="2023-08-23T01:35:07+08:00">2023-08-23</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="å‡½æ•°å¼ç¼–ç¨‹"><a href="#å‡½æ•°å¼ç¼–ç¨‹" class="headerlink" title="å‡½æ•°å¼ç¼–ç¨‹"></a>å‡½æ•°å¼ç¼–ç¨‹</h1><blockquote>
<p>ã€ŠJavaScript è½»é‡çº§å‡½æ•°å¼ç¼–ç¨‹ã€‹è¯»ä¹¦ç¬”è®°</p>
<p><a target="_blank" rel="noopener" href="https://github.com/ikcamp/Functional-Light-JS">ä¸­æ–‡ç‰ˆ</a></p>
</blockquote>
<h2 id="å‡½æ•°åŸºç¡€"><a href="#å‡½æ•°åŸºç¡€" class="headerlink" title="å‡½æ•°åŸºç¡€"></a>å‡½æ•°åŸºç¡€</h2><p>å®å‚å’Œå½¢å‚</p>
<ul>
<li>argumentsï¼šè¾“å…¥çš„å€¼ï¼Œå®å‚</li>
<li>parametersï¼šå‡½æ•°ä¸­çš„å‘½åå˜é‡ï¼Œå½¢å‚</li>
</ul>
<p>å‚æ•°æ•°é‡</p>
<ul>
<li>Arityï¼šä¸€ä¸ªå‡½æ•°å£°æ˜çš„å½¢å‚æ•°é‡<br>å¯ä»¥åœ¨è¿è¡Œæ—¶é€šè¿‡å‡½æ•°çš„ <code>length</code> å±æ€§è·å–</li>
<li>å®å‚æ•°é‡ï¼š<code>arguments.length</code></li>
</ul>
<p>ES6 çš„ <code>...</code> æ“ä½œç¬¦</p>
<ul>
<li>åœ¨å½¢å‚åˆ—è¡¨ï¼Œå®ƒæŠŠå®å‚æ•´åˆï¼›åœ¨å®å‚åˆ—è¡¨ï¼Œå®ƒæŠŠå®å‚å±•å¼€</li>
<li>å‡½æ•°å‚æ•°ç”¨è§£æ„æ•°ç»„&#x2F;å¯¹è±¡</li>
<li>åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„å‡½æ•°åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½æ˜¯ä¸€å…ƒçš„ï¼ˆArity ä¸º 1ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨å¯¹è±¡è§£æ„ä¼ å‚å®ç°</li>
</ul>
<p>è§£æ„</p>
<blockquote>
<p>å£°æ˜æ€§ä»£ç é€šå¸¸æ¯”å‘½ä»¤å¼ä»£ç æ›´å¹²å‡€</p>
</blockquote>
<p>ç‰¹å®šå¤šæ€ï¼šé€šè¿‡ä¸åŒçš„è¾“å…¥å€¼è®©ä¸€ä¸ªå‡½æ•°é‡è½½æ‹¥æœ‰ä¸åŒçš„è¡Œä¸ºï¼ˆåœ¨ä¸åŒçš„æƒ…å†µä¸‹ä½¿å‡½æ•°å…·æœ‰ä¸åŒçš„è¾“å‡ºï¼‰ã€‚ä½†æ˜¯è¿™æ ·çš„è®¾è®¡çš„ç»´æŠ¤æˆæœ¬ä¼šæ¯”è¾ƒé«˜</p>
<p>å‡½æ•°è¾“å‡º</p>
<ul>
<li>ä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹ï¼Œæ¯ä¸ªå‡½æ•°å¿…é¡»æ˜ç¡®çš„ <code>return</code> ä¸€ä¸ªå€¼</li>
<li>æˆ‘ä»¬ç»å¸¸ä½¿ç”¨æå‰ <code>return</code> æ¥æ§åˆ¶ä»£ç æµï¼Œä½†è¿™ä¼šé€ æˆéš¾ä»¥ç†è§£ï¼Œæœ€å¥½ä¸è¦ç”¨ <code>return</code> æ¥å®ç°æµæ§åˆ¶ï¼Œè€Œæ˜¯ä½¿ç”¨æ˜ç¡®çš„è¡¨è¾¾é€»è¾‘çš„æ–¹å¼</li>
<li>çº¯å‡½æ•°ï¼Œé¿å…å‰¯ä½œç”¨</li>
</ul>
<p>é«˜é˜¶å‡½æ•°ï¼šæ¥å—æˆ–è¿”å›ä¸€ä¸ªç”šè‡³å¤šä¸ªå‡½æ•°çš„å‡½æ•°ï¼ˆå°†å…¶ä»–å‡½æ•°è§†ä¸ºå€¼è¿›è¡Œæ“ä½œï¼Œä¸€ç­‰å…¬æ°‘ï¼Œå¯ä½œä¸ºå‡½æ•°çš„å‚æ•°&#x2F;è¿”å›å€¼ï¼‰</p>
<p>é—­åŒ…</p>
<ul>
<li>å½“ä¸€ä¸ªå‡½æ•°å†…éƒ¨å­˜åœ¨å¦ä¸€ä¸ªå‡½æ•°çš„ä½œç”¨åŸŸæ—¶ï¼Œå¯¹å½“å‰å‡½æ•°è¿›è¡Œæ“ä½œã€‚å½“å†…éƒ¨å‡½æ•°ä»å¤–éƒ¨å‡½æ•°å¼•ç”¨å˜é‡ï¼Œè¿™è¢«ç§°ä½œé—­åŒ…</li>
<li>é—­åŒ…å¯ä»¥è®°å½•å¹¶ä¸”è®¿é—®å®ƒä½œç”¨åŸŸå¤–çš„å˜é‡ï¼Œç”šè‡³å½“è¿™ä¸ªå‡½æ•°åœ¨ä¸åŒçš„ä½œç”¨åŸŸè¢«æ‰§è¡Œ</li>
<li>é—­åŒ…ä¸ä»…é™äºè·å–å˜é‡çš„åŸå§‹å€¼ï¼šå®ƒä¸ä»…ä»…æ˜¯å¿«ç…§ï¼Œè€Œæ˜¯ç›´æ¥é“¾æ¥ï¼›ä½ å¯ä»¥æ›´æ–°è¯¥å€¼ï¼Œå¹¶åœ¨ä¸‹æ¬¡è®¿é—®æ—¶è·å–æ›´æ–°åçš„å€¼</li>
<li>å¦‚æœä½ éœ€è¦è®¾ç½®ä¸¤ä¸ªè¾“å…¥ï¼Œä¸€ä¸ªä½ å·²ç»çŸ¥é“ï¼Œå¦ä¸€ä¸ªéœ€è¦åé¢æ‰èƒ½çŸ¥é“ï¼Œå¯ä»¥ä½¿ç”¨é—­åŒ…æ¥è®°å½•ç¬¬ä¸€ä¸ªè¾“å…¥å€¼</li>
<li>åŒæ ·å¯ä»¥é€šè¿‡é—­åŒ…æ¥è®°ä½å‡½æ•°</li>
</ul>
<p>å¥æ³•</p>
<ul>
<li>æœ€å¥½ç»™æ‰€æœ‰å‡½æ•°éƒ½å‘½åï¼Œé¿å…åŒ¿åå‡½æ•°ã€‚-&gt;Â å †æ ˆè½¨è¿¹è°ƒç”¨ï¼›å¯é çš„è‡ªæˆ‘å¼•ç”¨å’Œå¯è¯»æ€§ï¼›æ›´å¥½åœ°ç†è§£å‡½æ•°çš„ç›®çš„&#x2F;è®¾è®¡</li>
<li>ç®­å¤´å‡½æ•°æ˜¯è¯æ³•åŒ¿åçš„ï¼Œæ‰€ä»¥å…·æœ‰ä¸Šè¿°ç¼ºç‚¹ï¼Œä½†è¯­æ³•ç®€æ´ï¼Œèƒ½ç®€åŒ–&#x2F;ä¼˜åŒ–ä»£ç ç‰‡æ®µä¸­çš„ç©ºé—´</li>
<li>å‡½æ•°å¼ç¼–ç¨‹ä¸­ä¸è¦ä½¿ç”¨ <code>this</code>ï¼Œå› ä¸º <code>this</code> ç›¸å½“äºä½¿ç”¨äº†éšå¼è¾“å…¥</li>
</ul>
<h2 id="ç®¡ç†å‡½æ•°çš„è¾“å…¥"><a href="#ç®¡ç†å‡½æ•°çš„è¾“å…¥" class="headerlink" title="ç®¡ç†å‡½æ•°çš„è¾“å…¥"></a>ç®¡ç†å‡½æ•°çš„è¾“å…¥</h2><blockquote>
<p>å‡½æ•°å¼ç¼–ç¨‹è€…ä¹ æƒ¯äºåœ¨é‡å¤åšåŒä¸€ç§äº‹æƒ…çš„åœ°æ–¹æ‰¾åˆ°æ¨¡å¼ï¼Œå¹¶è¯•ç€å°†è¿™äº›è¡Œä¸ºè½¬æ¢ä¸ºé€»è¾‘å¯é‡ç”¨çš„å®ç”¨å‡½æ•°</p>
</blockquote>
<p>åå‡½æ•°ï¼šåœ¨å‡½æ•°è°ƒç”¨ç°åœºï¼ˆfunction call-siteï¼‰ï¼Œå°†å®å‚åº”ç”¨ï¼ˆapplyï¼‰äºå½¢å‚ã€‚åå‡½æ•°æ˜¯ä¸€ä¸ªå‡å°‘å‡½æ•°å‚æ•°ä¸ªæ•°ï¼ˆarityï¼‰çš„è¿‡ç¨‹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// fnï¼šè¢«ååº”ç”¨å®å‚çš„å‡½æ•°</span></span><br><span class="line"><span class="comment">// presetArgsï¼šæå‰ä¼ å…¥çš„å®å‚</span></span><br><span class="line"><span class="comment">// laterArgsï¼›è°ƒç”¨æ—¶ä¼ å…¥çš„å®å‚</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">partial</span>(<span class="params">fn, ...presetArgs</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">partiallyApplied</span>(<span class="params">...laterArgs</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fn</span>(...presetArgs, ...laterArgs)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>bind(..)</code>ï¼šé¢„è®¾ <code>this</code> å…³é”®å­—çš„ä¸Šä¸‹æ–‡ï¼Œä»¥åŠååº”ç”¨å®å‚</p>
<p>å°†å®å‚é¡ºåºé¢ å€’</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">reverseArgs</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">argsReversed</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fn</span>(...args.<span class="title function_">reverse</span>())</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»å³è¾¹å¼€å§‹ååº”ç”¨å®å‚ï¼ˆå³ååº”ç”¨å®å‚ï¼‰</p>
<p>è¿™ä¸ªå‡½æ•°ä¸èƒ½ä¿è¯è®©ä¸€ä¸ªç‰¹å®šçš„å½¢å‚æ¥å—ç‰¹å®šçš„è¢«ååº”ç”¨çš„å€¼ï¼Œåªèƒ½ç¡®ä¿å°†è¢«è¿™äº›å€¼ï¼ˆä¸€ä¸ªæˆ–å‡ ä¸ªï¼‰å½“ä½œåŸå‡½æ•°æœ€å³è¾¹çš„å®å‚ï¼ˆä¸€ä¸ªæˆ–å‡ ä¸ªï¼‰ä¼ å…¥</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">partialRight</span>(<span class="params">fn, ...presetArgs</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">reverseArgs</span>(</span><br><span class="line">    <span class="title function_">partial</span>(<span class="title function_">reverseArgs</span>(fn), ...presetArgs.<span class="title function_">reverse</span>())</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŸ¯é‡ŒåŒ–ï¼šå°†ä¸€ä¸ªæœŸæœ›æ¥æ”¶å¤šä¸ªå®å‚çš„å‡½æ•°æ‹†è§£æˆè¿ç»­çš„é“¾å¼å‡½æ•°ï¼Œæ¯ä¸ªé“¾å¼å‡½æ•°æ¥æ”¶å•ä¸€å®å‚å¹¶è¿”å›å¦ä¸€ä¸ªæ¥æ”¶ä¸‹ä¸€ä¸ªå®å‚çš„å‡½æ•°</p>
<p>æ­¤å‡½æ•°é»˜è®¤åŸºäºå¦‚ä¸‹æ¡ä»¶ï¼šåœ¨æ‹¿åˆ°åŸå‡½æ•°æœŸæœ›çš„å…¨éƒ¨å®å‚ä¹‹å‰ï¼Œæˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡æ£€æŸ¥å°†è¦è¢«æŸ¯é‡ŒåŒ–çš„å‡½æ•°çš„ <code>length</code> å±æ€§æ¥å¾—çŸ¥æŸ¯é‡ŒåŒ–éœ€è¦è¿­ä»£å¤šå°‘æ¬¡</p>
<p>å¦‚æœéœ€è¦ç”¨åœ¨ä¸€ä¸ª <code>length</code> å±æ€§ä¸æ˜ç¡®çš„å‡½æ•°ä¸Šï¼ˆå½¢å‚å£°æ˜åŒ…å«é»˜è®¤å½¢å‚å€¼&#x2F;å½¢å‚è§£æ„&#x2F;å¯å˜å‚æ•°å‡½æ•°ç­‰ï¼‰ï¼Œéœ€è¦æ˜ç¡®ä¼ å…¥ <code>arity</code> å‚æ•°æ¥ç¡®ä¿ <code>curry(..)</code> å‡½æ•°çš„æ­£å¸¸è¿è¡Œ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">curry</span>(<span class="params">fn, arity = fn.length</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (<span class="keyword">function</span> <span class="title function_">nextCurried</span>(<span class="params">prevArgs</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">curried</span>(<span class="params">nextArg</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> args = prevArgs.<span class="title function_">contact</span>([nextArg])</span><br><span class="line">      <span class="keyword">if</span> (args.<span class="property">length</span> &gt;= arity) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">fn</span>(...args)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">nextCurried</span>(args)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)([]) <span class="comment">// attention here</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŸ¯é‡ŒåŒ–å’Œååº”ç”¨</p>
<ul>
<li>éƒ½æ˜¯ç”¨æ¥å‡å°‘å‡½æ•°çš„å‚æ•°æ•°é‡çš„æŠ€æœ¯ï¼›æŸ¯é‡ŒåŒ–æ˜¯ååº”ç”¨çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ï¼Œå…¶å‚æ•°æ•°é‡é™ä½ä¸º 1</li>
<li>æŸ¯é‡ŒåŒ–ï¼šæ¯æ¬¡å‡½æ•°è°ƒç”¨ä¼ å…¥ä¸€ä¸ªå®å‚ï¼Œå¹¶ç”Ÿæˆå¦ä¸€ä¸ªç‰¹å®šæ€§æ›´å¼ºçš„å‡½æ•°ï¼Œä¹‹åæˆ‘ä»¬å¯ä»¥åœ¨ç¨‹åºä¸­è·å–å¹¶ä½¿ç”¨é‚£ä¸ªæ–°å‡½æ•°</li>
<li>ååº”ç”¨ï¼šé¢„å…ˆæŒ‡å®šæ‰€æœ‰å°†è¢«ååº”ç”¨çš„å®å‚ï¼Œäº§å‡ºä¸€ä¸ªç­‰å¾…æ¥æ”¶å‰©ä¸‹æ‰€æœ‰å®å‚çš„å‡½æ•°</li>
<li>æŸ¯é‡ŒåŒ–å’Œååº”ç”¨éƒ½ä½¿ç”¨é—­åŒ…æ¥ä¿å­˜å®å‚ï¼Œç›´åˆ°æ”¶é½æ‰€æœ‰å®å‚åå†æ‰§è¡ŒåŸå‡½æ•°</li>
<li>æŸ¯é‡ŒåŒ–å’Œååº”ç”¨å¯ä»¥å°†æŒ‡å®šåˆ†ç¦»å®å‚çš„æ—¶æœºå’Œåœ°æ–¹ç‹¬ç«‹å¼€æ¥</li>
<li>å½“å‡½æ•°åªæœ‰ä¸€ä¸ªå½¢å‚æ—¶ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ¯”è¾ƒå®¹æ˜“åœ°ç»„åˆå®ƒä»¬</li>
</ul>
<p>æ¾æ•£æŸ¯é‡ŒåŒ–ï¼šå…è®¸åœ¨æ¯æ¬¡æŸ¯é‡ŒåŒ–è°ƒç”¨ä¸­æŒ‡å®šå¤šä¸ªå®å‚ï¼Œå…è®¸ä¼ å…¥è¶…è¿‡ arity çš„å®å‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">looseCurry</span>(<span class="params">fn, arity = fn.length</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (<span class="keyword">function</span> <span class="title function_">nextCurried</span>(<span class="params">prevArgs</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">curried</span>(<span class="params">...nextArgs</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> args = prevArgs.<span class="title function_">concat</span>(nextArgs)</span><br><span class="line">      <span class="keyword">if</span> (args.<span class="property">length</span> &gt;= arity) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">fn</span>(...args)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">nextCurried</span>(args)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)([])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åæŸ¯é‡ŒåŒ–</p>
<p>è¿”å›çš„ç»“æœæ˜¯ï¼šå¦‚æœä¼ å…¥åŸå‡½æ•°æœŸæœ›æ•°é‡çš„å®å‚ï¼Œåˆ™å‡½æ•°çš„è¡Œä¸ºå’ŒåŸå‡½æ•°ç›¸åŒï¼›è€Œå¦‚æœå°‘ä¼ äº†å®å‚ï¼Œå¾—åˆ°çš„æ˜¯ä»åœ¨ç­‰å¾…ä¼ å…¥æ›´å¤šå®å‚çš„éƒ¨åˆ†æŸ¯é‡ŒåŒ–å‡½æ•°</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">uncurry</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">uncurried</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> ret = fn</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; args.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      ret = <span class="title function_">ret</span>(args[i])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å•å‚æ•°å‡½æ•°ï¼šåŒ…è£…ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œç¡®ä¿è¢«åŒ…è£…çš„å‡½æ•°åªæ¥å—ä¸€ä¸ªå®å‚ã€‚å³å¼ºåˆ¶æŠŠä¸€ä¸ªå‡½æ•°å¤„ç†æˆå•å‚æ•°å‡½æ•°</p>
<p>åº”ç”¨ï¼šä¾‹å¦‚ <code>map(..)</code> å‡½æ•°è°ƒç”¨æ—¶ä¼šä¼ å…¥ä¸‰ä¸ªå®å‚ï¼Œè€Œåªæƒ³æ¥æ”¶ä¸€ä¸ª</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">unary</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">onlyOneArg</span>(<span class="params">arg</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fn</span>(arg)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// e.g.</span></span><br><span class="line">[<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>].<span class="title function_">map</span>(<span class="built_in">parseFloat</span>) <span class="comment">// [1, 2, 3]</span></span><br><span class="line">[<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>].<span class="title function_">map</span>(<span class="built_in">parseInt</span>) <span class="comment">// [1, NaN, NaN]</span></span><br><span class="line">[<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>].<span class="title function_">map</span>(<span class="title function_">unary</span>(<span class="built_in">parseInt</span>)) <span class="comment">// [1, 2, 3]</span></span><br></pre></td></tr></table></figure>

<p>identity å‡½æ•°</p>
<ul>
<li>å¯ä»¥è¢«ç”¨ä½œåˆ¤ç©ºçš„æ–­è¨€</li>
<li>å¯ä»¥å°†å…¶ä½œä¸ºæ›¿ä»£ä¸€ä¸ªè½¬æ¢å‡½æ•°çš„é»˜è®¤å‡½æ•°</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">identity</span>(<span class="params">v</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> v</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ’å®šå‚æ•°</p>
<p>å¯ä»¥ç”¨äº Certain APIï¼ˆç¦æ­¢ç›´æ¥ç»™æ–¹æ³•ä¼ å€¼ï¼Œå¿…é¡»ä¼ å…¥å‡½æ•°ï¼Œæ¯”å¦‚ JS Promiseï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">constant</span>(<span class="params">v</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">value</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰©å±•å‚æ•°ï¼šè°ƒæ•´ä¸€ä¸ªå‡½æ•°ï¼Œè®©å®ƒæŠŠèƒ½æ¥æ”¶çš„å•ä¸€æ•°ç»„æ‰©å±•æˆå„è‡ªç‹¬ç«‹çš„å®å‚</p>
<p>ä¹Ÿè¢«ç§°ä¸º <code>apply(..)</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">spreadArgs</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">spreadFn</span>(<span class="params">argsArr</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fn</span>(...argsArr)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>èšé›†å‚æ•°</p>
<p>ä¹Ÿè¢«ç§°ä¸º <code>unapply(..)</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">gatherArgs</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">gatheredFn</span>(<span class="params">...argsArr</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fn</span>(argsArr)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ— è®ºæ˜¯æŸ¯é‡ŒåŒ–è¿˜æ˜¯ååº”ç”¨ï¼Œæˆ‘ä»¬éƒ½ç”¨äº†ä¸Šé¢çš„è®¸å¤šç¹ççš„æŠ€å·§æ¥ä¿®æ­£è¿™äº›å½¢å‚çš„é¡ºåºï¼Œè€Œè¿™äº›ç¹ççš„ä»£ç ä¼šæŠŠæˆ‘ä»¬è‡ªå·±çš„ä»£ç æ··æ·†å¾—ä¸€å›¢ç³Ÿâ€¦åœ¨ç¬¬äºŒç« ä»‹ç»äº†ç”¨è§£æ„å®ç°å‘½åå®å‚ï¼Œé‚£ä¹ˆååº”ç”¨&#x2F;æŸ¯é‡ŒåŒ–ä¸­ä¹Ÿå¯ä»¥æœ‰å¯¹åº”çš„å®ç”¨å‡½æ•°</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">partialProps</span>(<span class="params">fn, presetArgsObj</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">partiallyApplied</span>(<span class="params">laterArgsObj</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fn</span>(<span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, presetArgsObj, laterArgsObj))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">curryProps</span>(<span class="params">fn, arity = <span class="number">1</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (<span class="keyword">function</span> <span class="title function_">nextCurried</span>(<span class="params">prevArgsObj</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">curried</span>(<span class="params">nextArgObj = &#123;&#125;</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> [key] = <span class="title class_">Object</span>.<span class="title function_">keys</span>(nextArgObj) <span class="comment">// nextArgObj has only one value</span></span><br><span class="line">      <span class="keyword">var</span> allArgsObj = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, prevArgsObj, &#123; [key]: nextArgObj[key] &#125;)</span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Object</span>.<span class="title function_">keys</span>(allArgsObj).<span class="property">length</span> &gt;= arity) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">fn</span>(allArgsObj)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">nextCurried</span>(allArgsObj)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)(&#123;&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨å¯ä»¥æƒ³ä¼ å“ªä¸ªä½ç½®çš„å®å‚å°±ä¼ å“ªä¸ªäº†ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦æŒæ¡å‡½æ•° <code>fn(..</code> çš„å‡½æ•°ç­¾åï¼Œå¹¶ä¸”å¯ä»¥å®šä¹‰è¯¥å‡½æ•°çš„è¡Œä¸ºï¼Œä½¿å…¶è§£æ„ç¬¬ä¸€ä¸ªå‚æ•°æ—¶ï¼Œä¸Šé¢çš„æŠ€æœ¯æ‰èƒ½èµ·ä½œç”¨ã€‚é‚£å¦‚æœä¸€ä¸ªå‡½æ•°çš„å½¢å‚æ˜¯å„è‡ªç‹¬ç«‹ï¼ˆæ²¡æœ‰ç»è¿‡å½¢å‚è§£æ„ï¼‰ï¼Œè€Œä¸”ä¸æ”¹å˜å®ƒçš„å‡½æ•°ç­¾åï¼Œè¯¥æ€ä¹ˆåŠå‘¢</p>
<p>yepï¼Œjust like <code>spreadArgs(...)</code></p>
<p>ä½†æ˜¯å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œ<code>spreadArgs(...)</code> ä¸­å‚æ•°çš„é¡ºåºæ˜¯æ˜ç¡®çš„ï¼Œç„¶è€Œå¯¹è±¡å±æ€§çš„é¡ºåºä¸å¤ªæ˜ç¡®ä¸”ä¸å¯é â€¦ä¸€ä¸ªæœ€ç›´è§‚çš„æƒ³æ³•æ˜¯å†ä¼ å…¥ä¸€ä¸ªç±»ä¼¼ <code>[&#39;x&#39;, &#39;y&#39;, &#39;z&#39;]</code> è¿™æ ·çš„æ•°ç»„é€šçŸ¥æˆ‘ä»¬çš„å®ç”¨å‡½æ•°æ˜ç¡®çš„å‚æ•°é¡ºåºï¼Œä½†æ˜¯è¿™å¥½å¼±æ™ºï¼ä¸‹é¢ç»™å‡ºäº†ä¸€ç§ hack æŠ€å·§å¯ä»¥æ ¹æ®è§£æå‡½æ•°ä»£ç æœ¬èº«ï¼ˆç”± <code>.toString()</code> æ–¹æ³•å¯ä»¥è·å¾—ï¼‰å¾—åˆ°æ¯ä¸ªå•ç‹¬çš„å‘½åå½¢å‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">spreadArgProps</span>(<span class="params"></span></span><br><span class="line"><span class="params">  fn,</span></span><br><span class="line"><span class="params">  propOrder = </span></span><br><span class="line"><span class="params">          fn.toString()</span></span><br><span class="line"><span class="params">          .replace(/^(?:(?:<span class="keyword">function</span>.*\(([^]*?)\))|(?:([^\(\)]+?)\s*=&gt;)|(?:\(([^]*?)\)\s*=&gt;))[^]+$/, <span class="string">&quot;$1$2$3&quot;</span>)</span></span><br><span class="line"><span class="params">          .split(/\s*,\s*/)</span></span><br><span class="line"><span class="params">          .map(v =&gt; v.replace( /[=\s].*$/, <span class="string">&quot;&quot;</span> ))</span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">spreadFn</span>(<span class="params">argsObj</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fn</span>(...propOrder.<span class="title function_">map</span>(<span class="function"><span class="params">k</span> =&gt;</span> argsObj[k]))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ— å½¢å‚é£æ ¼ï¼ˆpoint-freeï¼‰&#x2F;éšæ€§ç¼–ç¨‹ï¼ˆtacit programmingï¼‰ï¼šé€šè¿‡ç§»é™¤ä¸å¿…è¦çš„å½¢å‚-å®å‚æ˜ å°„æ¥å‡å°‘è§†è§‰ä¸Šçš„å¹²æ‰°ï¼Œæé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç†è§£æ€§</p>
<p>ä½¿ç”¨æ— å½¢å‚é£æ ¼çš„å…³é”®ï¼Œæ˜¯æ‰¾åˆ°ä»£ç ä¸­ï¼Œæœ‰å“ªäº›åœ°æ–¹çš„å‡½æ•°ç›´æ¥å°†å…¶å½¢å‚ä½œä¸ºå†…éƒ¨å‡½æ•°è°ƒç”¨çš„å®å‚</p>
<p>å–åå‡½æ•°</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">not</span>(<span class="params">predicate</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">negated</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> !<span class="title function_">predicate</span>(...args)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>when(..)</code> å®ç”¨å‡½æ•°ï¼šç”¨äºè¡¨ç¤º <code>if</code> æ¡ä»¶å¥</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">when</span>(<span class="params">predicate, fn</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">conditional</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">predicate</span>(...args)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">fn</span>(...args)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ç»„åˆå‡½æ•°"><a href="#ç»„åˆå‡½æ•°" class="headerlink" title="ç»„åˆå‡½æ•°"></a>ç»„åˆå‡½æ•°</h2><blockquote>
<p>å‡½æ•°æœ‰å¤šç§å¤šæ ·çš„å½¢çŠ¶å’Œå¤§å°ã€‚æˆ‘ä»¬èƒ½å¤Ÿå®šä¹‰æŸç§ç»„åˆæ–¹å¼ï¼Œæ¥è®©å®ƒä»¬æˆä¸ºä¸€ç§æ–°çš„ç»„åˆå‡½æ•°ï¼Œç¨‹åºä¸­ä¸åŒçš„éƒ¨åˆ†éƒ½å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°ã€‚è¿™ç§å°†å‡½æ•°ä¸€èµ·ä½¿ç”¨çš„è¿‡ç¨‹å«åšç»„åˆã€‚</p>
</blockquote>
<p><code>compose2(..)</code> å®ç”¨å‡½æ•°ï¼šè‡ªåŠ¨åˆ›å»ºä¸¤ä¸ªå‡½æ•°çš„ç»„åˆï¼ˆä»å³å‘å·¦ç»„åˆï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">compose2</span>(<span class="params">fn2, fn1</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">composed</span>(<span class="params">origValue</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fn2</span>(<span class="title function_">fn1</span>(origValue))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šç”¨ç»„åˆå‡½æ•°</p>
<p>è¿™é‡Œçš„é¡ºåºä¾ç„¶æ˜¯ä»å³å‘å·¦çš„ï¼Œå¯ä»¥ç»“åˆä¸Šä¸€ç« æ‰€ä»‹ç»çš„ <code>partialRight(..)</code> å®ç”¨å‡½æ•°æŠŠ <code>compose(..)</code> çš„å‚æ•°å³åï¼Œè¿™æ ·å°±å¯ä»¥å…ˆä¼ å…¥ä¸€äº›å†…å±‚ï¼Œä¹‹åå†ä¸æ–­åŒ…å¤–å±‚å‡½æ•°ï¼ˆåŸæœ¬åœ¨å‚æ•°åˆ—è¡¨å·¦ä¾§ï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">compose</span>(<span class="params">...fns</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">composed</span>(<span class="params">result</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> list = fns.<span class="title function_">slice</span>()</span><br><span class="line">    <span class="keyword">while</span> (list.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      result = list.<span class="title function_">pop</span>()(result)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸åŒçš„å®ç°</p>
<p><strong>reduce</strong></p>
<p>ä¸Šé¢çš„åŸå§‹ç‰ˆæœ¬ <code>compose(..)</code> ä½¿ç”¨ä¸€ä¸ªå¾ªç¯å¹¶ä¸”é¥¥æ¸´çš„ï¼ˆç«‹åˆ»ï¼‰æ‰§è¡Œè®¡ç®—ï¼Œå°†ä¸€ä¸ªè°ƒç”¨çš„ç»“æœä¼ é€’ç»™ä¸‹ä¸€ä¸ªè°ƒç”¨ã€‚è¿™ä¸å°±æ˜¯ <code>reduce(..)</code>ï¼</p>
<p><code>reduce(..)</code> å¾ªç¯å‘ç”Ÿåœ¨æœ€åçš„ <code>composed(..)</code> è¿è¡Œæ—¶ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªä¸­é—´çš„ <code>result(..)</code> å°†ä¼šåœ¨ä¸‹ä¸€æ¬¡è°ƒç”¨æ—¶ä½œä¸ºè¾“å…¥å€¼ä¼ é€’ç»™ä¸‹ä¸€ä¸ªè¿­ä»£</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">compose</span>(<span class="params">...fns</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">composed</span>(<span class="params">result</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> fns.<span class="title function_">reverse</span>().<span class="title function_">reduce</span>(<span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">result, fn</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">fn</span>(result)</span><br><span class="line">    &#125;, result)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ï¼Œè¿™ç§å®ç°å­˜åœ¨è¿­ä»£é—®é¢˜æ˜¯æœ€å†…å±‚çš„ç»„åˆå‡½æ•°ï¼ˆä¹Ÿå°±æ˜¯ç»„åˆä¸­çš„ç¬¬ä¸€ä¸ªå‡½æ•°ï¼‰åªèƒ½æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå¦‚æœç»„åˆä¸­çš„æ¯ä¸€ä¸ªå‡½æ•°éƒ½æ˜¯ä¸€å…ƒçš„ï¼Œè¿™ä¸ªæ–¹æ¡ˆé—®é¢˜ä¸å¤§ã€‚ä½†å¦‚æœéœ€è¦ç»™ç¬¬ä¸€ä¸ªè°ƒç”¨ä¼ é€’å¤šå‚æ•°â€¦</p>
<blockquote>
<p>æƒ°æ€§è¿ç®—ï¼šç›´æ¥è¿”å› <code>reduce(..)</code> è°ƒç”¨çš„ç»“æœï¼Œè¯¥ç»“æœè‡ªèº«å°±æ˜¯ä¸ªå‡½æ•°ï¼Œä¸æ˜¯ä¸€ä¸ªè®¡ç®—è¿‡çš„å€¼ã€‚è¯¥å‡½æ•°è®©æˆ‘ä»¬èƒ½å¤Ÿä¼ å…¥ä»»æ„æ•°ç›®çš„å‚æ•°ï¼Œåœ¨æ•´ä¸ªç»„åˆè¿‡ç¨‹ä¸­ï¼Œå°†è¿™äº›å‚æ•°ä¼ å…¥åˆ°ç¬¬ä¸€ä¸ªå‡½æ•°è°ƒç”¨ä¸­ï¼Œç„¶åä¸€æ¬¡é“²é™¤ç»“æœç»™åˆ°åé¢çš„è°ƒç”¨</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">compose</span>(<span class="params">...fns</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> fns.<span class="title function_">reverse</span>().<span class="title function_">reduce</span>(<span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">fn1, fn2</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">composed</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">fn2</span>(<span class="title function_">fn1</span>(...args))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>é€’å½’</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">compose</span>(<span class="params">...fns</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> [fn1, fn2, ...rest] = fns.<span class="title function_">reverse</span>()</span><br><span class="line">  <span class="keyword">var</span> composedFn = <span class="keyword">function</span> <span class="title function_">composed</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fn2</span>(<span class="title function_">fn1</span>(...args))</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (rest.<span class="property">length</span> === <span class="number">0</span>) <span class="keyword">return</span> composedFn</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">compose</span>(...rest.<span class="title function_">reverse</span>(), composedFn)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é‡æ’åºç»„åˆï¼šä»¥å‡½æ•°æ‰§è¡Œçš„é¡ºåºæ¥æ’åˆ—å‚æ•°</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">pipe</span>(<span class="params">...fns</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">piped</span>(<span class="params">result</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> list = fns.<span class="title function_">slice</span>()</span><br><span class="line">    <span class="keyword">while</span> (list.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      result = list.<span class="title function_">shift</span>()(result)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–è€…ï¼Œåªæ˜¯å°† compose(..) çš„å‚æ•°åè½¬å°±å¯ä»¥</span></span><br><span class="line"><span class="keyword">var</span> pipe = <span class="title function_">reverseArgs</span>(compose)</span><br></pre></td></tr></table></figure>

<p>æŠ½è±¡ï¼šå¯¹ä¸¤ä¸ªæˆ–å¤šä¸ªä»»åŠ¡å…¬å…±éƒ¨åˆ†çš„å‰¥ç¦»ã€‚é€šç”¨éƒ¨åˆ†åªå®šä¹‰ä¸€æ¬¡ï¼Œä»è€Œé¿å…é‡å¤ã€‚ä¸ºäº†å±•ç°æ¯ä¸ªä»»åŠ¡çš„ç‰¹æ®Šéƒ¨åˆ†ï¼Œé€šç”¨éƒ¨åˆ†éœ€è¦è¢«å‚æ•°åŒ–</p>
<blockquote>
<p>DRY: donâ€™t repeat yourself. åŠ›æ±‚èƒ½åœ¨ç¨‹åºçš„ä»»ä½•ä»»åŠ¡ä¸­æœ‰å”¯ä¸€çš„å®šä¹‰</p>
<p>æˆ‘ä»¬ä¸æ˜¯ä¸ºäº†éšè—ç»†èŠ‚è€ŒæŠ½è±¡ï¼Œè€Œæ˜¯ä¸ºäº†é€šè¿‡åˆ†ç¦»æ¥çªå‡ºå…³æ³¨ç‚¹ã€‚</p>
<p>å‡½æ•°ç»„åˆå¹¶ä¸æ˜¯é€šè¿‡ DRY çš„åŸåˆ™æ¥èŠ‚çœä»£ç é‡ï¼Œè€Œæ˜¯ä»<em>æ€ä¹ˆåš</em>ä¸­åˆ†ç¦»å‡º<em>æ˜¯ä»€ä¹ˆ</em></p>
</blockquote>
<h2 id="å‡å°‘å‰¯ä½œç”¨"><a href="#å‡å°‘å‰¯ä½œç”¨" class="headerlink" title="å‡å°‘å‰¯ä½œç”¨"></a>å‡å°‘å‰¯ä½œç”¨</h2><p><strong>å‰¯ä½œç”¨</strong></p>
<ul>
<li>æœ‰å‰¯ä½œç”¨çš„å‡½æ•°å¯è¯»æ€§æ›´ä½ï¼Œå› ä¸ºå®ƒéœ€è¦æ›´å¤šçš„é˜…è¯»æ¥ç†è§£ç¨‹åºï¼ˆä¸ç¡®å®šè¿è¡Œä¸€ä¸ªå‡½æ•°ä¼šä¸ä¼šå½±å“å…¶ä»–åœ°æ–¹ï¼Œæ‰€ä»¥å¿…é¡»è¦å»è¯»å‡½æ•°å†…éƒ¨é€»è¾‘ï¼‰</li>
<li>æ‰€æœ‰å†³å®šå‡½æ•°è¾“å‡ºçš„åŸå› åº”è¯¥è¢«è®¾ç½®çš„ç›´æ¥å¹¶æ˜æ˜¾ï¼Œå‡½æ•°çš„ä½¿ç”¨è€…èƒ½ç›´æ¥çœ‹åˆ°åŸå› å’Œç»“æœ</li>
<li>å¹¶ä¸æ˜¯ç¦æ­¢å¼•ç”¨æ‰€æœ‰è‡ªç”±å˜é‡ï¼Œæ¯”å¦‚å¼•ç”¨å‡½æ•°&#x2F; <code>Math.PI</code> è¿™ç§ <em>â€œå¸¸é‡â€</em> å¼•ç”¨æ˜¯å¯ä»¥çš„ã€‚å› ä¸ºå®ƒä»¬åœ¨æ•´ä¸ªç¨‹åºä¸­éƒ½ä¸æ”¹å˜ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ‹…å¿ƒå°†å®ƒä»¬ä½œä¸ºå˜åŒ–çš„çŠ¶æ€è¿½è¸ªå®ƒä»¬ï¼›åŒæ ·ï¼Œä»–ä»¬ä¸ä¼šæŸå®³ç¨‹åºçš„å¯è¯»æ€§ï¼Œè€Œä¸”å®ƒä»¬ä¹Ÿä¸ä¼šå› ä¸ºå˜é‡ä»¥ä¸å¯é¢„æµ‹çš„æ–¹å¼å˜åŒ–è€Œæˆä¸ºé”™è¯¯çš„æºå¤´</li>
<li>éšæœºæ•°æ˜¯ä¸çº¯çš„</li>
<li>IO æ˜¯å‰¯ä½œç”¨</li>
<li>ä¸€ç³»åˆ—æœ‰å‰¯ä½œç”¨çš„å‡½æ•°å¯èƒ½ä¼šåœ¨å¼‚æ­¥è°ƒç”¨æ—¶é¡ºåºå‡ºé—®é¢˜ï¼ˆç‰¹åˆ«æ˜¯å›è°ƒï¼ï¼‰ï¼Œä»è€Œå¯¹å¤–éƒ¨é€ æˆå¥‡æ€ªçš„å½±å“</li>
</ul>
<p><strong>é™åˆ¶æ½œåœ¨é—®é¢˜</strong></p>
<ul>
<li>å¹‚ç­‰<ul>
<li>æ•°å­¦ä¸­çš„å¹‚ç­‰ï¼šåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨åï¼Œå¦‚æœä½ å°†è¯¥è¾“å‡ºä¸€æ¬¡åˆä¸€æ¬¡åœ°è¾“å…¥åˆ°æ“ä½œä¸­ï¼Œå…¶è¾“å‡ºæ°¸è¿œä¸ä¼šæ”¹å˜çš„æ“ä½œ</li>
<li>ç¼–ç¨‹ä¸­çš„å¹‚ç­‰ï¼šè¦æ±‚ <code>f(x)</code> æ¯æ¬¡è°ƒç”¨çš„ç»“æœå’Œç¬¬ä¸€æ¬¡è°ƒç”¨çš„ç»“æœæ²¡æœ‰ä»»ä½•æ”¹å˜</li>
<li>åœ¨ä»»ä½•å¯èƒ½çš„æƒ…å†µä¸‹é€šè¿‡å¹‚ç­‰çš„æ“ä½œé™åˆ¶å‰¯ä½œç”¨è¦æ¯”ä¸åšé™åˆ¶çš„æ›´æ–°å¥½å¾—å¤š</li>
</ul>
</li>
<li>çº¯å‡½æ•°ï¼šæ²¡æœ‰å‰¯ä½œç”¨çš„å‡½æ•°ï¼Œæ˜¯ä¸€ç§å¹‚ç­‰å‡½æ•°<ul>
<li>ç»™å®šç›¸åŒçš„è¾“å…¥æ€»æ˜¯äº§ç”Ÿç›¸åŒçš„è¾“å‡º</li>
<li>å…·æœ‰å¼•ç”¨é€æ˜æ€§ï¼šä¸€ä¸ªå‡½æ•°è°ƒç”¨å¯ä»¥è¢«å®ƒçš„è¾“å‡ºå€¼æ‰€ä»£æ›¿ï¼Œå¹¶ä¸”æ•´ä¸ªç¨‹åºçš„è¡Œä¸ºä¸ä¼šæ”¹å˜</li>
<li>ç¼–ç¨‹ä¸­çš„å¹‚ç­‰</li>
<li>ä¸€ä¸ªçº¯å‡½æ•°å¯ä»¥å¼•ç”¨è‡ªç”±å˜é‡ï¼Œåªè¦è¿™äº›è‡ªç”±å˜é‡ä¸æ˜¯ä¾§å› ï¼ˆe.g.é—­åŒ…ï¼‰</li>
<li>çº¯å‡½æ•°å’Œä¸çº¯çš„å‡½æ•°çš„åˆæˆæ€»æ˜¯äº§ç”Ÿä¸çº¯çš„å‡½æ•°</li>
</ul>
</li>
</ul>
<blockquote>
<p>å‡å°‘å‰¯ä½œç”¨çš„ç›®çš„å¹¶ä¸æ˜¯å®ƒä»¬åœ¨ç¨‹åºä¸­<em>ä¸èƒ½</em>è¢«è§‚å¯Ÿåˆ°ï¼Œè€Œæ˜¯è®¾è®¡ä¸€ä¸ªç¨‹åºï¼Œè®©å‰¯ä½œç”¨å°½å¯èƒ½çš„å°‘ï¼Œå› ä¸ºè¿™ä½¿ä»£ç æ›´å®¹æ˜“ç†è§£ã€‚ä¸€ä¸ªæ²¡æœ‰è§‚å¯Ÿåˆ°çš„<em>å‘ç”Ÿ</em>çš„å‰¯ä½œç”¨çš„ç¨‹åºï¼Œåœ¨è¿™ä¸ªç›®æ ‡ä¸Šï¼Œå¹¶ä¸åƒä¸€ä¸ª<em>ä¸èƒ½</em>è§‚å¯Ÿå®ƒä»¬çš„ç¨‹åºé‚£ä¹ˆæœ‰æ•ˆ</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºé‚£äº›ä¸å¾—ä¸å‘ç”Ÿçš„å‰¯ä½œç”¨ï¼Œæˆ‘ä»¬åº”è¯¥å°½å¯èƒ½ç¡®å®šç¨‹åºçš„ä»»ä½•éƒ¨åˆ†éƒ½<em>ä¸èƒ½</em>è§‚å¯Ÿåˆ°å®ƒä»¬ï¼Œè€Œä¸ä»…ä»…æ˜¯<em>ä¸</em>è§‚å¯Ÿå®ƒä»¬</p>
</blockquote>
<p><strong>çº¯åŒ–</strong></p>
<p>çº¯åº¦ä»…ä»…éœ€è¦æ·±å…¥åˆ°çš®è‚¤ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå‡½æ•°çš„çº¯åº¦æ˜¯ä»å¤–éƒ¨åˆ¤æ–­çš„ï¼Œåªè¦ä¸€ä¸ªå‡½æ•°çš„ä½¿ç”¨è¡¨ç°ä¸ºçº¯çš„ï¼Œå®ƒå°±æ˜¯çº¯çš„</p>
<ul>
<li>ä½¿ç”¨è¯æ³•è‡ªç”±å˜é‡å¯¼è‡´çš„å‰¯ä½œç”¨ï¼š<ul>
<li>å¦‚æœå¯ä»¥é€‰æ‹©ä¿®æ”¹å‘¨å›´çš„ä»£ç ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ä½œç”¨åŸŸæ¥å°è£…å®ƒä»¬</li>
<li>å¦‚æœæ— æ³•åœ¨å®¹å™¨å‡½æ•°çš„å†…éƒ¨å°è£…ä¿®æ”¹ä»£ç ï¼ˆæ¯”å¦‚æ¥è‡ªç¬¬ä¸‰æ–¹åº“çš„å‡½æ•°ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥åˆ›å»ºä¸€ä¸ªéš”ç¦»å‰¯ä½œç”¨çš„æ¥å£å‡½æ•°ï¼š<ol>
<li>æ•è·å—å½±å“çš„å½“å‰çŠ¶æ€</li>
<li>è®¾ç½®åˆå§‹è¾“å…¥çŠ¶æ€</li>
<li>è¿è¡Œä¸çº¯çš„å‡½æ•°</li>
<li>æ•è·å‰¯ä½œç”¨çŠ¶æ€</li>
<li>æ¢å¤åŸæ¥çš„çŠ¶æ€</li>
<li>è¿”å›æ•è·çš„å‰¯ä½œç”¨çŠ¶æ€</li>
</ol>
</li>
</ul>
</li>
<li>ç›´æ¥è¾“å…¥å€¼ï¼ˆå¯¹è±¡ã€æ•°ç»„ç­‰ï¼‰çš„çªå˜å¯¼è‡´çš„å‰¯ä½œç”¨ï¼šå†æ¬¡åˆ›å»ºä¸€ä¸ªæ¥å£å‡½æ•°æ¥æ›¿ä»£åŸå§‹çš„ä¸çº¯çš„å‡½æ•°å»äº¤äº’</li>
<li><code>this</code> å¯¼è‡´çš„ï¼š<ul>
<li><code>this</code> æ˜¯å‡½æ•°éšå¼çš„è¾“å…¥</li>
<li>åˆ›å»ºä¸€ä¸ªæ¥å£å‡½æ•°ï¼Œå¼ºåˆ¶å‡½æ•°ä½¿ç”¨å¯é¢„æµ‹çš„ <code>this</code> ä¸Šä¸‹æ–‡</li>
</ul>
</li>
</ul>
<h2 id="å€¼çš„ä¸å¯å˜æ€§"><a href="#å€¼çš„ä¸å¯å˜æ€§" class="headerlink" title="å€¼çš„ä¸å¯å˜æ€§"></a>å€¼çš„ä¸å¯å˜æ€§</h2><ul>
<li>åŸå§‹å€¼ï¼ˆnumber&#x2F;string&#x2F;boolean&#x2F;null&#x2F;undefinedï¼‰ï¼šæœ¬èº«å°±æ˜¯ä¸å¯å˜çš„</li>
<li>JS çš„ boxing ç‰¹æ€§ï¼šå½“è®¿é—®åŸå§‹æ•°æ®ç±»å‹æ—¶ï¼ˆç‰¹åˆ«æ˜¯ <code>number</code>&#x2F;<code>string</code>&#x2F;<code>boolean</code>ï¼‰ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒJS ä¼šè‡ªåŠ¨çš„æŠŠå®ƒä»¬åŒ…è£…æˆè¿™ä¸ªå€¼å¯¹åº”çš„å¯¹è±¡ï¼ˆ<code>Number</code>&#x2F;<code>String</code>&#x2F;<code>Boolean</code>ï¼‰</li>
<li>æ³¨æ„ï¼Œå­—ç¬¦ä¸²ä¹Ÿæ˜¯ä¸å¯å˜çš„ï¼Œ<code>s[1] = &#39;E&#39;</code> è¿™ç§èµ‹å€¼ä¼šé™é»˜å¤±è´¥</li>
</ul>
<p>å€¼çš„ä¸å¯å˜æ€§ï¼šå½“éœ€è¦æ”¹å˜ç¨‹åºä¸­çš„çŠ¶æ€æ—¶ï¼Œæˆ‘ä»¬ä¸èƒ½æ”¹å˜å·²å­˜åœ¨çš„æ•°æ®ï¼Œè€Œæ˜¯å¿…é¡»åˆ›å»ºå’Œè·Ÿè¸ªä¸€ä¸ªæ–°çš„æ•°æ®ï¼ˆæ¯”å¦‚æ•°ç»„ï¼Œå°±ä»¥æ‹·è´ä»£æ›¿æ”¹å˜ï¼Œä¸æ”¹å˜åŸæ•°ç»„è€Œæ˜¯æ‹·è´å‡ºæ¥å†æ”¹å˜ï¼‰</p>
<blockquote>
<p>å¸¸é‡ï¼šä¸€ä¸ªæ— æ³•é‡æ–°èµ‹å€¼çš„å˜é‡<br>å¸¸é‡ä¸å€¼çš„æœ¬è´¨æ— å…³ï¼Œæ— è®ºå¸¸é‡æ‰¿è½½ä½•å€¼ï¼Œè¯¥å˜é‡éƒ½ä¸èƒ½ä½¿ç”¨å…¶ä»–çš„å€¼è¢«è¿›è¡Œé‡æ–°èµ‹å€¼</p>
<p>æˆ‘ä»¬åº”è¯¥æ‹…å¿ƒçš„ï¼Œå¹¶ä¸æ˜¯å˜é‡æ˜¯å¦è¢«é‡æ–°èµ‹å€¼ï¼Œè€Œæ˜¯<em>å€¼æ˜¯å¦ä¼šå‘ç”Ÿæ”¹å˜</em></p>
</blockquote>
<p><code>Object.freeze(..)</code> åªæ˜¯å°†å¯¹è±¡çš„é¡¶å±‚è®¾ä¸ºä¸å¯å˜ï¼ŒåŸºæœ¬ä¸Šç›¸å½“äºä½¿ç”¨ <code>const</code> å£°æ˜å¯¹è±¡çš„æ¯ä¸ªå±æ€§</p>
<ul>
<li><code>const arr = [1, 2, 3]</code> å¾—åˆ°çš„æ•°ç»„ä¾ç„¶å¯å˜</li>
<li><code>Object.freeze([1, 2, 3])</code> çš„ç¡®æ˜¯ä¸å¯å˜çš„æ•°ç»„</li>
</ul>
<p><strong>æ€§èƒ½</strong></p>
<p>æ¯æ¬¡éƒ½é‡æ–°å¤åˆ¶ä¸€ä¸ªæ•°ç»„ï¼Œè‚¯å®šä¼šå½±å“æ€§èƒ½ã€‚å¦‚æœåªæ˜¯æ¯”è¾ƒå°‘çš„çŠ¶æ€å˜åŒ–ï¼Œè¿™æ ·çš„æ€§èƒ½æŸå¤±å¯ä»¥æ¥å—ï¼ˆæ¯•ç«Ÿå‡å°‘äº† debug æ—¶é—´ï¼ï¼‰ï¼›ä½†å¦‚æœéœ€è¦é¢‘ç¹æ”¹å˜çŠ¶æ€ï¼Œé‚£ä¹ˆæ¯æ¬¡éƒ½å¤åˆ¶è‚¯å®šæ˜¯ä¸è¡Œçš„ã€‚</p>
<p>è§£å†³åŠæ³•æ˜¯å¯ä»¥åƒ git ç‰ˆæœ¬æ§åˆ¶åŸç†é‚£æ ·ï¼Œç”¨ä¸€ä¸ªé“¾è¡¨è®°å½•çŠ¶æ€çš„å˜åŒ–è¿‡ç¨‹ã€‚<a target="_blank" rel="noopener" href="http://facebook.github.io/immutable-js">Immutable.js</a> æä¾›äº†è¿™æ ·çš„ä¸å¯å˜æ•°æ®ç»“æ„ã€‚</p>
<blockquote>
<p>æ— è®ºä¸–ç•Œä¸Šæ¥æ”¶åˆ°çš„å€¼æ˜¯å¦å¯å˜ï¼Œæˆ‘ä»¬éƒ½åº”ä»¥å®ƒä»¬æ˜¯ä¸å¯å˜çš„æ¥å¯¹å¾…ï¼Œä»¥æ­¤æ¥é¿å…å‰¯ä½œç”¨å¹¶ä½¿å‡½æ•°ä¿æŒçº¯åº¦</p>
<p>å€¼ä¸å˜åœ¨ä»£ç å¯è¯»æ€§ä¸Šçš„æ„ä¹‰ï¼Œä¸åœ¨äºä¸æ”¹å˜æ•°æ®ï¼Œè€Œåœ¨äºä»¥ä¸å¯å˜çš„çœ¼å…‰çœ‹å¾…æ•°æ®è¿™æ ·çš„çº¦æŸã€‚</p>
</blockquote>
<h2 id="é—­åŒ…-vs-å¯¹è±¡"><a href="#é—­åŒ…-vs-å¯¹è±¡" class="headerlink" title="é—­åŒ… vs å¯¹è±¡"></a>é—­åŒ… vs å¯¹è±¡</h2><blockquote>
<p>ä¸€ä¸ªæ²¡æœ‰é—­åŒ…çš„ç¼–ç¨‹è¯­è¨€å¯ä»¥ç”¨å¯¹è±¡æ¥æ¨¡æ‹Ÿé—­åŒ…ï¼›ä¸€ä¸ªæ²¡æœ‰å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€å¯ä»¥ç”¨é—­åŒ…æ¥æ¨¡æ‹Ÿå¯¹è±¡<br>æˆ‘ä»¬å¯ä»¥è®¤ä¸ºé—­åŒ…å’Œå¯¹è±¡æ˜¯ä¸€æ ·ä¸œè¥¿çš„ä¸¤ç§è¡¨è¾¾æ–¹å¼</p>
</blockquote>
<ul>
<li>éƒ½å¯ä»¥è¡¨è¾¾çŠ¶æ€é›†åˆ</li>
<li>ä¹Ÿéƒ½å¯ä»¥åŒ…å«å‡½æ•°æˆ–è€…æ–¹æ³•</li>
<li>å•Šå“ˆï¼Œå°è£…ï¼</li>
</ul>
<blockquote>
<p>é—­åŒ…å°†å•ä¸ªå‡½æ•°ä¸ä¸€ç³»åˆ—çŠ¶æ€ç»“åˆèµ·æ¥ï¼Œè€Œå¯¹è±¡å´åœ¨ä¿æœ‰ç›¸åŒçŠ¶æ€çš„åŸºç¡€ä¸Šï¼Œå…è®¸ä»»æ„æ•°é‡çš„å‡½æ•°æ¥æ“ä½œè¿™äº›çŠ¶æ€<br>ï¼ˆå½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨é—­åŒ…è¿”å›çš„å•ä¸ªå‡½æ•°é‡Œå†™ä¸ª switch ä¹‹ç±»çš„ï¼Œæ¥è¾¾åˆ°å’Œå¯¹è±¡çš„å¤šä¸ªå‡½æ•°ç›¸åŒçš„å®ç°æ•ˆæœï¼‰</p>
</blockquote>
<p>å¯¹è±¡å’Œé—­åŒ…åœ¨å¯å˜è¿™ç‚¹ä¸Šæ²¡æœ‰å…³ç³»ï¼Œå› ä¸ºæˆ‘ä»¬å…³å¿ƒçš„æ˜¯<em>å€¼</em>çš„å¯å˜æ€§ï¼Œå€¼å¯å˜æ˜¯å€¼æœ¬èº«çš„ç‰¹æ€§ï¼Œä¸åœ¨äºåœ¨å“ªé‡Œæˆ–è€…å¦‚ä½•è¢«èµ‹å€¼çš„</p>
<p><strong>åŒæ„</strong></p>
<blockquote>
<p>ä¸¤ä»¶äº‹ç‰© A å’Œ B å¦‚æœä½ èƒ½å¤Ÿæ˜ å°„ï¼ˆè½¬åŒ–ï¼‰A åˆ° B å¹¶ä¸”èƒ½å¤Ÿé€šè¿‡åå‘æ˜ å°„å› A é‚£ä¹ˆå®ƒä»¬å°±æ˜¯åŒæ„</p>
<p>å¦‚æœ JS æœ‰åŒæ„çš„è¯æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿå®ƒå¯èƒ½æ˜¯ä¸€é›†åˆçš„ JS ä»£ç è½¬åŒ–ä¸ºäº†å¦ä¸€é›†åˆçš„ JS ä»£ç ï¼Œå¹¶ä¸”ï¼ˆé‡è¦çš„æ˜¯ï¼‰å¦‚æœä½ æ„¿æ„çš„è¯ï¼Œä½ å¯ä»¥æŠŠè½¬åŒ–åçš„ä»£ç è½¬ä¸ºä¹‹å‰çš„ã€‚</p>
</blockquote>
<p>é—­åŒ…å’Œå¯¹è±¡æ˜¯çŠ¶æ€ï¼ˆåŠå…¶ç›¸å…³åŠŸèƒ½ï¼‰çš„åŒæ„è¡¨ç¤º</p>
<p><strong>åŒºåˆ«</strong></p>
<ul>
<li>é—­åŒ…çš„ç»“æ„æ˜¯ä¸å¯å˜çš„ï¼ˆæ‰€ä»¥å¦‚æœåƒå¤åˆ¶æ•°ç»„è¿™ç§æ“ä½œï¼Œåªèƒ½å°è£…æ›´å¤šçš„é—­åŒ…ï¼‰ï¼›å¯¹è±¡é»˜è®¤æ˜¯å®Œå…¨å¯å˜çš„</li>
<li>é—­åŒ…é€šè¿‡è¯æ³•ä½œç”¨åŸŸæä¾›â€œç§æœ‰â€çŠ¶æ€ï¼›è€Œå¯¹è±¡å°†ä¸€åˆ‡ä½œä¸ºå…¬å…±å±æ€§æš´éœ²ï¼ˆé—­åŒ…è¿™ç§ä¿¡æ¯éšè—åè€Œä¸åˆ©äºè·Ÿè¸ªä½¿ç”¨çŠ¶æ€ï¼›åŒæ—¶ï¼Œé—­åŒ…å…·æœ‰æ§åˆ¶å†…éƒ¨å˜é‡åªèƒ½è¢«é—­åŒ…å†…éƒ¨ä»£ç æ“ä½œçš„ç‰¹æ€§ï¼Œè¿™ä¸€ç‚¹æ¯”ä¹‹å‰è®¨è®ºçš„ <code>const</code> å¥½ç”¨</li>
<li>åƒä¸Šä¸€ç« æåˆ°çš„çŠ¶æ€æ‹·è´ï¼Œåœ¨å¯¹è±¡ä¸Šå¾ˆå®¹æ˜“å®ç°ï¼›è€Œé—­åŒ…ä¸Šå°±å¾ˆéº»çƒ¦ï¼Œéœ€è¦é¢å¤–å®šä¹‰å¾ˆå¤šæ‹¥æœ‰æå–æˆ–æ‹·è´éšè—å€¼æƒé™çš„å‡½æ•°â€¦</li>
<li>å¯¹è±¡åœ¨æ€§èƒ½ä¸Šé€šå¸¸æ¯”é—­åŒ…å¥½ï¼Œå› ä¸º JS å¯¹è±¡é€šå¸¸åœ¨å†…å­˜ç”šè‡³è®¡ç®—è§’åº¦æ˜¯æ›´åŠ è½»é‡çš„</li>
</ul>
<h2 id="åˆ—è¡¨æ“ä½œ"><a href="#åˆ—è¡¨æ“ä½œ" class="headerlink" title="åˆ—è¡¨æ“ä½œ"></a>åˆ—è¡¨æ“ä½œ</h2><p>éå‡½æ•°å¼ç¼–ç¨‹çš„åˆ—è¡¨å¤„ç†ï¼š</p>
<ul>
<li><code>forEach(..)</code>ï¼šæœ‰å‰¯ä½œç”¨ï¼</li>
<li><code>some(..)</code>&#x2F;<code>every(..)</code>ï¼šè™½ç„¶é¼“åŠ±ä½¿ç”¨çº¯å‡½æ•°ï¼Œä½†ä¸å¯é¿å…åœ°å°†åˆ—è¡¨ç®€åŒ–ä¸º <code>true</code> æˆ– <code>false</code> çš„å€¼ï¼Œæœ¬è´¨ä¸Šå°±åƒæœç´¢å’ŒåŒ¹é…</li>
</ul>
<h3 id="æ˜ å°„-map"><a href="#æ˜ å°„-map" class="headerlink" title="æ˜ å°„ map(...)"></a>æ˜ å°„ <code>map(...)</code></h3><p>æ˜ å°„ï¼šå°†ä¸€ä¸ªå€¼è½¬æ¢ä¸ºå¦ä¸€ä¸ªå€¼ï¼ˆä»ä¸€ä¸ªåœ°æ–¹æ˜ å°„åˆ°å¦ä¸€ä¸ªæ–°çš„åœ°æ–¹ï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">map</span>(<span class="params">mapperFn, arr</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> newList = []</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> idx = <span class="number">0</span>; idx &lt; arr.<span class="property">length</span>; idx++) &#123;</span><br><span class="line">    newList.<span class="title function_">push</span>(<span class="title function_">mapperFn</span>(arr[idx], idx, arr))</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> newList</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œ <code>mapperFn(..)</code> çš„å‚æ•°å’ŒåŸç”Ÿä¸€è‡´æ˜¯ä¸‰ä¸ªï¼Œå¦‚æœå¸Œæœ›åªä¼ ç¬¬ä¸€ä¸ªè¿›å»ï¼Œå¯ä»¥ç”¨ä¹‹å‰ä»‹ç»è¿‡çš„ <code>unary(..)</code> </p>
<p><code>map(..)</code> ä½¿å¾—å¯ä»¥æ–¹ä¾¿çš„åšåˆ—è¡¨çš„é“¾å¼æ“ä½œ</p>
<p><code>map(..)</code> çš„æ¯ä¸ªè½¬æ¢åº”è¯¥ç‹¬ç«‹ä¸å…¶ä»–çš„è½¬æ¢ï¼Œæ²¡æœ‰ä»å·¦å¾€å³çš„æ‰§è¡Œé¡ºåº</p>
<blockquote>
<p>å‡½å­æ˜¯é‡‡ç”¨è¿ç®—å‡½æ•°æœ‰æ•ˆç”¨æ“ä½œçš„å€¼<br>å‡½å­åœ¨æ¯ä¸ªå•ç‹¬çš„å€¼ä¸Šæ‰§è¡Œæ“ä½œå‡½æ•°ï¼Œå‡½å­å®ç”¨å‡½æ•°åˆ›å»ºçš„æ–°å€¼æ˜¯æ‰€æœ‰å•ä¸ªæ“ä½œå‡½æ•°æ‰§è¡Œç»“æœçš„ç»„åˆ</p>
<p><code>map(..)</code> å‡½æ•°é‡‡ç”¨å…³è”å€¼ï¼ˆæ•°ç»„ï¼‰å’Œæ˜ å°„å‡½æ•°ï¼ˆæ“ä½œå‡½æ•°ï¼‰ï¼Œå¹¶ä¸ºæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªç‹¬ç«‹å…ƒç´ æ‰§è¡Œæ˜ å°„å‡½æ•°ã€‚æœ€åï¼Œå®ƒè¿”å›ç”±æ‰€æœ‰æ–°æ˜ å°„å€¼ç»„æˆçš„æ–°æ•°ç»„</p>
</blockquote>
<h3 id="è¿‡æ»¤-filter"><a href="#è¿‡æ»¤-filter" class="headerlink" title="è¿‡æ»¤ filter(..)"></a>è¿‡æ»¤ <code>filter(..)</code></h3><p><code>filter(..)</code> ä¸­é‚£ä¸ªè¿”å› <code>true/false</code> æ¥åšå†³å®šï¼ˆæ¯ä¸€é¡¹åœ¨æ–°æ•°ç»„ä¸­ä¿ç•™è¿˜æ˜¯å‰”é™¤ï¼‰çš„å‡½æ•°æœ‰ä¸€ä¸ªç‰¹åˆ«çš„ç§°è°“ï¼šè°“è¯å‡½æ•°</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">filter</span>(<span class="params">predicateFn, arr</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> newList = []</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> idx = <span class="number">0</span>; idx &lt; arr.<span class="property">length</span>; idx++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">predicateFn</span>(arr[idx], idx, arr)) &#123;</span><br><span class="line">      newList.<span class="title function_">push</span>(arr[idx])</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> newList</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†è§£å†³è¯­ä¹‰é—®é¢˜ï¼ˆä¼ å…¥çš„è°“è¯å‡½æ•°å‘½åé—®é¢˜ï¼‰ï¼Œæˆ‘ä»¬å®šä¹‰</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> filterFn = filter</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">filterOut</span>(<span class="params">predicateFn, arr</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">filterIn</span>(<span class="title function_">not</span>(predicateFn), arr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// so...</span></span><br><span class="line"><span class="title function_">isOdd</span>(<span class="number">3</span>) <span class="comment">// true</span></span><br><span class="line"><span class="title function_">isEven</span>(<span class="number">2</span>) <span class="comment">// true</span></span><br><span class="line"><span class="title function_">filterIn</span>(isOdd, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]) <span class="comment">// [1, 3, 5]</span></span><br><span class="line"><span class="title function_">filterOut</span>(isEven, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]) <span class="comment">// [1, 3, 5]</span></span><br></pre></td></tr></table></figure>

<h3 id="ç¼©å‡-reduce"><a href="#ç¼©å‡-reduce" class="headerlink" title="ç¼©å‡ reduce(..)"></a>ç¼©å‡ <code>reduce(..)</code></h3><p>&#x3D; ç»„åˆ&#x2F;ç¼©å‡&#x2F;æŠ˜å  &#x3D; å°†ä¸¤ä¸ªå€¼åˆå¹¶æˆä¸€ä¸ªå€¼</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">reduce</span>(<span class="params">reducerFn, initialValue, arr</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> acc, startIdx</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">arguments</span>.<span class="property">length</span> == <span class="number">3</span>) &#123;</span><br><span class="line">    acc = initialValue</span><br><span class="line">    startIdx = <span class="number">0</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (arr.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    acc = arr[<span class="number">0</span>]</span><br><span class="line">    startIdx = <span class="number">1</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Must provide at least one value.&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> idx = startIdx; idx &lt; arr.<span class="property">length</span>; idx++) &#123;</span><br><span class="line">    acc = <span class="title function_">reducerFn</span>(acc, arr[idx], idx, arr)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> acc</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥å°† <code>reduce(..)</code> è®¤ä¸ºæ˜¯å°†å‡½æ•°ä»å·¦åˆ°å³ç»„åˆï¼ˆjust like <code>pipe(..)</code>ï¼‰ï¼Œå¯ä»¥è¿™æ ·ä½¿ç”¨</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title function_">binary</span> = fn =&gt; <span class="function">(<span class="params">arg1, arg2</span>) =&gt;</span> <span class="title function_">fn</span>(arg1, arg2)</span><br><span class="line"><span class="keyword">var</span> pipeReducer = <span class="title function_">binary</span>(pipe)</span><br><span class="line"><span class="keyword">var</span> fn = [<span class="number">3</span>, <span class="number">17</span>, <span class="number">6</span>, <span class="number">4</span>]</span><br><span class="line">  .<span class="title function_">map</span>(<span class="function"><span class="params">v</span> =&gt;</span> <span class="function"><span class="params">n</span> =&gt;</span> v * n)</span><br><span class="line">  .<span class="title function_">reduce</span>(pipeReducer)</span><br></pre></td></tr></table></figure>

<p>JS è¿˜æä¾›äº† <code>reduceRight(..)</code></p>
<p><strong>map ä¹Ÿæ˜¯ reduce</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title function_">double</span> = v =&gt; v * <span class="number">2</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].<span class="title function_">map</span>(double) <span class="comment">// [2, 4, 6, 8, 10]</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].<span class="title function_">reduce</span>(<span class="function">(<span class="params">list, v</span>) =&gt;</span> (list.<span class="title function_">push</span>(<span class="title function_">double</span>(v)), list), []) <span class="comment">// [2, 4, 6, 8, 10]</span></span><br></pre></td></tr></table></figure>

<p><strong>filter ä¹Ÿæ˜¯ reduce</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title function_">isOdd</span> = v =&gt; v % <span class="number">2</span> == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].<span class="title function_">filter</span>(isOdd) <span class="comment">// [1, 3, 5]</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].<span class="title function_">reduce</span>(<span class="function">(<span class="params">list, v</span>) =&gt;</span> (</span><br><span class="line">  <span class="title function_">isOdd</span>(v) ? list.<span class="title function_">push</span>(v) : <span class="literal">undefined</span>,</span><br><span class="line">  list</span><br><span class="line">), []) <span class="comment">// [1, 3, 5]</span></span><br></pre></td></tr></table></figure>

<h3 id="å»é‡"><a href="#å»é‡" class="headerlink" title="å»é‡"></a>å»é‡</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨ indexOf ç­›é€‰æ—¶ï¼Œæ˜¯ä»å·¦å‘å³</span></span><br><span class="line"><span class="comment">// æ‰¾åˆ°çš„ä½ç½®ä¸ idx ç›¸ç­‰è¯´æ˜è¯¥é¡¹æ˜¯ç¬¬ä¸€æ¬¡å‡ºç°</span></span><br><span class="line"><span class="keyword">var</span> <span class="title function_">unique</span> = </span><br><span class="line">  arr =&gt;</span><br><span class="line">    arr.<span class="title function_">filter</span>(</span><br><span class="line">      <span class="function">(<span class="params">v, idx</span>) =&gt;</span></span><br><span class="line">        arr.<span class="title function_">indexOf</span>(v) === idx</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å½“åˆ—è¡¨é¡¹ä¸èƒ½åœ¨æ–°åˆ—è¡¨ä¸­æ‰¾åˆ°æ—¶ï¼Œå°†å…¶æ’å…¥åˆ°æ–°çš„åˆ—è¡¨ä¸­</span></span><br><span class="line"><span class="keyword">var</span> <span class="title function_">unique</span> = </span><br><span class="line">  arr =&gt;</span><br><span class="line">    arr.<span class="title function_">reduce</span>(</span><br><span class="line">      <span class="function">(<span class="params">list, v</span>) =&gt;</span> </span><br><span class="line">        list.<span class="title function_">indexOf</span>(v) === -<span class="number">1</span> ? (list.<span class="title function_">push</span>(v), list) : list</span><br><span class="line">    , [])</span><br></pre></td></tr></table></figure>

<h3 id="æ‰å¹³åŒ–"><a href="#æ‰å¹³åŒ–" class="headerlink" title="æ‰å¹³åŒ–"></a>æ‰å¹³åŒ–</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title function_">flatten</span> = </span><br><span class="line">  arr =&gt; </span><br><span class="line">    arr.<span class="title function_">reduce</span>(</span><br><span class="line">      <span class="function">(<span class="params">list, v</span>) =&gt;</span> </span><br><span class="line">        list.<span class="title function_">concat</span>(<span class="title class_">Array</span>.<span class="title function_">isArray</span>(v) ? <span class="title function_">flatten</span>(v) : v)</span><br><span class="line">    , [])</span><br></pre></td></tr></table></figure>

<p><code>flatten(..)</code> çš„å¸¸ç”¨ç”¨æ³•ä¹‹ä¸€æ˜¯å½“ä½ æ˜ å°„ä¸€ç»„å…ƒç´ åˆ—è¡¨ï¼Œå¹¶å°†æ¯ä¸€é¡¹å€¼ä»åŸæ¥çš„å€¼è½¬æ¢ä¸ºæ•°ç»„ï¼ˆå¦‚æœä¸æƒ³è¦è¿”å›çš„äºŒç»´æ•°ç»„ï¼‰</p>
<h3 id="Zip"><a href="#Zip" class="headerlink" title="Zip"></a>Zip</h3><p>äº¤æ›¿é€‰æ‹©ä¸¤ä¸ªè¾“å…¥åªèƒ½åˆ—è¡¨çš„å€¼ï¼Œå¹¶å°†å¾—åˆ°çš„å€¼ç»„æˆå­åˆ—è¡¨</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">zip</span>(<span class="params">arr1, arr2</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> zipped = []</span><br><span class="line">  arr1 = arr1.<span class="title function_">slice</span>()</span><br><span class="line">  arr2 = arr2.<span class="title function_">slice</span>()</span><br><span class="line">  <span class="keyword">while</span> (arr1.<span class="property">length</span> &gt; <span class="number">0</span> &amp;&amp; arr2.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    zipped.<span class="title function_">push</span>([arr1.<span class="title function_">shift</span>(), arr2.<span class="title function_">shift</span>()])</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> zipped</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™ä¸ªå®ç°æ˜æ˜¾å­˜åœ¨ä¸€äº›éå‡½æ•°å¼ç¼–ç¨‹çš„æ€æƒ³ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªå‘½ä»¤å¼çš„ <code>while</code> å¾ªç¯å¹¶ä¸”é‡‡ç”¨ <code>shift()</code> å’Œ <code>push(..)</code> æ”¹å˜åˆ—è¡¨ã€‚è™½ç„¶åœ¨çº¯å‡½æ•°ä¸­ä½¿ç”¨äº†éçº¯çš„è¡Œä¸ºï¼ˆé€šå¸¸æ˜¯ä¸ºäº†æ€§èƒ½ï¼‰ï¼Œä½†åªè¦å…¶äº§ç”Ÿçš„å‰¯ä½œç”¨å®Œå…¨åŒ…å«åœ¨è¿™ä¸ªå‡½æ•°å†…éƒ¨ï¼Œè¿™ç§å®ç°å°±æ˜¯å®‰å…¨çº¯å‡€çš„</p>
</blockquote>
<h3 id="åˆå¹¶"><a href="#åˆå¹¶" class="headerlink" title="åˆå¹¶"></a>åˆå¹¶</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">mergeLists</span>(<span class="params">arr1, arr2</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> merged = []</span><br><span class="line">  arr1 = arr1.<span class="title function_">slice</span>()</span><br><span class="line">  arr2 = arr2.<span class="title function_">slice</span>()</span><br><span class="line">  <span class="keyword">while</span> (arr1.<span class="property">length</span> &gt; <span class="number">0</span> || arr2.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr1.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      merged.<span class="title function_">push</span>(arr1.<span class="title function_">shift</span>())</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (arr2.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      merged.<span class="title function_">push</span>(arr2.<span class="title function_">shift</span>())</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> merged</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç¼–ç¨‹é£æ ¼"><a href="#ç¼–ç¨‹é£æ ¼" class="headerlink" title="ç¼–ç¨‹é£æ ¼"></a>ç¼–ç¨‹é£æ ¼</h3><p>JS ä¸­é€šå¸¸ä½¿ç”¨é“¾å¼è°ƒç”¨ï¼Œè€Œå‡½æ•°å¼ç¼–ç¨‹å–œæ¬¢åµŒå¥—å¼çš„è°ƒç”¨ï¼Œä½†æ˜¯ç”¨äº <code>compose(..)</code> éƒ½ä¸å¤ªåˆé€‚â€¦</p>
<p>é“¾å¼ç»„åˆæ–¹æ³•</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title function_">partialThis</span> = </span><br><span class="line">  (<span class="params">fn, ...presetArgs</span>) =&gt; </span><br><span class="line">    <span class="comment">// æ•…æ„ç”¨ function ä¸ºäº†è·å¾— this ç»‘å®š</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">partiallyApplied</span>(<span class="params">...laterArgs</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>, [...presetArgs, ...laterArgs])</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">var</span> <span class="title function_">composeChainedMethods</span> = </span><br><span class="line">  (<span class="params">...fns</span>) =&gt;</span><br><span class="line">    <span class="function"><span class="params">result</span> =&gt;</span></span><br><span class="line">      <span class="comment">// result æ˜¯å‰ä¸€æ­¥ä¼ å…¥çš„ this</span></span><br><span class="line">      fns.<span class="title function_">reduceRight</span>(<span class="function">(<span class="params">result, fn</span>) =&gt;</span> fn.<span class="title function_">call</span>(result), result)</span><br><span class="line"></span><br><span class="line"><span class="title function_">composeChainedMethods</span>(</span><br><span class="line">  <span class="title function_">partialThis</span>(<span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">reduce</span>, sum, <span class="number">0</span>),</span><br><span class="line">  <span class="title function_">partialThis</span>(<span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">map</span>, double),</span><br><span class="line">  <span class="title function_">partialThis</span>(<span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">filter</span>, isOdd)</span><br><span class="line">)</span><br><span class="line">([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]) <span class="comment">// 18</span></span><br></pre></td></tr></table></figure>

<p>ç‹¬ç«‹ç»„åˆå®ç”¨å‡½æ•°</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title function_">filter</span> = (<span class="params">arr, predicateFn</span>) =&gt; arr.<span class="title function_">filter</span>(predicateFn)</span><br><span class="line"><span class="keyword">var</span> <span class="title function_">map</span> = (<span class="params">arr, mapperFn</span>) =&gt; arr.<span class="title function_">map</span>(mapperFn)</span><br><span class="line"><span class="keyword">var</span> <span class="title function_">reduce</span> = (<span class="params">arr, reducerFn, initialValue</span>) =&gt; arr.<span class="title function_">reduce</span>(reduceFn, initialValue)</span><br><span class="line"></span><br><span class="line"><span class="comment">// arr æ˜¯ç¬¬ä¸€ä¸ªï¼Œéœ€è¦å³åä¸€ä¸‹</span></span><br><span class="line"><span class="title function_">compose</span>(</span><br><span class="line">  <span class="title function_">partialRight</span>(reduce, sum, <span class="number">0</span>),</span><br><span class="line">  <span class="title function_">partialRight</span>(map, double),</span><br><span class="line">  <span class="title function_">partialRight</span>(filter, isOdd)</span><br><span class="line">)</span><br><span class="line">([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]) <span class="comment">// 18</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸è¿‡ä¸€èˆ¬å‡½æ•°å¼ç¼–ç¨‹ç±»åº“éƒ½æ˜¯ç›´æ¥æŠŠ arr æ”¾æœ€åä¸€ä¸ªäº†</span></span><br><span class="line"><span class="comment">// é¡ºä¾¿è¿˜æŸ¯é‡ŒåŒ–ä¸€ä¸‹</span></span><br><span class="line"><span class="keyword">var</span> filter = <span class="title function_">curry</span>(</span><br><span class="line">  <span class="function">(<span class="params">predicateFn, arr</span>) =&gt;</span></span><br><span class="line">    arr.<span class="title function_">filter</span>(predicateFn)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">var</span> map = <span class="title function_">curry</span>(</span><br><span class="line">  <span class="function">(<span class="params">mapperFn, arr</span>) =&gt;</span></span><br><span class="line">    arr.<span class="title function_">map</span>(mapperFn)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">var</span> reduce = <span class="title function_">curry</span>(</span><br><span class="line">  <span class="function">(<span class="params">reducerFn, initialValue, arr</span>) =&gt;</span></span><br><span class="line">    arr.<span class="title function_">reduce</span>(reducerFn, initialValue)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®Œç¾ï¼</span></span><br><span class="line"><span class="title function_">compose</span>(</span><br><span class="line">  <span class="title function_">reduce</span>(sum)(<span class="number">0</span>),</span><br><span class="line">  <span class="title function_">map</span>(double),</span><br><span class="line">  <span class="title function_">filter</span>(idOdd)</span><br><span class="line">)</span><br><span class="line">([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]) <span class="comment">// 18</span></span><br></pre></td></tr></table></figure>

<p>å‘ç°ä¸Šé¢çš„å®šä¹‰éƒ½å¾ˆå¥—è·¯ï¼éƒ½æ˜¯æ´¾å‘ç›¸åº”çš„åŸç”Ÿæ•°ç»„æ–¹æ³•ï¼Œé‚£ä¸å°±å¯ä»¥å†å†™ä¸ªå‡½æ•°åšè¿™ä»¶äº‹ï¼</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title function_">unboundMethod</span> = </span><br><span class="line">  (<span class="params">methodName, argCount = <span class="number">2</span></span>) =&gt;</span><br><span class="line">    <span class="title function_">curry</span>(</span><br><span class="line">      <span class="function">(<span class="params">...args</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> obj = args.<span class="title function_">pop</span>()</span><br><span class="line">        <span class="keyword">return</span> obj[methodName](...args)</span><br><span class="line">      &#125;,</span><br><span class="line">      argCount <span class="comment">// ç¬¬äºŒä¸ªå‚æ•°æ˜¯ arity</span></span><br><span class="line">    )</span><br><span class="line"><span class="keyword">var</span> filter = <span class="title function_">unboundMethod</span>(<span class="string">&#x27;filter&#x27;</span>, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">var</span> map = <span class="title function_">unboundMethod</span>(<span class="string">&#x27;map&#x27;</span>, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">var</span> reduce = <span class="title function_">unboundMethod</span>(<span class="string">&#x27;reduce&#x27;</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›´åˆ°è¿™æ—¶æ‰ç¡®å®š curry é‡Œé¢çš„ç¬¬ä¸€ä¸ªå‡½æ•°çš„ obj = args.pop()</span></span><br><span class="line"><span class="comment">// äº‹å®ä¸Šæ˜¯ thisï¼ï¼ˆä¹Ÿå°±æ˜¯ Array Objectï¼‰</span></span><br><span class="line"><span class="comment">// methodName è¢«é—­åŒ…ä¿å­˜èµ·æ¥äº†</span></span><br><span class="line"><span class="title function_">compose</span>(</span><br><span class="line">  <span class="title function_">reduce</span>(sum)(<span class="number">0</span>),</span><br><span class="line">  <span class="title function_">map</span>(double),</span><br><span class="line">  <span class="title function_">filter</span>(idOdd)</span><br><span class="line">)</span><br><span class="line">([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]) <span class="comment">// 18</span></span><br></pre></td></tr></table></figure>

<p>å½“ç„¶å’§ï¼Œä¹Ÿæœ‰åŠæ³•æŠŠæˆ‘ä»¬çš„ç‹¬ç«‹å‡½æ•°ï¼ˆä¸Šé¢å®šä¹‰çš„ å»é‡ æ‰å¹³ zip ç­‰ç­‰ï¼‰å˜æˆå¯ä»¥é“¾å¼è°ƒç”¨çš„æ•°ç»„æ–¹æ³•ï¼ˆå½“ç„¶ä¸æ˜¯ç›´æ¥æ”¹ <code>Array.prototype</code> ï¼ï¼‰ã€‚ä¸€ä¸ªæ€è·¯æ˜¯æŠŠç‹¬ç«‹å‡½æ•°é€‚é…æˆä¸€ä¸ªç¼©å‡å‡½æ•°ï¼Œç„¶åä¼ ç»™ <code>reduce(..)</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŸç‹¬ç«‹å‡½æ•°çš„å®šä¹‰</span></span><br><span class="line"><span class="keyword">var</span> <span class="title function_">flatten</span> = </span><br><span class="line">  arr =&gt; </span><br><span class="line">    arr.<span class="title function_">reduce</span>(</span><br><span class="line">      <span class="function">(<span class="params">list, v</span>) =&gt;</span> </span><br><span class="line">        list.<span class="title function_">concat</span>(<span class="title class_">Array</span>.<span class="title function_">isArray</span>(v) ? <span class="title function_">flatten</span>(v) : v)</span><br><span class="line">    , [])</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">flattenReducer</span>(<span class="params">list, v</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> list.<span class="title function_">concat</span>(</span><br><span class="line">    <span class="title class_">Array</span>.<span class="title function_">isArray</span>(v) ? v.<span class="title function_">reduce</span>(flattenReducer, []) : v</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="number">4</span>, <span class="number">5</span>, [<span class="number">6</span>, [<span class="number">7</span>, <span class="number">8</span>]]]</span><br><span class="line">.<span class="title function_">reduce</span>(flattenReducer, [])</span><br></pre></td></tr></table></figure>

<p>æ¡ä»¶ç¡®ä¿å®ç”¨å‡½æ•°</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title function_">guard</span> = </span><br><span class="line">  fn =&gt;</span><br><span class="line">    <span class="function"><span class="params">arg</span> =&gt;</span></span><br><span class="line">      arg != <span class="literal">null</span> ? <span class="title function_">fn</span>(arg) : arg</span><br></pre></td></tr></table></figure>

<p><strong>é“¾å¼ç»„åˆé£æ ¼</strong>ï¼šå£°æ˜å¼çš„ï¼Œå¾ˆå®¹æ˜“çœ‹å‡ºè¯¦å°½çš„æ‰§è¡Œæ­¥éª¤å’Œé¡ºåºï¼›ä½†æ¯ä¸€ä¸ªåˆ—è¡¨æ“ä½œéƒ½éœ€è¦å¾ªç¯æ•´ä¸ªåˆ—è¡¨ï¼Œæ„å‘³ç€ä¸å¿…è¦çš„æ€§èƒ½æŸå¤±</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">someList</span><br><span class="line">.<span class="title function_">filter</span>(..)</span><br><span class="line">.<span class="title function_">filter</span>(..)</span><br><span class="line">.<span class="title function_">map</span>(..)</span><br><span class="line">.<span class="title function_">map</span>(..)</span><br><span class="line">.<span class="title function_">map</span>(..)</span><br><span class="line">.<span class="title function_">reduce</span>(..)</span><br></pre></td></tr></table></figure>

<p><strong>äº¤æ›¿ç‹¬ç«‹é£æ ¼</strong>ï¼šæ“ä½œè‡ªä¸‹è€Œä¸Šåˆ—å‡ºï¼ŒåŒæ ·ä¼šå¤šæ¬¡å¾ªç¯åˆ—è¡¨</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">map</span>(</span><br><span class="line">  fn3,</span><br><span class="line">  <span class="title function_">map</span>(</span><br><span class="line">    fn2,</span><br><span class="line">    <span class="title function_">map</span>(fn1, someList)</span><br><span class="line">  )</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><strong>èåˆ</strong>ï¼šåˆå¹¶ç›¸é‚»çš„æ“ä½œï¼Œä»è€Œå‡å°‘åˆ—è¡¨çš„è¿­ä»£æ¬¡æ•°</p>
<p>ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå¯¹äºè¿ç»­çš„ <code>map(..)</code> é“¾å¼ï¼Œå¯ä»¥å¾ˆå®¹æ˜“æƒ³åˆ°ï¼ŒæŠŠå‡ ä¸ªå†…å±‚å‡½æ•° <code>compose(..)</code> or <code>pipe(..)</code> èµ·æ¥ï¼Œä»è€Œåªéœ€éå†ä¸€æ¬¡åˆ—è¡¨</p>
<h2 id="é€’å½’"><a href="#é€’å½’" class="headerlink" title="é€’å½’"></a>é€’å½’</h2><blockquote>
<p>é€’å½’æ·±è°™å‡½æ•°å¼ç¼–ç¨‹ä¹‹ç²¾é«“ï¼Œæœ€è¢«å¹¿æ³›å¼•è¯çš„åŸå› æ˜¯ï¼Œåœ¨è°ƒç”¨æ ˆä¸­ï¼Œé€’å½’æŠŠï¼ˆå¤§éƒ¨åˆ†ï¼‰æ˜¾å¼çŠ¶æ€è·Ÿè¸ªæ¢ä¸ºäº†éšå¼çŠ¶æ€ã€‚é€šå¸¸ï¼Œä½†é—®é¢˜éœ€è¦æ¡ä»¶åˆ†æ”¯å’Œå›æº¯è®¡ç®—æ—¶ï¼Œé€’å½’éå¸¸æœ‰ç”¨ï¼Œæ­¤å¤–åœ¨çº¯è¿­ä»£ç¯å¢ƒä¸­ç®¡ç†è¿™ç§çŠ¶æ€ï¼Œæ˜¯ç›¸å½“æ£˜æ‰‹çš„ï¼›æœ€èµ·ç ï¼Œè¿™äº›ä»£ç æ˜¯ä¸å¯æˆ–ç¼ºä¸”æ™¦æ¶©éš¾æ‡‚ã€‚ä½†æ˜¯åœ¨å †æ ˆä¸Šè°ƒç”¨æ¯ä¸€çº§çš„åˆ†æ”¯ä½œä¸ºå…¶è‡ªå·±çš„ä½œç”¨åŸŸï¼Œå¾ˆæ˜æ˜¾ï¼Œè¿™é€šå¸¸ä¼šå½±å“åˆ°ä»£ç çš„å¯è¯»æ€§ã€‚</p>
<p>æ­£å¦‚ Î£ æ˜¯ä¸ºè¿ç®—è€Œå£°æ˜ï¼ˆç¬¦å·æ˜¯æ•°å­¦çš„å£°æ˜å¼è¯­è¨€ï¼ï¼‰ï¼Œé€’å½’æ˜¯ä¸ºç®—æ³•è€Œå£°æ˜</p>
</blockquote>
<h3 id="å°¾è°ƒç”¨"><a href="#å°¾è°ƒç”¨" class="headerlink" title="å°¾è°ƒç”¨"></a>å°¾è°ƒç”¨</h3><p>å¦‚æœä¸€ä¸ªå›è°ƒä»å‡½æ•° <code>baz()</code> è½¬åˆ°å‡½æ•° <code>bar()</code> çš„æ—¶å€™ï¼Œè€Œå›è°ƒæ˜¯åœ¨å‡½æ•° <code>baz()</code> çš„æœ€åº•éƒ¨æ‰§è¡Œâ€”â€”ä¹Ÿå°±æ˜¯å°¾è°ƒç”¨â€”â€”é‚£ä¹ˆ <code>baz()</code> çš„å †æ ˆå¸§å°±ä¸å†éœ€è¦äº†ã€‚ä¹Ÿå°±æ„å‘³ç€ï¼Œå†…å­˜å¯ä»¥è¢«å›æ”¶ï¼Œæˆ–åªéœ€ç®€å•çš„æ‰§è¡Œ <code>bar()</code> å‡½æ•°</p>
<p>æ­£ç¡®çš„å°¾è°ƒç”¨ï¼ˆPTCï¼‰ï¼šç”± ES6 æ˜ç¡®è§„å®šçš„å°¾è°ƒç”¨ç‰¹å®šå½¢å¼ï¼Œåªè¦æ­£ç¡®çš„ä½¿ç”¨äº†å°¾è°ƒç”¨å°±ä¸ä¼šå‘ç”Ÿæ ˆæº¢å‡ºã€‚PTC é•¿ä¸‹é¢è¿™æ ·ï¼šå‡½æ•°è°ƒç”¨åœ¨æœ€åä¸€æ­¥ï¼Œå¹¶ä¸”å¿…é¡»æœ‰è¿”å›</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// PTC</span></span><br><span class="line"><span class="keyword">return</span> <span class="title function_">foo</span>(..);</span><br><span class="line"></span><br><span class="line"><span class="comment">// this is also right</span></span><br><span class="line"><span class="keyword">return</span> x ? <span class="title function_">foo</span>(..) : <span class="title function_">bar</span>(..);</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä½ çš„é€’å½’æ¯”è¾ƒå¤æ‚ï¼Œä¸æ˜¯å°¾é€’å½’ï¼ˆæ¯”å¦‚äºŒåˆ†æ³•ï¼‰ï¼Œå°±éœ€è¦æƒ³åŠæ³•é‡æ„é€’å½’ï¼š</p>
<p><strong>æ›´æ¢å †æ ˆ</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸€ä¸ªä¸ç¬¦åˆ PTC è§„èŒƒçš„ä¾‹å­</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params">num1, ...nums</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (nums.<span class="property">length</span> == <span class="number">0</span>) <span class="keyword">return</span> num1</span><br><span class="line">  <span class="keyword">return</span> num1 + <span class="title function_">sum</span>(...nums)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>é‡æ„ç­–ç•¥çš„å…³é”®ç‚¹åœ¨äºï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŠŠ<em>ç½®å</em>å¤„ç†ç´¯åŠ æ”¹ä¸º<em>æå‰</em>å¤„ç†ï¼Œæ¥æ¶ˆé™¤å¯¹å †æ ˆçš„ä¾èµ–ï¼Œç„¶åå°†è¯¥éƒ¨åˆ†ç»“æœä½œä¸ºå‚æ•°ä¼ é€’åˆ°é€’å½’è°ƒç”¨ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬ä¸ç”¨åœ¨å½“å‰è¿ç”¨å‡½æ•°çš„å †æ ˆå¸§ä¸­ä¿ç•™ <code>num1+sum(..num1)</code> çš„æ€»å’Œï¼Œè€Œæ˜¯æŠŠå®ƒä¼ é€’åˆ°ä¸‹ä¸€ä¸ªé€’å½’çš„å †æ ˆå¸§ä¸­ï¼Œè¿™æ ·å°±èƒ½é‡Šæ”¾å½“å‰é€’å½’çš„å †æ ˆå¸§ã€‚</p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ sum è®¡ç®—çš„ç»“æœä½œä¸ºå‚æ•°ä¼ è¿› sumï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params">result, num1, ...nums</span>) &#123;</span><br><span class="line">  result = result + num1</span><br><span class="line">  <span class="keyword">if</span> (nums.<span class="property">length</span> == <span class="number">0</span>) <span class="keyword">return</span> result</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">sum</span>(result, ...nums)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯è°ƒç”¨è€…éœ€è¦åœ¨è°ƒç”¨æ—¶é¢å¤–ä¼ ä¸€ä¸ª <code>result = 0</code> è¿›å»ï¼é€šå¸¸çš„å¤„ç†æ˜¯å†ç”¨ä¸€ä¸ªå‡½æ•°åŒ…è£¹å®ƒï¼Œå¯¹å¤–æš´éœ²ä¸€ä¸ªæ¥å£å‡½æ•°ï¼ˆå„ç§æ–¹æ³•å®ç°ï¼Œå¹³çº§å‡½æ•°&#x2F;å†…éƒ¨å‡½æ•°&#x2F;IIFE åŒ…è£¹ç­‰ç­‰ï¼‰ã€‚ä½†æ˜¯è¿™æ ·å¯è¯»æ€§å·²ç»æ˜æ˜¾é™ä½â€¦</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params">num1, num2, ...nums</span>) &#123;</span><br><span class="line">  num1 = num1 + num2 <span class="comment">// å•Šå“ˆï¼Œç›´æ¥æŠŠ num1 å½“æˆåˆå§‹çš„ result</span></span><br><span class="line">  <span class="keyword">if</span> (nums.<span class="property">length</span> == <span class="number">0</span>) <span class="keyword">return</span> num1</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">sum</span>(num1, ...nums)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦ä¸€ä¸ªä¾‹å­</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">maxEven</span>(<span class="params">num1, ...restNums</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> maxRest = restNums.<span class="property">length</span> &gt; <span class="number">0</span> ? <span class="title function_">maxEven</span>(...restNums) : <span class="literal">undefined</span></span><br><span class="line">  <span class="keyword">return</span> (num1 % <span class="number">2</span> != <span class="number">0</span> || num1 &lt; maxRest) ? maxRest : num1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">maxEven</span>(<span class="params">num1, num2, ...nums</span>) &#123;</span><br><span class="line">  num1 = (num1 % <span class="number">2</span> == <span class="number">0</span> &amp;&amp; !(<span class="title function_">maxEven</span>(num2) &gt; num1)) ? num1 : (num2 % <span class="number">2</span> == <span class="number">0</span> ? num2 : <span class="literal">undefined</span>)</span><br><span class="line">  <span class="keyword">return</span> nums.<span class="property">length</span> == <span class="number">0</span> ? num1 : <span class="title function_">maxEven</span>(num1, ...nums)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç¬¬ä¸€æ¬¡è°ƒ maxEven(num2) ä¸æ˜¯ä¸ºäº† PTC ä¼˜åŒ–ï¼Œè€Œåªæ˜¯æƒ³é¿å…é‡å¤å†™ % é€»è¾‘ï¼ˆè¿™é‡Œåªé€’å½’ä¸€çº§å°±è¿”å›äº†ï¼‰</span></span><br></pre></td></tr></table></figure>

<p><strong>åç»§ä¼ é€’æ ¼å¼</strong></p>
<blockquote>
<p>åç»§ä¼ é€’æ ¼å¼ï¼ˆCPSï¼‰ï¼šç»„ç»‡ä»£ç ï¼Œä½¿å¾—æ¯ä¸ªå‡½æ•°åœ¨å…¶ç»“æŸæ—¶æ¥å—å¦ä¸€ä¸ªæ‰§è¡Œå‡½æ•°</p>
</blockquote>
<p>æ¯”å¦‚è¿›è¡Œç›¸äº’é€’å½’çš„è¿™ä¸ªä¾‹å­</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fib_</span>(<span class="params">n</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (n == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="title function_">fib</span>(n - <span class="number">2</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fib</span>(<span class="params">n</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="title function_">fib</span>(n - <span class="number">1</span>) + <span class="title function_">fib_</span>(n)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// CPS</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fib</span>(<span class="params">n, cont = identity</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (n &lt;= <span class="number">1</span>) <span class="keyword">return</span> <span class="title function_">cont</span>(n)</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">fib</span>(</span><br><span class="line">    n - <span class="number">2</span>,</span><br><span class="line">    <span class="function"><span class="params">n2</span> =&gt;</span> <span class="title function_">fib</span>( <span class="comment">// è¿™ä¸ªå‡½æ•°æ¥å— fib(n-2) çš„ç»“æœä½œä¸º n2</span></span><br><span class="line">      n - <span class="number">1</span>,</span><br><span class="line">      <span class="function"><span class="params">n1</span> =&gt;</span> <span class="title function_">cont</span>(n2 + n1) <span class="comment">// è¿™ä¸ªå‡½æ•°æ¥å— fib(n-1) çš„ç»“æœä½œä¸º n1ï¼Œå¾—åˆ° n1 n2 åç›¸åŠ ä¼ å…¥ä¸‹ä¸ªåç»­å‡½æ•°</span></span><br><span class="line">    )</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å¼¹ç°§åºŠ</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">trampoline</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">trampolined</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> result = <span class="title function_">fn</span>(...args)</span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">typeof</span> result == <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">      result = <span class="title function_">result</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sum = <span class="title function_">trampoline</span>(</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params">num1, num2, ...nums</span>) &#123;</span><br><span class="line">    num1 = num1 + num2</span><br><span class="line">    <span class="keyword">if</span> (nums.<span class="property">length</span> == <span class="number">0</span>) <span class="keyword">return</span> num1</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="title function_">sum</span>(num1, ...nums)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h2 id="å¼‚æ­¥çš„å‡½æ•°å¼"><a href="#å¼‚æ­¥çš„å‡½æ•°å¼" class="headerlink" title="å¼‚æ­¥çš„å‡½æ•°å¼"></a>å¼‚æ­¥çš„å‡½æ•°å¼</h2><blockquote>
<p>å¼‚æ­¥ç¼–ç¨‹æœ€ä¸ºé‡è¦çš„ä¸€ç‚¹æ˜¯é€šè¿‡æŠ½è±¡æ—¶é—´æ¥ç®€åŒ–çŠ¶æ€å˜åŒ–çš„ç®¡ç†ã€‚</p>
</blockquote>
<p>promise ä»¥æ—¶é—´æ— å…³çš„æ–¹å¼æ¥ä½œä¸ºä¸€ä¸ªå•ä¸€çš„å€¼ã€‚æ­¤å¤–ï¼Œè·å– promise çš„è¿”å›å€¼æ˜¯å¼‚æ­¥çš„ï¼Œä½†å´æ˜¯é€šè¿‡åŒæ­¥çš„æ–¹æ³•æ¥èµ‹å€¼ã€‚æˆ–è€…è¯´ï¼Œpromise ç»™ <code>=</code> æ“ä½œç¬¦æ‰©å±•éšæ—¶é—´åŠ¨æ€èµ‹å€¼çš„åŠŸèƒ½ï¼Œé€šè¿‡å¯é çš„ï¼ˆæ—¶é—´æ— å…³ï¼‰æ–¹å¼ã€‚</p>
<p>æƒ°æ€§æ•°æ®ç»“æ„ æ‡’æ“ä½œ</p>
<p>observables(RxJS Most)</p>
<ul>
<li>æ•°ç»„çš„ <code>map(..)</code> æ–¹æ³•ä¼šç”¨å½“å‰æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå€¼è¿è¡Œä¸€æ¬¡æ˜ å°„å‡½æ•°ï¼Œç„¶åæ”¾åˆ°è¿”å›çš„æ•°ç»„é‡Œï¼ˆç§¯æçš„æ•°æ®ç»“æ„ï¼‰</li>
<li>observable æ•°ç»„é‡Œåˆ™æ˜¯ä¸ºæ¯ä¸€ä¸ªå€¼è¿è¡Œä¸€æ¬¡æ˜ å°„å‡½æ•°ï¼Œæ— è®ºè¿™ä¸ªå€¼ä½•æ—¶åŠ å…¥ï¼Œç„¶åæŠŠå®ƒè¿”å›åˆ° observable é‡Œï¼ˆæŒç»­æƒ°æ€§çš„ï¼‰</li>
</ul>
<h2 id="Transducing"><a href="#Transducing" class="headerlink" title="Transducing"></a>Transducing</h2><p>transduer å°±æ˜¯å¯ç»„åˆçš„ reducerï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ compose ä¸€ç³»åˆ— reduce æ“ä½œï¼Œé¿å…åå¤éå†åˆ—è¡¨ï¼ˆè€Œ map filter ç­‰å¯ä»¥è½¬æˆ reduceï¼‰</p>
<p>æ¨å¯¼è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¾‹å­</span></span><br><span class="line"><span class="comment">// è¿™æ ·åå¤éå†æ€§èƒ½å¾ˆå·®ï¼Œè€Œä¸”å¯è¯»æ€§ä¹Ÿå¾ˆå·®</span></span><br><span class="line">words</span><br><span class="line">.<span class="title function_">map</span>(strUppercase)</span><br><span class="line">.<span class="title function_">filter</span>(isLongEnough)</span><br><span class="line">.<span class="title function_">filter</span>(isShortEnough)</span><br><span class="line">.<span class="title function_">reduce</span>(strConcat, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠŠ map/filter è¡¨ç¤ºä¸º reduce</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">mapReducer</span>(<span class="params">mapperFn</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">list, val</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> list.<span class="title function_">concat</span>([<span class="title function_">mapperFn</span>(val)])</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">filterReducer</span>(<span class="params">predicateFn</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">list, val</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">predicateFn</span>(val)) <span class="keyword">return</span> list.<span class="title function_">concat</span>([val])</span><br><span class="line">    <span class="keyword">return</span> list</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ‰ä¸ªå…±äº«åŠŸèƒ½ï¼</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">listCombination</span>(<span class="params">list, val</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> list.<span class="title function_">concat</span>([val])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠŠ listCombination è¿™ä¸ªå°å·¥å…·å‚æ•°åŒ–è¿›æˆ‘ä»¬çš„ reducers</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">mapReducer</span>(<span class="params">mapperFn, combinationFn</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">list, val</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">combinationFn</span>(list, <span class="title function_">mapperFn</span>(val))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">filterReducer</span>(<span class="params">predicateFn, combinationFn</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">list, val</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">predicateFn</span>(val)) <span class="keyword">return</span> <span class="title function_">combinationFn</span>(list, val)</span><br><span class="line">    <span class="keyword">return</span> list</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// curry ä¸€ä¸‹</span></span><br><span class="line"><span class="keyword">var</span> curriedMapReducer = <span class="title function_">curry</span>(<span class="keyword">function</span> <span class="title function_">mapReducer</span>(<span class="params">mapperFn, combinationFn</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">list, val</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">combinationFn</span>(list, <span class="title function_">mapperFn</span>(val))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">var</span> curriedFilterReducer = <span class="title function_">curry</span>(<span class="keyword">function</span> <span class="title function_">filterReducer</span>(<span class="params">predicateFn, combinationFn</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">list, val</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">predicateFn</span>(val)) <span class="keyword">return</span> <span class="title function_">combinationFn</span>(list, val)</span><br><span class="line">    <span class="keyword">return</span> list</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¥ä¸‹æ¥æ˜¯å°±æ˜¯å¥‡è¿¹å‘ç”Ÿ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è®©æˆ‘ä»¬çœ‹çœ‹æŸ¯é‡ŒåŒ–æ²¡ä¼ å…¨å‚æ•°çš„æ ·å­</span></span><br><span class="line"><span class="comment">// å—¯ï¼Œå®ƒä»¬æ¯ä¸ªéƒ½æœŸæœ›å¾—åˆ°ä¸€ä¸ª listCombination å¹¶äº§ç”Ÿä¸€ä¸ªç‹¬ç«‹çš„ reducer</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="title function_">curriedMapReducer</span>(strUppercase)</span><br><span class="line"><span class="keyword">var</span> y = <span class="title function_">curriedFilterReducer</span>(isLongEnough)</span><br><span class="line"><span class="keyword">var</span> z = <span class="title function_">curriedFilterReducer</span>(isShortEnough)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½†æ˜¯ï¼Œå¦‚æœè°ƒç”¨ y(z)ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</span></span><br><span class="line"><span class="comment">// æˆ‘ä»¬å¾—åˆ°çš„ reducer å‡½æ•°å†…éƒ¨çœ‹èµ·æ¥ä¼šåƒè¿™æ ·</span></span><br><span class="line"><span class="comment">// å½“ç„¶ï¼Œè¿™æ ·æ˜¯é”™çš„ï¼Œå› ä¸ºæˆ‘ä»¬çš„ z åªæƒ³æ¥æ”¶ä¸€ä¸ªå‚æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">list, val</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isLongEnough</span>(val)) <span class="keyword">return</span> <span class="title function_">z</span>(list, val) <span class="comment">// here</span></span><br><span class="line">  <span class="keyword">return</span> list</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½†æ˜¯ y(z(listCombination)) è¿™æ ·å‘¢</span></span><br><span class="line"><span class="keyword">var</span> shortEnoughReducer = <span class="title function_">z</span>(listCombination) <span class="comment">// æ­£å¸¸æ»´</span></span><br><span class="line"><span class="keyword">var</span> longAndShortEnoughReducer = <span class="title function_">y</span>(shortEnoughReducer) <span class="comment">// ä¸ºä»€ä¹ˆå«è¿™ä¸ªåå­—ï¼Ÿ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// çœ‹çœ‹å®ƒä»¬çš„å†…éƒ¨</span></span><br><span class="line"><span class="comment">// shortEnoughReducer</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">list, val</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isShortEnough</span>(val)) <span class="keyword">return</span> <span class="title function_">listCombination</span>(list, val)</span><br><span class="line">  <span class="keyword">return</span> list</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// longAndShortEnoughReducer</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">list, val</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isLongEnough</span>(val)) <span class="keyword">return</span> <span class="title function_">shortEnoughReducer</span>(list, val) <span class="comment">// here!!!</span></span><br><span class="line">  <span class="keyword">return</span> list</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// äº‹å®æ˜¯ï¼Œä¸Šé¢è¿™æ ·å†™å°±èƒ½è¿è¡Œï¼è€Œä¸”æ˜¯æ­£ç¡®çš„ï¼</span></span><br><span class="line"><span class="comment">// å› ä¸º reducer(..) çš„å½¢çŠ¶å’Œ listCombination(..) æ˜¯ä¸€æ ·çš„</span></span><br><span class="line"><span class="comment">// å¯ä»¥ç†è§£ä¸ºï¼Œéƒ½æ˜¯â€œæ¥æ”¶ä¸€ä¸ªåˆ—è¡¨å’Œä¸€ä¸ªå€¼ï¼Œè¿”å›ä¸€ä¸ªæ–°åˆ—è¡¨â€</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é‚£å°±å¯ä»¥è¿™æ ·æŠŠæ‰€æœ‰çš„ reducers compose èµ·æ¥äº†ï¼</span></span><br><span class="line"><span class="comment">// éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œæœ€ç»ˆçš„æ‰§è¡Œé¡ºåºå°±æ˜¯ strUppercase isLongEnough isShortEnough</span></span><br><span class="line"><span class="comment">// å› ä¸ºæ¯ä¸ª reducer é‡Œé¢åè½¬äº†é¡ºåº</span></span><br><span class="line"><span class="keyword">var</span> composition = <span class="title function_">compose</span>(</span><br><span class="line">  <span class="title function_">curriedMapReducer</span>(strUppercase),</span><br><span class="line">  <span class="title function_">curriedFilterReducer</span>(isLongEnough),</span><br><span class="line">  <span class="title function_">curriedFilterReducer</span>(isShortEnough)</span><br><span class="line">)</span><br><span class="line">words.<span class="title function_">reduce</span>(<span class="title function_">composition</span>(listCombination), [])</span><br></pre></td></tr></table></figure>

<p>æœ€åçš„ä¸€äº›è®¨è®ºï¼š</p>
<ul>
<li>æˆ‘ä»¬çš„ <code>listCombination(..)</code> å†…éƒ¨ç”¨äº†çº¯çš„ <code>concat(..)</code>ï¼Œä½†æ˜¯è¿™æ ·æ€§èƒ½è‚¯å®šä¸å¥½ã€‚æ˜¯ä¸æ˜¯å¯ä»¥ç›´æ¥æ¢æˆæ€§èƒ½æ›´å¥½ä½†ä¸çº¯çš„ <code>push(..)</code> å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥ã€‚å› ä¸ºæˆ‘ä»¬çŸ¥é“ <code>listCombination(..)</code> åªä¼šåœ¨ transducing å†…éƒ¨ä½¿ç”¨ï¼Œæ²¡æœ‰è¿åå¯¹å¤–æ˜¯çº¯å‡½æ•°è¿™ä¸€å‡†åˆ™ï¼Œå†…éƒ¨å¯ä»¥ä¸ºäº†æ€§èƒ½è€Œå˜å¾—ä¸çº¯</li>
<li>å¦‚æœä¸¤ä¸ªâ€œå½¢çŠ¶â€ä¸ä¸€æ ·çš„ç»„åˆå‡½æ•°å‘¢ï¼Ÿ</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æˆ‘ä»¬å¯ä»¥â€œç»„åˆâ€è¿™ä¸¤ä¸ª reduce å—ï¼Ÿ</span></span><br><span class="line">words</span><br><span class="line">.<span class="title function_">reduce</span>(<span class="title function_">transducer</span>(listCombination), [])</span><br><span class="line">.<span class="title function_">reduce</span>(strConcat, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›´æ¥æŠŠ strConcat æ”¾è¿›æˆ‘ä»¬çš„ compose ä¸­æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºå®ƒçš„â€œå½¢çŠ¶â€ä¸é€‚ç”¨äºé‚£ä¸ª compose</span></span><br><span class="line"><span class="comment">// ä½†è®©æˆ‘ä»¬çœ‹çœ‹è¿™ä¸¤ä¸ªâ€œå½¢çŠ¶â€</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">strConcat</span>(<span class="params">str1, str2</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> str1 + str2</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">listCombination</span>(<span class="params">list, val</span>) &#123;</span><br><span class="line">  list.<span class="title function_">push</span>(val)</span><br><span class="line">  <span class="keyword">return</span> list</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å—¯ï¼Ÿåœ¨æ¦‚å¿µä¸Šè¿™ä¸¤ä¸ªåŠŸèƒ½æ˜¯ä¸€æ ·çš„ï¼šå°†ä¸¤ä¸ªå€¼ç»„åˆæˆä¸€ä¸ª</span></span><br><span class="line"><span class="comment">// strConcat ä¹Ÿæ˜¯ä¸€ä¸ªç»„åˆå‡½æ•°ï¼</span></span><br><span class="line"><span class="comment">// æˆ‘ä»¬æœ€ç»ˆçš„ç›®æ ‡æ˜¯è·å¾—å­—ç¬¦ä¸²ï¼é‚£å°±å¯ä»¥ç›´æ¥ç”¨ strConcat ä»£æ›¿ listCombination</span></span><br><span class="line">words.<span class="title function_">reduce</span>(<span class="title function_">transducer</span>(strConcat), <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// BOOM! This is transducing!</span></span><br></pre></td></tr></table></figure>

<h2 id="Monad"><a href="#Monad" class="headerlink" title="Monad"></a>Monad</h2><blockquote>
<p>å‡½å­ï¼ˆfunctorï¼‰ï¼šåŒ…æ‹¬ä¸€ä¸ªå€¼å’Œä¸€ä¸ªç”¨æ¥å¯¹æ„æˆå‡½å­å¯¹æ•°æ®æ‰§è¡Œæ“ä½œçš„ç±» map å®ç”¨å‡½æ•°ã€‚</p>
<p>Monadï¼šä¸€ä¸ªåŒ…å«ä¸€äº›é¢å¤–è¡Œä¸ºçš„å‡½å­ã€‚å®ƒæ›´åƒæ˜¯ä¸€ç§æ ¹æ®ä¸åŒå€¼çš„éœ€è¦è€Œç”¨ä¸åŒæ–¹å¼å®ç°çš„æ¥å£ï¼Œæ¯ä¸€ç§å®ç°éƒ½æ˜¯ä¸€ç§ä¸åŒç±»å‹çš„ Monadã€‚Monad æ˜¯ä¸€ä¸ªç”¨æ›´å…·æœ‰å£°æ˜å¼çš„æ–¹å¼å›´ç»•ä¸€ä¸ªå€¼æ¥ç»„ç»‡è¡Œä¸ºçš„æ–¹æ³•ã€‚</p>
</blockquote>
<h3 id="Maybe"><a href="#Maybe" class="headerlink" title="Maybe"></a>Maybe</h3><p>å¦‚æœä¸€ä¸ªå€¼æ˜¯éç©ºçš„ï¼Œå®ƒæ˜¯ <code>Just(..)</code> çš„å®ä¾‹ï¼›å¦‚æœè¯¥å€¼æ˜¯ç©ºçš„ï¼Œå®ƒåˆ™æ˜¯ <code>Nothing()</code> çš„å®ä¾‹</p>
<p>Maybe Monad çš„ä»·å€¼åœ¨äºä¸è®ºæˆ‘ä»¬æœ‰ <code>Just(..)</code> å®ä¾‹è¿˜æ˜¯ <code>Nothing(..)</code> å®ä¾‹ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ–¹æ³•éƒ½æ˜¯ä¸€æ ·çš„ã€‚Maybe è¿™ä¸ªæŠ½è±¡æ¦‚å¿µçš„ä½œç”¨æ˜¯éšå¼åœ°å°è£…äº†æ“ä½œå’Œæ— æ“ä½œçš„äºŒå…ƒæ€§</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Maybe</span> = &#123;</span><br><span class="line">  <span class="title class_">Just</span>,</span><br><span class="line">  <span class="title class_">Nothing</span>,</span><br><span class="line">  <span class="attr">of</span>: <span class="title class_">Just</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Just</span>(<span class="params">val</span>) &#123;</span><br><span class="line">  <span class="comment">// æ— è®º Just å®ä¾‹æ‹¿åˆ°çš„æ˜¯æ€æ ·çš„ä¸€ä¸ª valï¼ŒJust éƒ½ä¸ä¼šæ”¹å˜å®ƒï¼Œæ‰€æœ‰çš„æ–¹æ³•éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ Monad å®ä¾‹è€Œä¸æ˜¯æ”¹å˜å®ƒ</span></span><br><span class="line">  <span class="keyword">return</span> &#123; map, chain, ap, inspect &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">map</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Just</span>(<span class="title function_">fn</span>(val))</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">chain</span>(<span class="params">fn</span>) &#123; <span class="comment">// ä¹Ÿå« bind/flatMap</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fn</span>(val)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">ap</span>(<span class="params">anotherMonad</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> anotherMonad.<span class="title function_">map</span>(val)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">inspect</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`Just(<span class="subst">$&#123;val&#125;</span>)`</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Nothing</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">map</span>: <span class="title class_">Nothing</span>,</span><br><span class="line">    <span class="attr">chain</span>: <span class="title class_">Nothing</span>,</span><br><span class="line">    <span class="attr">ap</span>: <span class="title class_">Nothing</span>,</span><br><span class="line">    inspect</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">inspect</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Nothing&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Monad çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œå®ƒå¿…é¡»å¯¹æ‰€æœ‰å€¼éƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œä¸èƒ½å¯¹å€¼åšä»»ä½•æ£€æŸ¥â€”â€”ç”šè‡³æ˜¯ç©ºå€¼æ£€æŸ¥</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨å¤–éƒ¨è¿›è¡Œç©ºå€¼æ£€æŸ¥çš„ä¾‹å­</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isEmpty</span>(<span class="params">val</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> val === <span class="literal">null</span> || val === <span class="literal">undefined</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> safeProp = <span class="title function_">curry</span>(<span class="keyword">function</span> <span class="title function_">safeProp</span>(<span class="params">prop, obj</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isEmpty</span>(obj[prop])) <span class="keyword">return</span> <span class="title class_">Maybe</span>.<span class="title class_">Nothing</span>()</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Maybe</span>.<span class="title function_">of</span>(obj[prop])</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title class_">Maybe</span>.<span class="title function_">of</span>(someObj)</span><br><span class="line">.<span class="title function_">chain</span>(<span class="title function_">safeProp</span>(<span class="string">&#x27;something&#x27;</span>))</span><br><span class="line">.<span class="title function_">chain</span>(<span class="title function_">safeProp</span>(<span class="string">&#x27;else&#x27;</span>))</span><br><span class="line">.<span class="title function_">chain</span>(<span class="title function_">safeProp</span>(<span class="string">&#x27;entirely&#x27;</span>))</span><br><span class="line">.<span class="title function_">map</span>(<span class="variable language_">console</span>.<span class="property">log</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Humble"><a href="#Humble" class="headerlink" title="Humble"></a>Humble</h3><p>æ˜¯ä¸€ä¸ªäº§ç”Ÿ Maybe Monad å®ä¾‹çš„å·¥å‚å‡½æ•°ï¼Œå¯ä»¥åŠ å…¥å„ç§æ¡ä»¶åˆ¤æ–­â€¦</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="ce">
    <link itemprop="mainEntityOfPage" href="https://hayahayao.github.io/2020/06/04/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E6%8C%87%E5%8C%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="hayahayao">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ã•ãŠã‚Šã®Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/04/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E6%8C%87%E5%8C%97/" class="post-title-link" itemprop="url">è¯»ä¹¦ç¬”è®°-å‡½æ•°å¼ç¼–ç¨‹æŒ‡åŒ—</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-06-04 13:26:00" itemprop="dateCreated datePublished" datetime="2020-06-04T13:26:00+08:00">2020-06-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-08-23 01:35:23" itemprop="dateModified" datetime="2023-08-23T01:35:23+08:00">2023-08-23</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="å‡½æ•°å¼ç¼–ç¨‹"><a href="#å‡½æ•°å¼ç¼–ç¨‹" class="headerlink" title="å‡½æ•°å¼ç¼–ç¨‹"></a>å‡½æ•°å¼ç¼–ç¨‹</h1><blockquote>
<p>ã€Šå‡½æ•°å¼ç¼–ç¨‹æŒ‡åŒ—ã€‹è¯»ä¹¦ç¬”è®°</p>
<p><a target="_blank" rel="noopener" href="https://llh911001.gitbooks.io/mostly-adequate-guide-chinese/content/">ä¸­æ–‡ç‰ˆ</a></p>
</blockquote>
<h2 id="å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘"><a href="#å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘" class="headerlink" title="å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘"></a>å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘</h2><p>å’Œå…¶ä»–å¯¹è±¡ä¸€æ ·ï¼Œå¯ä»¥åƒå¯¹å¾…ä»»ä½•å…¶ä»–æ•°æ®ç±»å‹ä¸€æ ·å¯¹å¾…å®ƒä»¬â€”â€”æŠŠå®ƒä»¬å­˜åœ¨æ•°ç»„é‡Œï¼Œå½“ä½œå‚æ•°ä¼ é€’ï¼Œèµ‹å€¼ç»™å˜é‡â€¦ç­‰ç­‰</p>
<p>éå¸¸å°å¿ƒ <code>this</code> å€¼ï¼Œç‰¹åˆ«æ˜¯ä»¥ä¸€ç­‰å…¬æ°‘çš„æ–¹å¼è°ƒç”¨ thisâ€¦</p>
<h2 id="çº¯å‡½æ•°"><a href="#çº¯å‡½æ•°" class="headerlink" title="çº¯å‡½æ•°"></a>çº¯å‡½æ•°</h2><p>ç›¸åŒçš„è¾“å…¥ï¼Œæ°¸è¿œä¼šå¾—åˆ°ç›¸åŒçš„è¾“å‡ºï¼Œè€Œä¸”æ²¡æœ‰ä»»ä½•å¯è§‚å¯Ÿçš„å‰¯ä½œç”¨</p>
<p>çº¯å‡½æ•°ä¸ä¾èµ–å¤–éƒ¨ç¯å¢ƒï¼Œä»è€Œé™ä½äº†è®¤çŸ¥è´Ÿè·ï¼›å‡½æ•°èƒ½å¤Ÿåšåˆ°è‡ªç»™è‡ªè¶³ã€‚æ›´å¯ä»¥ç”¨ <code>Object.freeze</code> æŠŠå¯¹è±¡å˜æˆä¸å¯å˜çš„ï¼Œä»è€Œä¿ç•™çº¯ç²¹æ€§ï¼Œå› ä¸ºçŠ¶æ€ä¸ä¼šæœ‰å˜åŒ–</p>
<p>å‰¯ä½œç”¨æ˜¯è®¡ç®—ç»“æœçš„è¿‡ç¨‹ä¸­ï¼Œç³»ç»ŸçŠ¶æ€çš„ä¸€ç§å˜åŒ–ï¼Œæˆ–è€…ä¸å¤–éƒ¨ä¸–ç•Œè¿›è¡Œçš„å¯è§‚å¯Ÿçš„äº¤äº’</p>
<p>å‡½æ•°å¼ç¼–ç¨‹çš„å“²å­¦å°±æ˜¯å‡å®šå‰¯ä½œç”¨æ˜¯é€ æˆä¸æ­£å½“è¡Œä¸ºçš„ä¸»è¦åŸå› </p>
<p>çº¯å‡½æ•°çš„ä¼˜ç‚¹ï¼š</p>
<ul>
<li>å¯ç¼“å­˜æ€§ï¼ˆCacheableï¼‰ï¼šæ€»èƒ½å¤Ÿæ ¹æ®è¾“å…¥æ¥åšç¼“å­˜ï¼Œä¸€ç§å…¸å‹æ–¹å¼æ˜¯ memoize æŠ€æœ¯</li>
<li>å¯ç§»æ¤æ€§&#x2F;è‡ªæ–‡æ¡£åŒ–ï¼ˆPortable&#x2F;Self-Documentingï¼‰ï¼šä¾èµ–æ˜ç¡®ï¼ˆæ‰€æœ‰çš„ä¾èµ–éƒ½éœ€ç”¨å‡½æ•°çš„å‚æ•°ä¼ é€’ï¼‰ï¼Œçº¯å‡½æ•°å¯¹å…¶ä¾èµ–å¿…é¡»è¦è¯šå®ï¼Œå¹¶ä¸”å‚æ•°åŒ–èƒ½å¤Ÿä½¿åº”ç”¨æ›´åŠ çµæ´»ï¼Œä¸ç¯å¢ƒæ— å…³</li>
<li>å¯æµ‹è¯•æ€§ï¼ˆTestableï¼‰ï¼šåªéœ€è¦ç®€å•åœ°ç»™å‡½æ•°ä¸€ä¸ªè¾“å…¥ï¼Œç„¶åæ–­è¨€è¾“å‡ºå°±å¥½äº†</li>
<li>åˆç†æ€§ï¼ˆReasonableï¼‰ï¼šå¼•ç”¨é€æ˜æ€§ï¼ˆreferential transparencyï¼Œå³å¦‚æœä¸€æ®µä»£ç å¯ä»¥æ›¿æ¢æˆå®ƒæ‰§è¡Œæ‰€å¾—çš„ç»“æœï¼Œè€Œä¸”æ˜¯åœ¨ä¸æ”¹å˜æ•´ä¸ªç¨‹åºè¡Œä¸ºçš„å‰æä¸‹æ›¿æ¢çš„ï¼‰</li>
<li>å¹¶è¡Œä»£ç ï¼šå› ä¸ºçº¯å‡½æ•°æ ¹æœ¬ä¸éœ€è¦è®¿é—®å…±äº«çš„å†…å­˜ï¼Œä¹Ÿä¸ä¼šå› å‰¯ä½œç”¨è€Œè¿›å…¥ç«äº‰æ€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¹¶è¡Œè¿è¡Œä»»æ„çº¯å‡½æ•°</li>
</ul>
<p>å¯ä»¥é€šè¿‡å»¶è¿Ÿæ‰§è¡Œçš„æ–¹å¼æŠŠä¸çº¯çš„å‡½æ•°è½¬æ¢ä¸ºçº¯å‡½æ•°</p>
<h2 id="æŸ¯é‡ŒåŒ–"><a href="#æŸ¯é‡ŒåŒ–" class="headerlink" title="æŸ¯é‡ŒåŒ–"></a>æŸ¯é‡ŒåŒ–</h2><p>åªä¼ é€’ç»™å‡½æ•°ä¸€éƒ¨åˆ†å‚æ•°æ¥è°ƒç”¨å®ƒï¼Œè®©å®ƒè¿”å›ä¸€ä¸ªå‡½æ•°å»å¤„ç†å‰©ä¸‹çš„å‚æ•°</p>
<p>lodash çš„ curry æ–¹æ³•</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">_.<span class="title function_">curry</span>(func, [arity=func.<span class="property">length</span>])</span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å— func çš„å‚æ•°</span></span><br><span class="line"><span class="comment">// å¦‚æœå…¨éƒ¨å‚æ•°å·²ç»æä¾›ï¼Œåˆ™ç›´æ¥è¿”å› func æ‰§è¡Œçš„ç»“æœ</span></span><br><span class="line"><span class="comment">// å¦åˆ™è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—ä½™ä¸‹çš„å‚æ•°</span></span><br></pre></td></tr></table></figure>

<p>å¯¹äºä¼ è¿›å»çš„ <code>func</code> çš„å‚æ•°ï¼Œéœ€è¦æŠŠè¦æ“ä½œçš„æ•°æ®æ”¾åˆ°æœ€åä¸€ä¸ªå‚æ•°</p>
<p>è¡¨æ˜äº†ä¸€ç§â€œé¢„åŠ è½½â€å‡½æ•°çš„èƒ½åŠ›ï¼Œé€šè¿‡ä¼ é€’ä¸€åˆ°ä¸¤ä¸ªå‚æ•°è°ƒç”¨å‡½æ•°ï¼Œå°±èƒ½å¾—åˆ°ä¸€ä¸ªè®°ä½äº†è¿™äº›å‚æ•°çš„æ–°å‡½æ•°</p>
<p>åªä¼ ç»™å‡½æ•°ä¸€éƒ¨åˆ†å‚æ•°é€šå¸¸ä¹Ÿå«ä½œå±€éƒ¨è°ƒç”¨ï¼Œèƒ½å¤Ÿå¤§é‡å‡å°‘æ ·æ¿æ–‡ä»¶ä»£ç </p>
<p>curry å‡½æ•°æ˜¯çº¯å‡½æ•°</p>
<h2 id="ä»£ç ç»„åˆ"><a href="#ä»£ç ç»„åˆ" class="headerlink" title="ä»£ç ç»„åˆ"></a>ä»£ç ç»„åˆ</h2><p>composeï¼šå°†ä¸¤ä¸ªå‡½æ•°ç»“åˆèµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°å‡½æ•°</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> compose = <span class="keyword">function</span>(<span class="params">f, g</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">x</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">f</span>(<span class="title function_">g</span>(x));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>g</code> å…ˆäº <code>f</code> æ‰§è¡Œï¼Œä»å³å‘å·¦çš„æ•°æ®æµ</p>
<h3 id="ç»“åˆå¾‹"><a href="#ç»“åˆå¾‹" class="headerlink" title="ç»“åˆå¾‹"></a>ç»“åˆå¾‹</h3><p>å¦‚ä½•ä¸º <code>compose</code> çš„è°ƒç”¨åˆ†ç»„ä¸é‡è¦ï¼Œç»“æœæ˜¯ä¸€æ ·çš„</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> associative = <span class="title function_">compose</span>(f, <span class="title function_">compose</span>(g, h)) == <span class="title function_">compose</span>(<span class="title function_">compose</span>(f, g), h); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>å› æ­¤ï¼Œå¯ä»¥ç»™ <code>compose</code> ä¼ é€’å¾ˆå¤šå‚æ•°è€Œä¸å¿…è‡ªå·±æ‰‹åŠ¨åˆ†ç»„ï¼Œå®ƒè‡ªå·±ä¼šå†³å®šå¦‚ä½•åˆ†ç»„ï¼ˆè¿™ä¸ªæ—¶å€™ <code>compose</code> å°±ä¸æ˜¯ä¸Šé¢å†™çš„é‚£ä¸ªåªæ¥å—ä¸¤ä¸ªå‚æ•°çš„äº†ï¼Œè€Œè¦å†™ä¸ªå¤šä¸ªçš„ï¼‰</p>
<p>å› ä¸ºæœ‰äº†ç»“åˆå¾‹ï¼Œæ‰€ä»¥ä»»ä½•ä¸€ä¸ªå‡½æ•°åˆ†ç»„éƒ½å¯ä»¥è¢«æ‹†å¼€æ¥ï¼Œç„¶åå†ä»¥å®ƒä»¬è‡ªå·±çš„ç»„åˆæ–¹å¼æ‰“åŒ…åœ¨ä¸€èµ·</p>
<p>å¦‚ä½•ç»„åˆçš„æœ€ä½³å®è·µï¼šè®©ç»„åˆå¯é‡ç”¨</p>
<h3 id="pointfree"><a href="#pointfree" class="headerlink" title="pointfree"></a>pointfree</h3><p>å‡½æ•°æ— é¡»æåŠå°†è¦æ“ä½œçš„æ•°æ®æ˜¯ä»€ä¹ˆæ ·çš„</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é pointfreeï¼Œå› ä¸ºæåˆ°äº†æ•°æ®ï¼šword</span></span><br><span class="line"><span class="keyword">var</span> snakeCase = <span class="keyword">function</span> (<span class="params">word</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> word.<span class="title function_">toLowerCase</span>().<span class="title function_">replace</span>(<span class="regexp">/\s+/ig</span>, <span class="string">&#x27;_&#x27;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// pointfree</span></span><br><span class="line"><span class="keyword">var</span> snakeCase = <span class="title function_">compose</span>(<span class="title function_">replace</span>(<span class="regexp">/\s+/ig</span>, <span class="string">&#x27;_&#x27;</span>), toLowerCase);</span><br></pre></td></tr></table></figure>

<p>ä¸€ç­‰å…¬æ°‘çš„å‡½æ•°+æŸ¯é‡ŒåŒ–+ç»„åˆåä½œèµ·æ¥ï¼Œé€šè¿‡<strong>ç®¡é“</strong>æŠŠæ•°æ®åœ¨æ¥å—å•ä¸ªå‚æ•°çš„å‡½æ•°é—´ä¼ é€’</p>
<p>pointfree æ¨¡å¼èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å‡å°‘ä¸å¿…è¦çš„å‘½åï¼Œè®©ä»£ç ä¿æŒç®€æ´å’Œé€šç”¨ </p>
<p>åœ¨ç»„åˆæ—¶æ³¨æ„å¦‚æœæƒ³ç»„åˆç±»ä¼¼ <code>map</code> è¿™ç§æ¥å—ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œéœ€è¦å…ˆå¯¹ <code>map</code> å±€éƒ¨è°ƒç”¨ä½¿å¾—å…¶è¿”å›æ¥å—ä¸€ä¸ªå‚æ•°çš„å‡½æ•°</p>
<p>åœ¨ debug è¿‡ç¨‹ä¸­å¯ä»¥ç”¨ <code>trace</code> å‡½æ•°æ¥è¿½è¸ªä»£ç æ‰§è¡Œæƒ…å†µï¼Œåœ¨æƒ³è¦è§‚å¯Ÿçš„ç‰¹å®šç‚¹ï¼ˆç®¡é“çš„æŸä¸€ç¯ï¼‰è§‚å¯Ÿæ•°æ®</p>
<h3 id="èŒƒç•´å­¦"><a href="#èŒƒç•´å­¦" class="headerlink" title="èŒƒç•´å­¦"></a>èŒƒç•´å­¦</h3><p>æŠŠå¾ˆå¤šæ•°å­¦åˆ†æ”¯ï¼ˆé›†åˆè®ºã€ç±»å‹è®ºã€ç¾¤è®ºã€é€»è¾‘å­¦ç­‰â€¦ï¼‰ä¸­ç›¸åŒçš„æ¦‚å¿µåŠ ä»¥å½¢å¼åŒ–</p>
<blockquote>
<p>â€¦èŒƒç•´ï¼šæœ‰ä»¥ä¸‹è¿™äº›ç»„ä»¶ï¼ˆcomponentï¼‰çš„æœé›†ï¼ˆcollectionï¼‰å°±æ„æˆäº†ä¸€ä¸ªèŒƒç•´</p>
<ul>
<li>å¯¹è±¡çš„æœé›†</li>
<li>æ€å°„çš„æœé›†</li>
<li>æ€å°„çš„ç»„åˆ</li>
<li>indentity è¿™ä¸ªç‹¬ç‰¹çš„æ€å°„</li>
</ul>
</blockquote>
<p>å¯¹åº”åˆ°ç¼–ç¨‹ä¸Šï¼š</p>
<ul>
<li><p>å¯¹è±¡çš„æœé›†ï¼šæ•°æ®ç±»å‹ï¼Œä¾‹å¦‚ String Boolean Number Object ç­‰ã€‚é€šå¸¸æˆ‘ä»¬æŠŠæ•°æ®ç±»å‹è§†ä½œæ‰€æœ‰å¯èƒ½çš„å€¼å¾—ä¸€ä¸ªé›†åˆï¼Œè¿™æ ·å¯ä»¥ç”¨é›†åˆè®ºå¤„ç†ç±»å‹</p>
</li>
<li><p>æ€å°„çš„æœé›†ï¼šæ€å°„æ˜¯æ ‡å‡†çš„ã€æ™®é€šçš„çº¯å‡½æ•°</p>
</li>
<li><p>æ€å°„çš„ç»„åˆï¼šæœ¬ç« ä»‹ç»çš„ç»„åˆ <code>compose</code>ã€‚åœ¨èŒƒç•´å­¦ä¸­ä»»ä½•ç»„åˆéƒ½é€‚ç”¨ç»“åˆå¾‹</p>
</li>
<li><p>indentity è¿™ä¸ªç‹¬ç‰¹çš„æ€å°„</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> id = <span class="keyword">function</span>(<span class="params">x</span>) &#123; <span class="keyword">return</span> x; &#125;;</span><br></pre></td></tr></table></figure>

<p>æœ‰äº† <code>id</code> å‡½æ•°ï¼Œå°±å¯ä»¥æœ‰å•ä½å¾‹ï¼ˆå’Œå®æ•°çš„å•ä½å…ƒä¸€æ ·ï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">compose</span>(id, f) = <span class="title function_">compose</span>(f, id) == f;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="ç¤ºä¾‹åº”ç”¨"><a href="#ç¤ºä¾‹åº”ç”¨" class="headerlink" title="ç¤ºä¾‹åº”ç”¨"></a>ç¤ºä¾‹åº”ç”¨</h2><p>å£°æ˜å¼ä»£ç ï¼šæŒ‡æ˜â€œåšä»€ä¹ˆâ€œï¼Œè€Œä¸æ˜¯â€æ€ä¹ˆåšâ€œ</p>
<table>
<thead>
<tr>
<th>å‘½ä»¤å¼</th>
<th>å£°æ˜å¼</th>
</tr>
</thead>
<tbody><tr>
<td>for å¾ªç¯ï¼Œç¡¬ç¼–ç å¤„ç†è¿­ä»£ç´¯åŠ blablaâ€¦</td>
<td>map</td>
</tr>
<tr>
<td>ç¡¬ç¼–ç é¡ºåºè°ƒç”¨å‡½æ•°</td>
<td>compose ç»„åˆå‡½æ•°ï¼Œä¸æŒ‡å®šæ‰§è¡Œé¡ºåºï¼ˆå¤©ç„¶åœ°é€‚åˆå¹¶è¡Œè¿ç®—ï¼‰ï¼Œä¸ºæ½œåœ¨çš„ä»£ç æ›´æ–°æä¾›æ”¯æŒ</td>
</tr>
</tbody></table>
<p><strong>map çš„ç»„åˆå¾‹</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> law = <span class="title function_">compose</span>(<span class="title function_">map</span>(f), <span class="title function_">map</span>(g)) == <span class="title function_">map</span>(<span class="title function_">compose</span>(f, g));</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ç”¨æ¥é‡æ„ä»£ç ï¼ˆå°±åƒæ•°å­¦æ¨å¯¼å…¬å¼ä¸€æ ·ï¼‰</p>
<h2 id="ç±»å‹ç­¾å"><a href="#ç±»å‹ç­¾å" class="headerlink" title="ç±»å‹ç­¾å"></a>ç±»å‹ç­¾å</h2><p>Hindley-Milner ç³»ç»Ÿ</p>
<p>å‡½æ•°å†™æˆ <code>a -&gt; b</code> çš„æ ·å­ï¼Œè¡¨ç¤ºæ¥å—å€¼å’Œè¿”å›å€¼</p>
<p>è¿ç»­æŒ‡å‘</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// map :: (a -&gt; b) -&gt; [a] -&gt; [b]</span></span><br><span class="line"><span class="keyword">var</span> map = <span class="title function_">curry</span>(<span class="keyword">function</span>(<span class="params">f, xs</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> xs.<span class="title function_">map</span>(f);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>æœ€ç®€å•çš„ç†è§£ï¼šmap æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯ <code>f</code>ï¼Œç±»å‹ä¸º <code>a -&gt; b</code>ï¼›ç¬¬äºŒä¸ªæ˜¯ <code>xs</code>ï¼Œç±»å‹ä¸º <code>[a]</code>ï¼›è¿”å›ä¸€ä¸ªæ•°ç»„ <code>[b]</code></p>
<p>æ·±å…¥ç†è§£ï¼šä»å³å‘å·¦åŠ æ‹¬å· <code>(a -&gt; b) -&gt; ([a] -&gt; [b])</code>ï¼Œå¤–å±‚æ˜¯è¾“å…¥ä¸€ä¸ª <code>a -&gt; b</code> è¿”å› <code>[a] -&gt; [b]</code>ï¼Œè¾“å…¥ä¸€ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªå‡½æ•°ï¼›å†…å±‚æ˜¯ <code>[a] -&gt; [b]</code>ï¼Œè¾“å…¥æ•°ç»„è¿”å›æ•°ç»„</p>
<p>ä»…ä»…æ ¹æ®ç±»å‹ç­¾åï¼Œå°±å¯ä»¥ç†è§£å‡½æ•°åšäº†ä»€ä¹ˆäº‹æƒ…ï¼Œæ¯”å¦‚ map å…¶å®å°±æ˜¯åœ¨æ¯ä¸ª <code>a</code> ä¸Šè°ƒç”¨ä¸€æ¬¡ <code>f</code>(<code>a -&gt; b</code>)ï¼Œä»è€Œå¾—åˆ°ä¸€ä¸ª <code>[b]</code></p>
<p>å¦ä¸€ä¸ªä¾‹å­</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// reduce :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b</span></span><br><span class="line"><span class="keyword">var</span> reduce = <span class="title function_">curry</span>(<span class="keyword">function</span>(<span class="params">f, x, xs</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> xs.<span class="title function_">reduce</span>(f, x);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>ç†è§£ï¼š</p>
<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°<code>f</code>ï¼š<code>(b -&gt; a -&gt; b)</code>ï¼Œæ¥å—ä¸€ä¸ª <code>b</code> ä¸€ä¸ª <code>a</code>ï¼Œè¿”å› <code>b</code></li>
<li>é‚£ä¹ˆè¿™é‡Œçš„ a b æ¥æºäºå“ªé‡Œå‘¢ï¼Œå…¶å®å°±åœ¨ç¬¬äºŒä¸‰ä¸ªå‚æ•° <code>b</code> å’Œ <code>[a]</code>ï¼Œè¿™é‡Œçš„ b a ä¼šä¼ ç»™ f ä½œä¸ºå‚æ•°</li>
<li>reduce çš„æœ€ç»ˆè¿”å›ç»“æœæ˜¯ä¸€ä¸ª <code>b</code>ï¼Œå…¶å®å°±æ˜¯ <code>f :: b -&gt; a -&gt; b</code> çš„è¿™ä¸ªè¾“å‡º <code>b</code></li>
<li>å¯¹ç…§ <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce">reduce çš„çœŸå®å®šä¹‰</a> æ¥ç†è§£ï¼š<ul>
<li><code>f</code> å³è¦å¯¹æ•°ç»„ä¸­æ¯ä¸ªå€¼æ‰§è¡Œçš„å‡½æ•°ï¼Œå®ƒçš„å‚æ•°å®é™…ä¸Šæ˜¯ï¼š<code>b</code> ä¸º <code>accumulator</code> å³ç´¯è®¡å›è°ƒçš„å€¼ï¼Œ<code>a</code> ä¸º <code>currentValue</code> å³æ­£åœ¨å¤„ç†çš„å½“å‰æ•°ç»„å…ƒç´ </li>
<li><code>x</code> æ˜¯ç¬¬ä¸€æ¬¡è°ƒç”¨ <code>f</code> æ—¶çš„åˆå§‹å€¼</li>
<li><code>xs</code> æ˜¯æ•°ç»„ï¼Œä¸ç”¨è®²äº†â€¦</li>
</ul>
</li>
</ul>
<h3 id="Parametricity"><a href="#Parametricity" class="headerlink" title="Parametricity"></a>Parametricity</h3><p><a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Parametricity">wiki</a> ï¼ˆæš‚æ—¶è¿˜æ²¡ç†è§£è¿™ä¸ªæ¦‚å¿µå•¥æ„æ€ï¼‰</p>
<p>ä½†åæ­£è¿™ä¸ªç‰¹æ€§è¡¨æ˜ï¼Œ<strong>å‡½æ•°å°†ä¼šä»¥ä¸€ç§ç»Ÿä¸€çš„è¡Œä¸ºä½œç”¨äºæ‰€æœ‰çš„ç±»å‹</strong></p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨çœ‹ç€ç±»å‹ç­¾åè¿›è¡Œå‡½æ•°åŠŸèƒ½çš„æ¨æ–­æ—¶ï¼Œè¦ä¿è¯å‡½æ•°å¯¹æ¯ä¸€ä¸ªå¯èƒ½çš„ç±»å‹æ“ä½œå¿…é¡»ä¿æŒç»Ÿä¸€ï¼Œè¿™æ ·å°±èƒ½ç¼©å°å¯èƒ½çš„åŠŸèƒ½çš„èŒƒå›´</p>
<p>ä¾‹å¦‚ï¼Œ<code>// head :: [a] -&gt; a</code>ï¼Œa å¯èƒ½æ˜¯ä»»æ„ç±»å‹ï¼Œæ‰€ä»¥å‡½æ•°åœ¨å¯¹ <code>a</code> ä¸€æ— æ‰€çŸ¥çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½å¯¹ <code>[a]</code> è¿›è¡Œçš„æ“ä½œï¼Œåªå¯èƒ½æ˜¯è¿”å›æ•°ç»„ä¸­çš„æŸä¸ªå…ƒç´ </p>
<h3 id="è‡ªç”±å®šç†"><a href="#è‡ªç”±å®šç†" class="headerlink" title="è‡ªç”±å®šç†"></a>è‡ªç”±å®šç†</h3><p>æ ¹æ®ï¼ˆå¤šæ€ï¼‰ç±»å‹ç­¾åï¼Œå¯ä»¥æ— éœ€çŸ¥é“å‡½æ•°å…·ä½“å®ç°çš„æƒ…å†µå°±å¯¹å‡½æ•°è¡¨è¾¾å¼è¿›è¡Œæ¨å¯¼å¾—åˆ°ä¸€äº›æ™®é€‚çš„é‡å†™è§„åˆ™ï¼Œä»è€Œå¯ä»¥é‡æ„ä»£ç ï¼Œæé«˜ä»£ç æ•ˆç‡</p>
<h3 id="ç±»å‹çº¦æŸ"><a href="#ç±»å‹çº¦æŸ" class="headerlink" title="ç±»å‹çº¦æŸ"></a>ç±»å‹çº¦æŸ</h3><p>ä¹Ÿå¯ä»¥æŠŠç±»å‹çº¦æŸä¸ºä¸€ä¸ªç‰¹å®šçš„æ¥å£ï¼ˆinterfaceï¼‰</p>
<h2 id="å®¹å™¨"><a href="#å®¹å™¨" class="headerlink" title="å®¹å™¨"></a>å®¹å™¨</h2><h3 id="Indentity"><a href="#Indentity" class="headerlink" title="Indentity"></a>Indentity</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Container</span> = <span class="keyword">function</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="comment">// è£…è½½ä»»æ„ç±»å‹çš„å€¼</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">__value</span> = x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ„é€ å™¨</span></span><br><span class="line"><span class="title class_">Container</span>.<span class="property">of</span> = <span class="keyword">function</span>(<span class="params">x</span>) &#123; </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Container</span>(x); </span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// ä¸€ä¸ªè®©åˆ«çš„å‡½æ•°ï¼ˆfï¼‰èƒ½æ“ä½œå®¹å™¨ä¸­å€¼çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">// è¿™æ ·å°±å¯ä»¥ä¸ç¦»å¼€ Container è€Œæ“ä½œå®¹å™¨é‡Œé¢çš„å€¼</span></span><br><span class="line"><span class="comment">// å¯ä»¥ Container.of(2).map(blabla).map(blabla) è¿ç»­è°ƒç”¨</span></span><br><span class="line"><span class="comment">// å•Šå“ˆï¼Œé‚£ map å°±æ˜¯ä¸ªç»„åˆï¼ˆcompostionï¼‰äº†</span></span><br><span class="line"><span class="title class_">Container</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">map</span> = <span class="keyword">function</span>(<span class="params">f</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Contain</span>.<span class="title function_">of</span>(<span class="title function_">f</span>(<span class="variable language_">this</span>.<span class="property">__value</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>functorï¼šå®ç°äº† <code>map</code> å‡½æ•°å¹¶éµå®ˆä¸€äº›ç‰¹å®šè§„åˆ™çš„å®¹å™¨ç±»å‹</p>
</blockquote>
<p>æŠŠå€¼è£…è¿›ä¸€ä¸ªå®¹å™¨ï¼Œè€Œä¸”åªèƒ½ä½¿ç”¨ <code>map</code> æ¥å¤„ç†å®ƒâ€”â€”æ˜¯æŠ½è±¡ï¼Œå¯¹å‡½æ•°è¿ç”¨çš„æŠ½è±¡ï¼ˆå½“ <code>map</code> ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¯·æ±‚å®¹å™¨æ¥è¿è¡Œè¿™ä¸ªå‡½æ•°ï¼‰</p>
<h3 id="Maybe"><a href="#Maybe" class="headerlink" title="Maybe"></a>Maybe</h3><p>å¦ä¸€ç§ functorï¼šå¤„ç†ç©ºå€¼</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Maybe</span> = <span class="keyword">function</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">__value</span> = x;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title class_">Maybe</span>.<span class="property">of</span> = <span class="keyword">function</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Maybe</span>(x);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title class_">Maybe</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">isNothing</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="variable language_">this</span>.<span class="property">__value</span> === <span class="literal">null</span> || <span class="variable language_">this</span>.<span class="property">__value</span> === <span class="literal">undefined</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title class_">Maybe</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">map</span> = <span class="keyword">function</span>(<span class="params">f</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">isNothing</span>()</span><br><span class="line">        ? <span class="title class_">Maybe</span>.<span class="title function_">of</span>(<span class="literal">null</span>)</span><br><span class="line">    	: <span class="title class_">Maybe</span>.<span class="title function_">of</span>(<span class="title function_">f</span>(<span class="variable language_">this</span>.<span class="property">__value</span>));</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·æˆ‘ä»¬åœ¨ä½¿ç”¨ <code>map</code> æ—¶ä»£ç å°±ä¸ä¼šæŠ¥é”™äº†ï¼Œè€Œæ˜¯ä¼šå¾—åˆ° <code>Maybe(null)</code></p>
<p><code>Maybe</code> æœ€å¸¸ç”¨åœ¨é‚£äº›å¯èƒ½ä¼šæ— æ³•æˆåŠŸè¿”å›ç»“æœçš„å‡½æ•°ä¸­ï¼Œé€šè¿‡ï¼ˆäººå·¥æˆ–è‡ªåŠ¨ï¼‰æŠ›å‡º <code>Maybe(null)</code> å¯ä»¥å®ç°å¤±è´¥æ—¶ç«‹å³åˆ‡æ–­æ‰§è¡Œ</p>
<p><strong>more pointfreeâ€¦</strong></p>
<p><code>any_functor_at_all</code> å³ä¸ºæˆ‘ä»¬ä¸Šé¢åˆ›å»ºçš„ <code>Contianer</code>ã€<code>Maybe</code> ç­‰ä»»æ„ functorï¼Œè¿™æ ·å°±æŠŠ functor çš„ç‚¹è®°å¼ map ä»£ç†æˆäº† pointfree çš„ map äº†</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// map :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b</span></span><br><span class="line"><span class="keyword">var</span> map = <span class="title function_">curry</span>(<span class="keyword">function</span>(<span class="params">f, any_functor_at_all</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> any_functor_at_all.<span class="title function_">map</span>(f);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸ªå¸®åŠ©å‡½æ•° <code>maybe</code>ï¼Œç”¨äºè¿”å›ä¸€ä¸ªè‡ªå®šä¹‰çš„å€¼ç„¶åè¿˜èƒ½ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// maybe :: b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b</span></span><br><span class="line"><span class="keyword">var</span> maybe = <span class="title function_">curry</span>(<span class="keyword">function</span>(<span class="params">x, f, m</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> m.<span class="title function_">isNothing</span>() ? x : <span class="title function_">f</span>(m.<span class="property">__value</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Either"><a href="#Either" class="headerlink" title="Either"></a>Either</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Left</span> = <span class="keyword">function</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">__value</span> = x;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title class_">Left</span>.<span class="property">of</span> = <span class="keyword">function</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Left</span>(x);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title class_">Left</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">map</span> = <span class="keyword">function</span>(<span class="params">f</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Right</span> = <span class="keyword">function</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">__value</span> = x;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title class_">Right</span>.<span class="property">of</span> = <span class="keyword">function</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Right</span>(x);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title class_">Right</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">map</span> = <span class="keyword">function</span>(<span class="params">f</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Right</span>.<span class="title function_">of</span>(<span class="title function_">f</span>(<span class="variable language_">this</span>.<span class="property">__value</span>));</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Right</span>.<span class="title function_">of</span>(<span class="string">&#x27;rain&#x27;</span>).<span class="title function_">map</span>(<span class="keyword">function</span>(<span class="params">str</span>)&#123; <span class="keyword">return</span> <span class="string">&#x27;b&#x27;</span>+str; &#125;);</span><br><span class="line"><span class="comment">// Right(&#x27;brain&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Left</span>.<span class="title function_">of</span>(<span class="string">&#x27;rain&#x27;</span>).<span class="title function_">map</span>(<span class="keyword">function</span>(<span class="params">str</span>)&#123; <span class="keyword">return</span> <span class="string">&#x27;b&#x27;</span>+str; &#125;);</span><br><span class="line"><span class="comment">// Left(&#x27;rain&#x27;) !here</span></span><br></pre></td></tr></table></figure>

<p><code>Right</code> å°±åƒä¸ª <code>Container</code>ï¼Œè€Œ <code>Left</code> æ— è§†äº†æˆ‘ä»¬çš„ map è¯·æ±‚</p>
<p><code>Left</code> å¯ä»¥ç”¨æ¥è¿”å›é”™è¯¯ï¼Œè®©ç¨‹åºçŸ­è·¯ï¼Œæ¯” <code>Maybe(null)</code> å¥½çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¯èƒ½é”™è¯¯çš„åœ°æ–¹ç»™ <code>Left</code> ä¼ é”™è¯¯ä¿¡æ¯äº†</p>
<p><code>Left</code> å’Œ <code>Right</code> æ˜¯ <code>Either</code> æŠ½è±¡ç±»å‹çš„ä¸¤ä¸ªå­ç±»ï¼Œä¸€ä¸ªï¼ˆä¼ªï¼‰ç±»å‹ç­¾åå¯ä»¥è¿™æ ·å†™ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Either(String, Number)</span></span><br><span class="line"><span class="comment">// String è¡¨ç¤ºå·¦è¾¹çš„å€¼æ˜¯ Stringï¼Œä¹Ÿå°±æ˜¯ Left(String)</span></span><br><span class="line"><span class="comment">// Number è¡¨ç¤ºå³è¾¹ Right(Number)</span></span><br></pre></td></tr></table></figure>

<p><strong>lift</strong>ï¼šä¸€ä¸ªå‡½æ•°åœ¨è°ƒç”¨çš„æ—¶å€™ï¼Œå¦‚æœè¢« <code>map</code> åŒ…è£¹äº†ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šä»ä¸€ä¸ªé functor å‡½æ•°è½¬æ¢ä¸ºä¸€ä¸ª functor å‡½æ•°ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªè¿‡ç¨‹å«åš liftã€‚ä¸€ä¸ªæ¯”è¾ƒå¥½çš„å®è·µæ˜¯ï¼Œä»æŒ‰ç…§æ™®é€šæ–¹å¼å»å†™ï¼ˆæ“ä½œæ™®é€šæ•°æ®ç±»å‹çš„ï¼‰å‡½æ•°ï¼Œåœ¨å¿…è¦çš„æ—¶å€™å†é€šè¿‡ lift å˜ä¸ºåˆé€‚çš„å®¹å™¨å»æ“ä½œå®¹å™¨ç±»å‹ï¼Œè¿™æ ·èƒ½å¾—åˆ°æ›´ç®€å•ã€é‡ç”¨æ€§æ›´é«˜çš„å‡½æ•°ï¼Œå®ƒä»¬èƒ½å¤Ÿéšéœ€æ±‚è€Œå˜ï¼Œå…¼å®¹ä»»æ„ functor</p>
<p><strong>å¸®åŠ©å‡½æ•° <code>either</code></strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// either :: (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c</span></span><br><span class="line"><span class="keyword">var</span> either = <span class="title function_">curry</span>(<span class="keyword">function</span>(<span class="params">f, g, e</span>) &#123;</span><br><span class="line">    <span class="keyword">switch</span>(e.<span class="property">constructor</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="title class_">Left</span>: <span class="keyword">return</span> <span class="title function_">f</span>(e.<span class="property">__value</span>);</span><br><span class="line">        <span class="keyword">case</span> <span class="title class_">Right</span>: <span class="keyword">return</span> <span class="title function_">g</span>(e.<span class="property">__value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="IO"><a href="#IO" class="headerlink" title="IO"></a>IO</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="variable constant_">IO</span> = <span class="keyword">function</span>(<span class="params">f</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">__value</span> = f;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable constant_">IO</span>.<span class="property">of</span> = <span class="keyword">function</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">IO</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable constant_">IO</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">map</span> = <span class="keyword">function</span>(<span class="params">f</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">IO</span>(_.<span class="title function_">compose</span>(f, <span class="variable language_">this</span>.<span class="property">__value</span>));</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><code>IO</code> æŠŠéçº¯åŠ¨ä½œæ•è·åˆ°åŒ…è£¹å‡½æ•°é‡Œï¼Œç›®çš„æ˜¯å»¶è¿Ÿè¿™ä¸ªéçº¯åŠ¨ä½œã€‚æˆ‘ä»¬å¯ä»¥è®¤ä¸º <code>IO</code> åŒ…å«çš„æ˜¯è¢«åŒ…è£¹çš„æ‰§è¡ŒåŠ¨ä½œçš„è¿”å›å€¼ï¼Œè€Œä¸æ˜¯åŒ…è£¹å‡½æ•°æœ¬èº«ï¼ˆåœ¨ of å‡½æ•°ä¸­å¯ä»¥çœ‹å‡ºï¼Œ<code>IO(function() &#123; return x; &#125;)</code> ä»…ä»…æ˜¯ä¸ºäº†å»¶è¿Ÿæ‰§è¡Œï¼Œå…¶å®æˆ‘ä»¬å¾—åˆ°çš„æ˜¯ <code>IO(x)</code></p>
<p>é€šè¿‡é“¾å¼è°ƒç”¨ <code>map</code>ï¼Œå…¶å®æ˜¯æŠŠä¼ ç»™ <code>map</code> çš„å‡½æ•°ä»¬å‹å…¥ä¸€ä¸ªâ€œè¿è¡Œæ ˆâ€ï¼Œç›´åˆ°æœ€ç»ˆè°ƒç”¨è€…è°ƒç”¨æ—¶æ‰ä¼šè¿è¡Œè¿™äº›ï¼ˆä¸çº¯çš„ï¼‰å‡½æ•°ä»¬</p>
<h3 id="å¼‚æ­¥ä»»åŠ¡"><a href="#å¼‚æ­¥ä»»åŠ¡" class="headerlink" title="å¼‚æ­¥ä»»åŠ¡"></a>å¼‚æ­¥ä»»åŠ¡</h3><p><code>Task</code></p>
<h3 id="ä¸€ç‚¹ç†è®º"><a href="#ä¸€ç‚¹ç†è®º" class="headerlink" title="ä¸€ç‚¹ç†è®º"></a>ä¸€ç‚¹ç†è®º</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// identity åŒä¸€å¾‹</span></span><br><span class="line"><span class="title function_">map</span>(id) === id;</span><br><span class="line"></span><br><span class="line"><span class="comment">// composition ç»„åˆå¾‹</span></span><br><span class="line"><span class="title function_">compose</span>(<span class="title function_">map</span>(f), <span class="title function_">map</span>(g)) === <span class="title function_">map</span>(<span class="title function_">compose</span>(f, g));</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åœ¨èŒƒç•´å­¦ä¸­ï¼Œfunctor æ¥å—ä¸€ä¸ªèŒƒç•´çš„å¯¹è±¡å’Œæ€å°„ï¼ˆmorphismï¼‰ï¼Œç„¶åæŠŠå®ƒä»¬æ˜ å°„ï¼ˆmapï¼‰åˆ°å¦ä¸€ä¸ªèŒƒç•´é‡Œå»</p>
<p>å¯ä»¥æŠŠèŒƒç•´æƒ³è±¡æˆä¸€ä¸ªæœ‰ç€å¤šä¸ªå¯¹è±¡çš„ç½‘ç»œï¼Œå¯¹è±¡ä¹‹é—´é æ€å°„è¿æ¥ã€‚é‚£ä¹ˆ functor å¯ä»¥æŠŠä¸€ä¸ªèŒƒç•´æ˜ å°„åˆ°å¦å¤–ä¸€ä¸ªï¼Œè€Œä¸”ä¸ä¼šç ´ååŸæœ‰çš„ç½‘ç»œ</p>
</blockquote>
<p><img src="https://llh911001.gitbooks.io/mostly-adequate-guide-chinese/content/images/functormap.png" alt="functor diagram"></p>
<h2 id="Monad"><a href="#Monad" class="headerlink" title="Monad"></a>Monad</h2><h3 id="pointed-functor"><a href="#pointed-functor" class="headerlink" title="pointed functor"></a>pointed functor</h3><blockquote>
<p>pointed functor æ˜¯å®ç°äº† <code>of</code> æ–¹æ³•çš„ functor</p>
</blockquote>
<p>å…³é”®æ˜¯ç”¨ <code>of</code> æŠŠä»»æ„å€¼ä¸¢åˆ°å®¹å™¨é‡Œç„¶åå°±å¯ä»¥å¼€å§‹åˆ°å¤„ä½¿ç”¨ <code>map</code> çš„èƒ½åŠ›ï¼Œåƒè¿™æ ·ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">any_pointed_functor.<span class="title function_">of</span>(any_value).<span class="title function_">map</span>(f)</span><br></pre></td></tr></table></figure>

<p><code>of</code> æ–¹æ³•ä¸æ˜¯ç”¨æ¥é¿å… <code>new</code> å…³é”®å­—çš„ï¼Œè€Œæ˜¯ç”¨æ¥æŠŠå€¼æ”¾åˆ°é»˜è®¤æœ€å°åŒ–ä¸Šä¸‹æ–‡ï¼ˆdefault minimal contextï¼‰ä¸­çš„ï¼ˆæˆ‘ä»¬å¸Œæœ›å®¹å™¨ç±»å‹çš„ä»»æ„å€¼éƒ½èƒ½å‘ç”Ÿ <code>lift</code>ï¼Œç„¶ååƒæ‰€æœ‰çš„ functor é‚£æ ·å† <code>map</code> å‡ºå»ï¼‰</p>
<h3 id="monad"><a href="#monad" class="headerlink" title="monad"></a>monad</h3><blockquote>
<p>monad æ˜¯å¯ä»¥å˜æ‰ï¼ˆflattenï¼‰çš„ pointed functor</p>
</blockquote>
<p>å› ä¸ºåœ¨è¿ç»­çš„ functor ä¼ é€’ä¸­ï¼Œå€¼ä¼šè¢«åŒ…æˆ functor(value) -&gt; ä¼ ç»™ä¸‹ä¸€ä¸ªå‡½æ•° -&gt; è€Œä¸‹ä¸€ä¸ªå‡½æ•°æ˜¯æ™®é€šå‡½æ•°éœ€è¦ç”¨ map åŒ…ä¸€ä¸‹ä»¥å¤„ç† functor -&gt; å¤„ç†å®Œå°±å˜æˆäº† functor(functor(value)) -&gt; é‚£ä¹ˆå†ä¸‹ä¸€ä¸ªå‡½æ•°å°±éœ€è¦åŒ…ä¸¤å±‚ mapâ€¦</p>
<p>ä¾‹å¦‚ï¼Œ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  safeProp :: Key -&gt; &#123;Key: a&#125; -&gt; Maybe a</span></span><br><span class="line"><span class="keyword">var</span> safeProp = <span class="title function_">curry</span>(<span class="keyword">function</span>(<span class="params">x, obj</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Maybe</span>(obj[x]);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//  safeHead :: [a] -&gt; Maybe a</span></span><br><span class="line"><span class="keyword">var</span> safeHead = <span class="title function_">safeProp</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//  firstAddressStreet :: User -&gt; Maybe (Maybe (Maybe Street) )</span></span><br><span class="line"><span class="keyword">var</span> firstAddressStreet = <span class="title function_">compose</span>(</span><br><span class="line">  <span class="title function_">map</span>(<span class="title function_">map</span>(<span class="title function_">safeProp</span>(<span class="string">&#x27;street&#x27;</span>))), <span class="title function_">map</span>(safeHead), <span class="title function_">safeProp</span>(<span class="string">&#x27;addresses&#x27;</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="title function_">firstAddressStreet</span>(</span><br><span class="line">  &#123;<span class="attr">addresses</span>: [&#123;<span class="attr">street</span>: &#123;<span class="attr">name</span>: <span class="string">&#x27;Mulburry&#x27;</span>, <span class="attr">number</span>: <span class="number">8402</span>&#125;, <span class="attr">postcode</span>: <span class="string">&quot;WC2N&quot;</span> &#125;]&#125;</span><br><span class="line">);</span><br><span class="line"><span class="comment">// Maybe(Maybe(Maybe(&#123;name: &#x27;Mulburry&#x27;, number: 8402&#125;)))</span></span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†è§£å†³è¿™ä¸ªä¸€å±‚ä¸€å±‚æ´‹è‘±ä¸€æ ·çš„åµŒå¥—ï¼Œå¯ä»¥åœ¨ functor ä¸Šå®šä¹‰ä¸€ä¸ª <code>join</code> æ–¹æ³•ï¼Œè¿™ä¸ª functor å°±æˆä¸ºäº†ä¸€ä¸ª monad</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Maybe</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">join</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">isNothing</span>() ? <span class="title class_">Maybe</span>.<span class="title function_">of</span>(<span class="literal">null</span>) : <span class="variable language_">this</span>.<span class="property">__value</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> mmo = <span class="title class_">Maybe</span>.<span class="title function_">of</span>(<span class="title class_">Maybe</span>.<span class="title function_">of</span>(<span class="string">&#x27;nunchuncks&#x27;</span>));</span><br><span class="line"><span class="comment">// Maybe.of(Maybe.of(&#x27;nunchuncks&#x27;))</span></span><br><span class="line">mmo.<span class="title function_">join</span>();</span><br><span class="line"><span class="comment">// Maybe.of(&#x27;nunchuncks&#x27;) -&gt; flatten!!</span></span><br></pre></td></tr></table></figure>

<p>ç”¨ monad é­”æ³•æ”¹é€ ä¸Šé¢çš„ firstAddressStreet ä¾‹å­ï¼Œåœ¨æ¯æ¬¡å¾—åˆ°åµŒå¥— <code>Maybe</code> ååŠ ä¸€ä¸ª <code>join</code> æŠŠå®ƒå˜å¹³</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  join :: Monad m =&gt; m (m a) -&gt; m a</span></span><br><span class="line"><span class="keyword">var</span> join = <span class="keyword">function</span>(<span class="params">mma</span>) &#123; <span class="keyword">return</span> mma.<span class="title function_">join</span>(); &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  firstAddressStreet :: User -&gt; Maybe Street</span></span><br><span class="line"><span class="keyword">var</span> firstAddressStreet = <span class="title function_">compose</span>(join, <span class="title function_">map</span>(<span class="title function_">safeProp</span>(<span class="string">&#x27;street&#x27;</span>)), join, <span class="title function_">map</span>(safeHead), <span class="title function_">safeProp</span>(<span class="string">&#x27;addresses&#x27;</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="title function_">firstAddressStreet</span>(</span><br><span class="line">  &#123;<span class="attr">addresses</span>: [&#123;<span class="attr">street</span>: &#123;<span class="attr">name</span>: <span class="string">&#x27;Mulburry&#x27;</span>, <span class="attr">number</span>: <span class="number">8402</span>&#125;, <span class="attr">postcode</span>: <span class="string">&quot;WC2N&quot;</span> &#125;]&#125;</span><br><span class="line">);</span><br><span class="line"><span class="comment">// Maybe(&#123;name: &#x27;Mulburry&#x27;, number: 8402&#125;)</span></span><br></pre></td></tr></table></figure>

<h3 id="chain"><a href="#chain" class="headerlink" title="chain"></a>chain</h3><p>ä¸Šé¢çš„ä¾‹å­ä¸­åŒ…å«ä¸€ç§æ¨¡å¼ï¼šæˆ‘ä»¬æ€»æ˜¯åœ¨ç´§è·Ÿç€ <code>map</code> çš„åé¢è°ƒç”¨ <code>join</code>ã€‚æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªè¡Œä¸ºæŠ½è±¡åˆ°ä¸€ä¸ªå«åš <code>chain</code> çš„å‡½æ•°ä¸­</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  chain :: Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b</span></span><br><span class="line"><span class="keyword">var</span> chain = <span class="title function_">curry</span>(<span class="keyword">function</span>(<span class="params">f, m</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> m.<span class="title function_">map</span>(f).<span class="title function_">join</span>(); <span class="comment">// or compose(join, map(f))(m)</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><code>chain</code> ä¹Ÿå«ä½œ <code>&gt;&gt;=</code> ï¼ˆè¯»ä½œ bindï¼‰æˆ–è€… <code>flatMap</code>ï¼Œé‡æ„ä¸€ä¸‹ä¸Šé¢çš„ä¾‹å­</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// map/join</span></span><br><span class="line"><span class="keyword">var</span> firstAddressStreet = <span class="title function_">compose</span>(join, <span class="title function_">map</span>(<span class="title function_">safeProp</span>(<span class="string">&#x27;street&#x27;</span>)), join, <span class="title function_">map</span>(safeHead), <span class="title function_">safeProp</span>(<span class="string">&#x27;addresses&#x27;</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// chain</span></span><br><span class="line"><span class="keyword">var</span> firstAddressStreet = <span class="title function_">compose</span>(<span class="title function_">chain</span>(<span class="title function_">safeProp</span>(<span class="string">&#x27;street&#x27;</span>)), <span class="title function_">chain</span>(safeHead), <span class="title function_">safeProp</span>(<span class="string">&#x27;addresses&#x27;</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>å› ä¸º <code>chain</code> å¯ä»¥è½»æ¾åµŒå¥—å¤šä¸ªä½œç”¨ï¼Œå› æ­¤æˆ‘ä»¬å°±èƒ½ä»¥ä¸€ç§çº¯å‡½æ•°å¼çš„æ–¹å¼æ¥è¡¨ç¤º åºåˆ—ï¼ˆsequenceï¼‰å’Œ å˜é‡èµ‹å€¼ï¼ˆvariable assignmentï¼‰ã€‚åƒè¿™æ ·ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Maybe</span>.<span class="title function_">of</span>(<span class="literal">null</span>).<span class="title function_">chain</span>(<span class="title function_">safeProp</span>(<span class="string">&#x27;address&#x27;</span>)).<span class="title function_">chain</span>(<span class="title function_">safeProp</span>(<span class="string">&#x27;street&#x27;</span>));</span><br><span class="line"><span class="comment">// Maybe(null)</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨æ’å…¥å¼çš„ <code>chain</code>ï¼Œé¿å…äº† <code>compose</code> æ—¶è¿˜éœ€è¦å‡ ä¸ªå¸®åŠ©å‡½æ•°</p>
<p>è®°ä½ï¼šè¿”å›çš„å¦‚æœæ˜¯â€œæ™®é€šâ€å€¼å°±ç”¨ <code>map</code>ï¼Œå¦‚æœæ˜¯ <code>functor</code> å°±ç”¨ <code>chain</code></p>
<h3 id="ç†è®º"><a href="#ç†è®º" class="headerlink" title="ç†è®º"></a>ç†è®º</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç»“åˆå¾‹</span></span><br><span class="line"><span class="title function_">compose</span>(join, <span class="title function_">map</span>(join)) == <span class="title function_">compose</span>(join, join)</span><br></pre></td></tr></table></figure>

<p><img src="https://llh911001.gitbooks.io/mostly-adequate-guide-chinese/content/images/monad_associativity.png" alt="monad associativity law"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸‰è§’åŒä¸€å¾‹</span></span><br><span class="line"><span class="title function_">compose</span>(join, <span class="keyword">of</span>) == <span class="title function_">compose</span>(join, <span class="title function_">map</span>(<span class="keyword">of</span>)) == id</span><br></pre></td></tr></table></figure>

<p><img src="https://llh911001.gitbooks.io/mostly-adequate-guide-chinese/content/images/triangle_identity.png" alt="monad identity law"></p>
<h2 id="Applicative-Functor"><a href="#Applicative-Functor" class="headerlink" title="Applicative Functor"></a>Applicative Functor</h2><blockquote>
<p><code>ap</code> å°±æ˜¯è¿™æ ·ä¸€ç§å‡½æ•°ï¼Œèƒ½å¤ŸæŠŠä¸€ä¸ª functor çš„å‡½æ•°å€¼åº”ç”¨åˆ°å¦ä¸€ä¸ª functor çš„å€¼ä¸Šã€‚</p>
</blockquote>
<p>æ¯”å¦‚æˆ‘ä»¬æƒ³è®©ä¸¤ä¸ª <code>Container</code> çš„å€¼ç›¸åŠ ï¼Œ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™æ ·æ˜¯è¡Œä¸é€šçš„, å› ä¸º 2 å’Œ 3 éƒ½è—åœ¨ Container é‡Œ</span></span><br><span class="line"><span class="title function_">add</span>(<span class="title class_">Container</span>.<span class="title function_">of</span>(<span class="number">2</span>), <span class="title class_">Container</span>.<span class="title function_">of</span>(<span class="number">3</span>));</span><br><span class="line"><span class="comment">// NaN</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨å¯é çš„ map å‡½æ•°, å¾—åˆ°ä¸€ä¸ªå±€éƒ¨è°ƒç”¨çš„ add(2)</span></span><br><span class="line"><span class="keyword">var</span> container_of_add_2 = <span class="title function_">map</span>(add, <span class="title class_">Container</span>.<span class="title function_">of</span>(<span class="number">2</span>));</span><br><span class="line"><span class="comment">// Container(add(2))</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Container</span>.<span class="title function_">of</span>(<span class="number">2</span>).<span class="title function_">chain</span>(<span class="keyword">function</span>(<span class="params">two</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Container</span>.<span class="title function_">of</span>(<span class="number">3</span>).<span class="title function_">map</span>(<span class="title function_">add</span>(two));</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>ap ç‰ˆæœ¬</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Container</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">ap</span> = <span class="keyword">function</span>(<span class="params">other_container</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> other_container.<span class="title function_">map</span>(<span class="variable language_">this</span>.<span class="property">__value</span>);</span><br><span class="line">    <span class="comment">// this.__value æ˜¯ä¸€ä¸ªå‡½æ•°, æ¥å—å¦ä¸€ä¸ª functor ä½œä¸ºå‚æ•°</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™æ ·ä½¿ç”¨</span></span><br><span class="line"><span class="title class_">Container</span>.<span class="title function_">of</span>(<span class="title function_">add</span>(<span class="number">2</span>)).<span class="title function_">ap</span>(<span class="title class_">Container</span>.<span class="title function_">of</span>(<span class="number">3</span>)); <span class="comment">// Container(5)</span></span><br><span class="line"><span class="title class_">Container</span>.<span class="title function_">of</span>(<span class="number">2</span>).<span class="title function_">map</span>(add).<span class="title function_">ap</span>(<span class="title class_">Container</span>.<span class="title function_">of</span>(<span class="number">3</span>)); <span class="comment">// Container(5)</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>applicative functor æ˜¯å®ç°äº† <code>ap</code> æ–¹æ³•çš„ pointed functor</p>
</blockquote>
<p>ä¸€ä¸ªç‰¹æ€§ï¼š<code>map</code> ä¸€ä¸ª <code>f</code> ç­‰ä»·äº <code>ap</code> ä¸€ä¸ªå€¼ä¸º <code>f</code> çš„ functor</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">F.<span class="title function_">of</span>(x).<span class="title function_">map</span>(f) == F.<span class="title function_">of</span>(f).<span class="title function_">ap</span>(F.<span class="title function_">of</span>(x))</span><br></pre></td></tr></table></figure>

<p>applicative functor å¯ä»¥ä½¿å‡ ä¸ªï¼ˆç‹¬ç«‹çš„ä¸éœ€è¦ä¾èµ–é¡ºåºçš„ï¼‰å‡½æ•°åŒæ—¶æ‰§è¡Œ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Http.get :: String -&gt; Task Error HTML</span></span><br><span class="line"><span class="keyword">var</span> renderPage = <span class="title function_">curry</span>(<span class="keyword">function</span>(<span class="params">destions, events</span>) &#123; <span class="comment">/* render page */</span> &#125;);</span><br><span class="line"><span class="title class_">Task</span>.<span class="title function_">of</span>(renderPage).<span class="title function_">ap</span>(<span class="title class_">Http</span>.<span class="title function_">get</span>(<span class="string">&#x27;/destinations&#x27;</span>)).<span class="title function_">ap</span>(<span class="title class_">Http</span>.<span class="title function_">get</span>(<span class="string">&#x27;/events&#x27;</span>))</span><br><span class="line"><span class="comment">// ä¸¤ä¸ª HTTP è¯·æ±‚ä¼šåŒæ—¶æ‰§è¡Œï¼Œå½“ä¸¤è€…çš„å“åº”éƒ½è¿”å›ä¹‹å renderPage æ‰ä¼šè¢«è°ƒç”¨</span></span><br><span class="line"><span class="comment">// æ˜¯ä½¿ç”¨å±€éƒ¨è°ƒç”¨çš„å‡½æ•°æ¥è¾¾æˆä¸Šè¿°ç»“æœçš„ï¼Œæ‰€ä»¥å¿…é¡»ä¿è¯ renderPage æ˜¯ curry å‡½æ•°ï¼ˆæ²¡æƒ³æ˜ç™½ï¼ï¼‰</span></span><br><span class="line"><span class="comment">// è°ƒç”¨äº†ä¸¤æ¬¡ apï¼Œæ¯æ¬¡è°ƒç”¨ä¸­ renderPage å°±æ”¶åˆ°ä¸€ä¸ªå‚æ•°ç„¶åè¿è¡Œï¼Œç›´åˆ°æ‰€æœ‰çš„å‚æ•°éƒ½ä¼ è¿›æ¥å®ƒä¹Ÿå°±æ‰§è¡Œå®Œæ¯•äº†</span></span><br></pre></td></tr></table></figure>

<h3 id="lift"><a href="#lift" class="headerlink" title="lift"></a>lift</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> liftA2 = <span class="title function_">curry</span>(<span class="keyword">function</span>(<span class="params">f, functor1, functor2</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> functor1.<span class="title function_">map</span>(f).<span class="title function_">ap</span>(functor2);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> liftA3 = <span class="title function_">curry</span>(<span class="keyword">function</span>(<span class="params">f, functor1, functor2, functor3</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> functor1.<span class="title function_">map</span>(f).<span class="title function_">ap</span>(functor2).<span class="title function_">ap</span>(functor3);</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// liftA4, etc...</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>è®©é‚£äº›å°ä»£ç å—å‘ç”Ÿ liftï¼Œæˆä¸º applicative functor ä¸­çš„ä¸€å‘˜</p>
</blockquote>
<p>ä¸€ä¸ªå®é™…ç”¨ä¾‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// checkEmail :: User -&gt; Either String Email</span></span><br><span class="line"><span class="comment">// checkName :: User -&gt; Either String String</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// createUser :: Email -&gt; String -&gt; IO User</span></span><br><span class="line">ver createUser = <span class="title function_">curry</span>(<span class="keyword">function</span>(<span class="params">email, name</span>) &#123; <span class="comment">/* creating */</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Either</span>.<span class="title function_">of</span>(createUser).<span class="title function_">ap</span>(<span class="title function_">checkEmail</span>(user)).<span class="title function_">ap</span>(<span class="title function_">checkName</span>(user));</span><br><span class="line"></span><br><span class="line"><span class="title function_">liftA2</span>(createUser, <span class="title function_">checkEmail</span>(user), <span class="title function_">checkName</span>(user));</span><br></pre></td></tr></table></figure>

<h3 id="è¡ç”Ÿå‡½æ•°"><a href="#è¡ç”Ÿå‡½æ•°" class="headerlink" title="è¡ç”Ÿå‡½æ•°"></a>è¡ç”Ÿå‡½æ•°</h3><p><code>of/ap</code> &#x3D; <code>map</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">X.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">map</span> = <span class="keyword">function</span>(<span class="params">f</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">constructor</span>.<span class="title function_">of</span>(f).<span class="title function_">ap</span>(<span class="variable language_">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>chain</code> -&gt; functor applicativeï¼ˆä½†ä¼šå¤±å» <code>ap</code> å¹¶è¡Œçš„èƒ½åŠ›ï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">X.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">map</span> = <span class="keyword">function</span>(<span class="params">f</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> m = <span class="variable language_">this</span>;</span><br><span class="line">    <span class="keyword">return</span> m.<span class="title function_">chain</span>(<span class="keyword">function</span>(<span class="params">a</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> m.<span class="property">constructor</span>.<span class="title function_">of</span>(<span class="title function_">f</span>(a));</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">X.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">ap</span> = <span class="keyword">function</span>(<span class="params">other</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">chain</span>(<span class="keyword">function</span>(<span class="params">f</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> other.<span class="title function_">map</span>(f);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å®šå¾‹"><a href="#å®šå¾‹" class="headerlink" title="å®šå¾‹"></a>å®šå¾‹</h3><ul>
<li><p>applicative functor æ˜¯ç»„åˆå…³é—­ï¼ˆclosed under compositionï¼‰çš„ï¼Œæ„å‘³ç€ <code>ap</code> æ°¸è¿œä¸ä¼šæ”¹å˜å®¹å™¨ç±»å‹</p>
</li>
<li><p>åŒä¸€å¾‹ï¼ˆidentityï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">A.<span class="title function_">of</span>(id).<span class="title function_">ap</span>(v) == v</span><br><span class="line"><span class="title function_">map</span>(id) == id</span><br></pre></td></tr></table></figure>
</li>
<li><p>åŒæ€ï¼ˆhomomorphismï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A.<span class="title function_">of</span>(f).<span class="title function_">ap</span>(A.<span class="title function_">of</span>(x)) == A.<span class="title function_">of</span>(<span class="title function_">f</span>(x))</span><br></pre></td></tr></table></figure>

<p>åŒæ€å°±æ˜¯ä¸€ä¸ªèƒ½å¤Ÿä¿æŒç»“æ„çš„æ˜ å°„ï¼Œå®é™…ä¸Šï¼Œfunctor å°±æ˜¯ä¸€ä¸ªåœ¨ä¸åŒèŒƒç•´é—´çš„åŒæ€ï¼Œå› ä¸º functor åœ¨ç»è¿‡æ˜ å°„ä¹‹åä¿æŒäº†åŸå§‹èŒƒç•´çš„ç»“æ„</p>
</li>
<li><p>äº’æ¢ï¼ˆinterchangeï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v.<span class="title function_">ap</span>(A.<span class="title function_">of</span>(x)) == A.<span class="title function_">of</span>(<span class="keyword">function</span>(<span class="params">f</span>) &#123; <span class="keyword">return</span> <span class="title function_">f</span>(x) &#125;).<span class="title function_">ap</span>(v)</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç»„åˆï¼ˆcompositionï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A.<span class="title function_">of</span>(compose).<span class="title function_">ap</span>(u).<span class="title function_">ap</span>(v).<span class="title function_">ap</span>(w) == u.<span class="title function_">ap</span>(v.<span class="title function_">ap</span>(w));</span><br></pre></td></tr></table></figure></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="ce">
    <link itemprop="mainEntityOfPage" href="https://hayahayao.github.io/2020/04/30/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E5%9B%BE%E8%AF%B4%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="hayahayao">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ã•ãŠã‚Šã®Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/30/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E5%9B%BE%E8%AF%B4%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" class="post-title-link" itemprop="url">è¯»ä¹¦ç¬”è®°-å›¾è¯´è®¾è®¡æ¨¡å¼</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-30 13:35:00" itemprop="dateCreated datePublished" datetime="2020-04-30T13:35:00+08:00">2020-04-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-08-23 01:36:15" itemprop="dateModified" datetime="2023-08-23T01:36:15+08:00">2023-08-23</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="è®¾è®¡æ¨¡å¼"><a href="#è®¾è®¡æ¨¡å¼" class="headerlink" title="è®¾è®¡æ¨¡å¼"></a>è®¾è®¡æ¨¡å¼</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://design-patterns.readthedocs.io/zh_CN/latest/">å›¾è¯´è®¾è®¡æ¨¡å¼</a> ä¸€ä¹¦çš„è¯»ä¹¦ç¬”è®°</p>
</blockquote>
<h2 id="çœ‹æ‡‚UMLç±»å›¾å’Œæ—¶åºå›¾"><a href="#çœ‹æ‡‚UMLç±»å›¾å’Œæ—¶åºå›¾" class="headerlink" title="çœ‹æ‡‚UMLç±»å›¾å’Œæ—¶åºå›¾"></a>çœ‹æ‡‚UMLç±»å›¾å’Œæ—¶åºå›¾</h2><h3 id="UMLç±»å›¾"><a href="#UMLç±»å›¾" class="headerlink" title="UMLç±»å›¾"></a>UMLç±»å›¾</h3><p>å…¶ä¸­ç”¨ç®­å¤´è¡¨ç¤ºçš„ç±»ä¹‹é—´çš„å…³ç³»æœ‰ä»¥ä¸‹å…­ç§</p>
<table>
<thead>
<tr>
<th>å…³ç³»</th>
<th>ç®­å¤´</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>æ³›åŒ– generalization</td>
<td>ç©ºå¿ƒç®­å¤´å®çº¿</td>
<td>ç»§æ‰¿ï¼ˆis-aï¼‰éæŠ½è±¡ç±»ï¼ŒA-&gt;B &#x3D; Aç»§æ‰¿è‡ªB</td>
</tr>
<tr>
<td>å®ç° realize</td>
<td>ç©ºå¿ƒç®­å¤´è™šçº¿</td>
<td>ç»§æ‰¿ï¼ˆis-aï¼‰æŠ½è±¡ç±»ï¼ŒA-&gt;B &#x3D; Aç»§æ‰¿è‡ªB</td>
</tr>
<tr>
<td>èšåˆ aggregation</td>
<td>ç©ºå¿ƒè±å½¢ç®­å¤´å®çº¿</td>
<td>è¡¨ç¤ºå¯¹è±¡å®ä½“ä¹‹é—´çš„å…³ç³»ï¼ŒA-&gt;B &#x3D; Aèšåˆåˆ°Bä¸Š &#x3D; Bç”±Aç»„æˆ</td>
</tr>
<tr>
<td>ç»„åˆ composition</td>
<td>å®å¿ƒè±å½¢ç®­å¤´å®ç°</td>
<td>ä¸èšåˆåŒæ ·è¯­ä¹‰ï¼Œä½†æ˜¯ä¸åŒçš„æ˜¯èšåˆé‡Œæ•´ä½“å’Œéƒ¨åˆ†ä¸æ˜¯å¼ºä¾èµ–çš„ï¼Œæ•´ä½“ä¸å­˜åœ¨äº†éƒ¨åˆ†ä»ç„¶å­˜åœ¨ï¼›è€Œç»„åˆé‡Œæ•´ä½“ä¸å­˜åœ¨äº†éƒ¨åˆ†ä¹Ÿè·Ÿç€æ¶ˆå¤±</td>
</tr>
<tr>
<td>å…³è” association</td>
<td>ç›´çº¿</td>
<td>æè¿°å¯¹è±¡é—´çš„ç»“æ„å…³ç³»ï¼Œæ˜¯ä¸€ç§é™æ€çš„ã€å¤©ç„¶çš„ç»“æ„ï¼Œé»˜è®¤ä¸å¼ºè°ƒæ–¹å‘ã€‚é€šå¸¸å®ç°ä¸ºæˆå‘˜å˜é‡</td>
</tr>
<tr>
<td>ä¾èµ– dependency</td>
<td>å¸¦ç®­å¤´çš„è™šçº¿</td>
<td>æè¿°ä¸€ä¸ªå¯¹è±¡åœ¨è¿è¡Œæ—¶ä¼šç”¨åˆ°å¦ä¸€ä¸ªå¯¹è±¡çš„å…³ç³»ï¼Œä¸´æ—¶æ€§ï¼Œåº”è¯¥æ€»æ˜¯ä¿æŒå•å‘ä¾èµ–ã€‚é€šå¸¸å®ç°ä¸ºç±»æ„é€ æ–¹æ³•ä»¥åŠç±»æ–¹æ³•çš„ä¼ å…¥å‚æ•°</td>
</tr>
</tbody></table>
<h3 id="æ—¶åºå›¾"><a href="#æ—¶åºå›¾" class="headerlink" title="æ—¶åºå›¾"></a>æ—¶åºå›¾</h3><h2 id="è®¾è®¡åŸåˆ™"><a href="#è®¾è®¡åŸåˆ™" class="headerlink" title="è®¾è®¡åŸåˆ™"></a>è®¾è®¡åŸåˆ™</h2><h3 id="å•ä¸€èŒè´£åŸåˆ™"><a href="#å•ä¸€èŒè´£åŸåˆ™" class="headerlink" title="å•ä¸€èŒè´£åŸåˆ™"></a>å•ä¸€èŒè´£åŸåˆ™</h3><p>ä¸€ä¸ªç±»åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½é¢†åŸŸä¸­çš„ç›¸åº”èŒè´£</p>
<p>ä¸“æ³¨é™ä½ç±»çš„å¤æ‚åº¦ï¼Œå®ç°ç±»è¦èŒè´£å•ä¸€</p>
<h3 id="å¼€æ”¾å…³é—­åŸåˆ™"><a href="#å¼€æ”¾å…³é—­åŸåˆ™" class="headerlink" title="å¼€æ”¾å…³é—­åŸåˆ™"></a>å¼€æ”¾å…³é—­åŸåˆ™</h3><p>è®¾è®¡è¦å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­</p>
<p>æ‰€æœ‰é¢å‘å¯¹è±¡åŸåˆ™çš„æ ¸å¿ƒ</p>
<p>å…³é”®ï¼šç³»ç»Ÿçš„æŠ½è±¡åŒ–è®¾è®¡</p>
<h3 id="é‡Œå¼æ›¿æ¢åŸåˆ™"><a href="#é‡Œå¼æ›¿æ¢åŸåˆ™" class="headerlink" title="é‡Œå¼æ›¿æ¢åŸåˆ™"></a>é‡Œå¼æ›¿æ¢åŸåˆ™</h3><p>æ‰€æœ‰å¼•ç”¨åŸºç±»ï¼ˆçˆ¶ç±»ï¼‰çš„åœ°æ–¹éƒ½å¿…é¡»èƒ½é€æ˜åœ°ä½¿ç”¨å…¶å­ç±»çš„å¯¹è±¡ã€</p>
<p>å®ç°å¼€é—­åŸåˆ™çš„é‡è¦æ–¹å¼ä¹‹ä¸€ï¼Œè®¾è®¡ä¸è¦ç ´åç»§æ‰¿å…³ç³»</p>
<p>å› æ­¤å°½é‡ä½¿ç”¨åŸºç±»ç±»å‹å®šä¹‰å¯¹è±¡ï¼Œè€Œåœ¨è¿è¡Œæ—¶å†ç¡®å®šå…¶å­ç±»ç±»å‹ï¼Œç”¨å­ç±»å¯¹è±¡æ¥æ›¿æ¢çˆ¶ç±»å¯¹è±¡</p>
<h3 id="ä¾èµ–å€’ç½®åŸåˆ™"><a href="#ä¾èµ–å€’ç½®åŸåˆ™" class="headerlink" title="ä¾èµ–å€’ç½®åŸåˆ™"></a>ä¾èµ–å€’ç½®åŸåˆ™</h3><p>æŠ½è±¡ä¸åº”è¯¥ä¾èµ–äºç»†èŠ‚ï¼Œç»†èŠ‚åº”å½“ä¾èµ–äºæŠ½è±¡</p>
<p>ç³»ç»ŸæŠ½è±¡åŒ–çš„å…·ä½“å®ç°ï¼Œæ˜¯é¢å‘å¯¹è±¡è®¾è®¡çš„ä¸»è¦å®ç°æœºåˆ¶ä¹‹ä¸€</p>
<p>è¦æ±‚é¢å‘æ¥å£ç¼–ç¨‹ï¼Œä¸é’ˆå¯¹å…·ä½“å®ç°ç¼–ç¨‹</p>
<p>åœ¨ä»£ç ä¸­ä¼ é€’å‚æ•°æ—¶æˆ–åœ¨å…³è”å…³ç³»ä¸­ï¼Œå°½é‡å¼•ç”¨é«˜å±‚çš„æŠ½è±¡åŸºç±»ï¼Œå³ä½¿ç”¨æ¥å£å’ŒæŠ½è±¡ç±»è¿›è¡Œå˜é‡ç±»å‹å£°æ˜ã€å‚æ•°ç±»å‹å£°æ˜ã€æ–¹æ³•è¿”å›ç±»å‹å£°æ˜ã€ä»¥åŠæ•°æ®ç±»å‹çš„è½¬æ¢ç­‰ï¼Œè€Œä¸è¦ç”¨å…·ä½“ç±»åšè¿™äº›äº‹æƒ…</p>
<p>è¿™æ ·ä¸€æ¥ï¼Œå¦‚æœç³»ç»Ÿå‘ç”Ÿå˜åŒ–ï¼Œåªéœ€å¯¹æŠ½è±¡å±‚è¿›è¡Œæ‰©å±•ï¼Œè€Œä¸å¿…ä¿®æ”¹ç³»ç»Ÿç°æœ‰çš„ä¸šåŠ¡é€»è¾‘ï¼Œä»è€Œæ»¡è¶³å¼€é—­åŸåˆ™çš„è¦æ±‚</p>
<p>ç›®æ ‡ï¼šå¼€é—­åŸåˆ™ï¼ŒåŸºç¡€ï¼šé‡Œå¼ä»£æ¢ï¼Œæ‰‹æ®µï¼šä¾èµ–å€’ç½®</p>
<h3 id="æ¥å£éš”ç¦»åŸåˆ™"><a href="#æ¥å£éš”ç¦»åŸåˆ™" class="headerlink" title="æ¥å£éš”ç¦»åŸåˆ™"></a>æ¥å£éš”ç¦»åŸåˆ™</h3><p>ä½¿ç”¨å¤šä¸ªä¸“é—¨çš„æ¥å£ï¼Œè€Œä¸ä½¿ç”¨å•ä¸€çš„æ€»æ¥å£ï¼Œå³å®¢æˆ·ç«¯ä¸åº”è¯¥ä¾èµ–é‚£äº›å®ƒä¸éœ€è¦çš„æ¥å£</p>
<p>å®¢æˆ·éœ€è¦ä»€ä¹ˆæ ·çš„æ¥å£ï¼Œå°±æä¾›ä»€ä¹ˆæ ·çš„æ¥å£ï¼Œä¸éœ€è¦çš„å°±åˆ é™¤æ‰</p>
<p>ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»åº”å»ºç«‹åœ¨æœ€å°æ¥å£ä¸Šï¼Œä¹Ÿå°±æ˜¯è¯´æ¥å£è¦å°½é‡ç»†åŒ–ï¼ŒåŒæ—¶æ¥å£ä¸­çš„æ–¹æ³•åº”è¯¥å°½é‡å°‘ï¼ŒèŒè´£è¦å°½å¯èƒ½å•ä¸€</p>
<p>å®é™…ä½¿ç”¨æ—¶è¦æ³¨æ„æ§åˆ¶æ¥å£çš„ç²’åº¦ï¼Œå¦‚æœå¤ªå°ä¼šå¯¼è‡´ç³»ç»Ÿä¸­æ¥å£æ³›æ»¥ä¸åˆ©äºç»´æŠ¤ï¼Œå¤ªå¤§åˆè¿åæ¥å£éš”ç¦»åŸåˆ™ï¼Œçµæ´»æ€§è¾ƒå·®ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œæ¥å£ä¸­ä»…åŒ…å«ä¸ºæŸä¸€ç±»å®¢æˆ·å®šåˆ¶çš„æ–¹æ³•å³å¯</p>
<h3 id="è¿ªç±³ç‰¹åŸåˆ™ï¼ˆæœ€å°çŸ¥è¯†åŸåˆ™ï¼‰"><a href="#è¿ªç±³ç‰¹åŸåˆ™ï¼ˆæœ€å°çŸ¥è¯†åŸåˆ™ï¼‰" class="headerlink" title="è¿ªç±³ç‰¹åŸåˆ™ï¼ˆæœ€å°çŸ¥è¯†åŸåˆ™ï¼‰"></a>è¿ªç±³ç‰¹åŸåˆ™ï¼ˆæœ€å°çŸ¥è¯†åŸåˆ™ï¼‰</h3><p>ä¸€ä¸ªè½¯ä»¶å®ä½“åº”å½“å°½å¯èƒ½å°‘åœ°ä¸å…¶ä»–å®ä½“å‘ç”Ÿç›¸äº’ä½œç”¨</p>
<p>è¦æ±‚å½“ä¿®æ”¹ç³»ç»Ÿçš„æŸä¸€ä¸ªæ¨¡å—æ—¶ï¼Œè¦å°½é‡å°‘åœ°å½±å“å…¶ä»–æ¨¡å—ï¼Œä»è€Œä½¿ç±»ä¸ç±»ä¹‹é—´ä¿æŒæ¾æ•£çš„è€¦åˆå…³ç³»ï¼Œä½¿ç³»ç»Ÿæ‰©å±•ç›¸å¯¹å®¹æ˜“</p>
<p>â€œä¸è¦å’Œé™Œç”Ÿäººè¯´è¯ï¼Œåªä¸ä½ çš„ç›´æ¥æœ‹å‹é€šä¿¡â€ï¼š</p>
<ul>
<li>ä¸€ä¸ªå¯¹è±¡çš„æœ‹å‹åŒ…æ‹¬ï¼šthisï¼›ä»¥å‚æ•°å½¢å¼ä¼ å…¥åˆ°å½“å‰å¯¹è±¡æ–¹æ³•ä¸­çš„å¯¹è±¡ï¼›å½“å‰å¯¹è±¡çš„æˆå‘˜å¯¹è±¡ï¼›å¦‚æœå½“å‰å¯¹è±¡çš„æˆå‘˜å¯¹è±¡æ˜¯ä¸€ä¸ªé›†åˆï¼Œé‚£ä¹ˆé›†åˆä¸­çš„å…ƒç´ ä¹Ÿéƒ½æ˜¯æœ‹å‹ï¼›å½“å‰å¯¹è±¡æ‰€åˆ›å»ºçš„å¯¹è±¡</li>
<li>å¦‚æœä¸¤ä¸ªå¯¹è±¡ä¹‹é—´ä¸å¿…å½¼æ­¤ç›´æ¥é€šä¿¡ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå¯¹è±¡å°±ä¸åº”å½“å‘ç”Ÿä»»ä½•ç›´æ¥çš„ç›¸äº’ä½œç”¨ï¼Œå¦‚æœå…¶ä¸­çš„ä¸€ä¸ªå¯¹è±¡éœ€è¦è°ƒç”¨å¦ä¸€ä¸ªå¯¹è±¡çš„æŸä¸€ä¸ªæ–¹æ³•çš„è¯ï¼Œå¯ä»¥é€šè¿‡å¼•å…¥ä¸€ä¸ªåˆç†çš„ç¬¬ä¸‰è€…è½¬å‘è¿™ä¸ªè°ƒç”¨</li>
<li>åˆ’åˆ†ä¸Šï¼šåº”å½“å°½é‡åˆ›å»ºæ¾è€¦åˆçš„ç±»</li>
<li>ç»“æ„è®¾è®¡ä¸Šï¼šæ¯ä¸€ä¸ªç±»éƒ½åº”å½“å°½é‡é™ä½å…¶æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°çš„è®¿é—®æƒé™</li>
<li>è®¾è®¡ä¸Šï¼šåªè¦æœ‰å¯èƒ½ï¼Œä¸€ä¸ªç±»å‹åº”å½“è®¾è®¡æˆä¸å˜ç±»</li>
<li>å¯¹å…¶ä»–ç±»çš„å¼•ç”¨ä¸Šï¼šä¸€ä¸ªå¯¹è±¡å¯¹å…¶ä»–å¯¹è±¡çš„å¼•ç”¨åº”å½“é™åˆ°æœ€ä½</li>
</ul>
<h3 id="ç»„åˆå¤ç”¨åŸåˆ™"><a href="#ç»„åˆå¤ç”¨åŸåˆ™" class="headerlink" title="ç»„åˆå¤ç”¨åŸåˆ™"></a>ç»„åˆå¤ç”¨åŸåˆ™</h3><p>åœ¨è½¯ä»¶è®¾è®¡ä¸­ï¼Œå°½é‡ä½¿ç”¨ç»„åˆ&#x2F;èšåˆï¼ˆhas-aï¼‰è€Œä¸æ˜¯ç»§æ‰¿ï¼ˆis-aï¼‰è¾¾åˆ°ä»£ç å¤ç”¨çš„ç›®çš„</p>
<p>å› ä¸ºç»§æ‰¿ä½¿å¾—åŸºç±»ä¸å­ç±»æœ‰è¾ƒå¼ºçš„è€¦åˆæ€§ï¼Œé€šå¸¸æƒ…å†µä¸‹åŸºç±»çš„å†…éƒ¨ç»†èŠ‚å¯¹å­ç±»æ¥è¯´æ˜¯å¯è§çš„ï¼Œè¿™æ ·åŸºç±»çš„å®ç°ç»†èŠ‚ä¼šæš´éœ²ç»™å­ç±»ï¼Œç ´åäº†ç³»ç»Ÿçš„å°è£…æ€§</p>
<h2 id="åˆ›å»ºå‹æ¨¡å¼"><a href="#åˆ›å»ºå‹æ¨¡å¼" class="headerlink" title="åˆ›å»ºå‹æ¨¡å¼"></a>åˆ›å»ºå‹æ¨¡å¼</h2><p>å¯¹ç±»çš„å®ä¾‹åŒ–è¿‡ç¨‹è¿›è¡ŒæŠ½è±¡ï¼Œå°†å¯¹è±¡çš„åˆ›å»ºå’Œå¯¹è±¡çš„ä½¿ç”¨åˆ†ç¦»</p>
<p>å¤–ç•Œå¯¹äºè¿™äº›å¯¹è±¡åªéœ€è¦çŸ¥é“å®ƒä»¬å…±åŒçš„æ¥å£ï¼Œè€Œä¸æ¸…æ¥šå…·ä½“çš„å®ç°ç»†èŠ‚ï¼Œä½¿å¾—æ•´ä¸ªç³»ç»Ÿçš„è®¾è®¡æ›´åŠ ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™</p>
<h3 id="ç®€å•å·¥å‚æ¨¡å¼"><a href="#ç®€å•å·¥å‚æ¨¡å¼" class="headerlink" title="ç®€å•å·¥å‚æ¨¡å¼"></a>ç®€å•å·¥å‚æ¨¡å¼</h3><p>ä¸“é—¨å®šä¹‰ä¸€ä¸ªå·¥å‚ç±»ï¼Œé€šè¿‡ä¼ å…¥çš„å‚æ•°ä¸åŒè¿”å›ä¸åŒç±»çš„å®ä¾‹ï¼ˆè¢«åˆ›å»ºçš„å®ä¾‹é€šå¸¸éƒ½å…·æœ‰å…±åŒçš„çˆ¶ç±»ï¼‰</p>
<p><img src="https://design-patterns.readthedocs.io/zh_CN/latest/_images/SimpleFactory.jpg" alt="../_images/SimpleFactory.jpg"></p>
<p><strong>è§’è‰²ï¼š</strong></p>
<ul>
<li>Factory å·¥å‚ï¼šè´Ÿè´£å®ç°åˆ›å»ºæ‰€æœ‰å®ä¾‹çš„å†…éƒ¨é€»è¾‘</li>
<li>Product æŠ½è±¡äº§å“ï¼šæ‰€åˆ›å»ºçš„æ‰€æœ‰å¯¹è±¡çš„çˆ¶ç±»ï¼Œè´Ÿè´£æè¿°æ‰€æœ‰å®ä¾‹æ‰€å…±æœ‰çš„å…¬å…±æ¥å£</li>
<li>ConcreteProduct å…·ä½“äº§å“è§’è‰²ï¼šåˆ›å»ºç›®æ ‡ï¼Œæ‰€æœ‰åˆ›å»ºçš„å¯¹è±¡éƒ½å……å½“è¿™ä¸ªè§’è‰²çš„æŸä¸ªå…·ä½“ç±»çš„å®ä¾‹</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Factory</span> &#123;</span><br><span class="line">    <span class="title function_">createProduct</span>(<span class="params">proname</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (proname === <span class="string">&#x27;A&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ConcreteProductA</span>()</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (proname === <span class="string">&#x27;B&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ConcreteProductB</span>() </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li><p>è¦ç‚¹ï¼šå½“ä½ éœ€è¦ä»€ä¹ˆï¼Œåªéœ€è¦ä¼ å…¥ä¸€ä¸ªæ­£ç¡®çš„å‚æ•°ï¼Œå°±å¯ä»¥è·å–ä½ æ‰€éœ€è¦çš„å¯¹è±¡ï¼Œè€Œæ— éœ€çŸ¥é“å…¶åˆ›å»ºç»†èŠ‚</p>
</li>
<li><p>ä¼˜ç‚¹ï¼šå°†å¯¹è±¡çš„åˆ›å»ºå’Œå¯¹è±¡æœ¬èº«ä¸šåŠ¡å¤„ç†åˆ†ç¦»ï¼Œå°†å¯¹è±¡çš„åˆ›å»ºäº¤ç»™ä¸“é—¨çš„å·¥å‚ç±»è´Ÿè´£</p>
</li>
<li><p>æœ€å¤§çš„é—®é¢˜ï¼šå·¥å‚ç±»çš„èŒè´£ç›¸å¯¹è¿‡é‡ï¼Œå¢åŠ æ–°çš„äº§å“éœ€è¦ä¿®æ”¹å·¥å‚ç±»çš„åˆ¤æ–­é€»è¾‘ï¼Œè¿™ä¸€ç‚¹ä¸å¼€é—­åŸåˆ™ç›¸è¿èƒŒï¼›è€Œä¸”äº§å“è¾ƒå¤šæ—¶å·¥å‚æ–¹æ³•ä»£ç å°†ä¼šéå¸¸å¤æ‚</p>
</li>
<li><p>é€‚ç”¨æƒ…å†µï¼šå·¥å‚ç±»è´Ÿè´£åˆ›å»ºçš„å¯¹è±¡æ¯”è¾ƒå°‘ï¼›å®¢æˆ·ç«¯åªéœ€çŸ¥é“ä¼ å…¥å·¥å‚ç±»çš„å‚æ•°ï¼Œå¯¹äºå¦‚ä½•åˆ›å»ºå¯¹è±¡ä¸å…³å¿ƒ</p>
<p>ï¼ˆå®é™…æ“ä½œä¸­è¿˜å¯ä»¥æŠŠè°ƒç”¨æ—¶ä¼ å…¥çš„å‚æ•°å­˜åœ¨ xml ç­‰é…ç½®æ–‡ä»¶ä¸­ï¼Œä¿®æ”¹å‚æ•°æ—¶æ— éœ€ä¿®æ”¹ä»»ä½•æºä»£ç ï¼‰</p>
</li>
</ul>
<h3 id="å·¥å‚æ–¹æ³•æ¨¡å¼"><a href="#å·¥å‚æ–¹æ³•æ¨¡å¼" class="headerlink" title="å·¥å‚æ–¹æ³•æ¨¡å¼"></a>å·¥å‚æ–¹æ³•æ¨¡å¼</h3><p>å¯¹ä¸Šè¿°ç®€å•å·¥å‚æ¨¡å¼è¿›è¡Œä¿®æ”¹ï¼Œä¸å†è®¾è®¡ä¸€ä¸ªå·¥å‚ç±»è´Ÿè´£<em>æ‰€æœ‰</em>äº§å“çš„åˆ›å»ºï¼Œè€Œæ˜¯å°†å…·ä½“äº§å“çš„åˆ›å»ºè¿‡ç¨‹äº¤ç»™ä¸“é—¨çš„å·¥å‚å­ç±»å»å®Œæˆã€‚</p>
<p>å³ï¼Œå…ˆå®šä¹‰ä¸€ä¸ªæŠ½è±¡çš„å·¥å‚ç±»ï¼Œå†å®šä¹‰å…·ä½“çš„å·¥å‚å­ç±»ç”Ÿæˆå…·ä½“çš„äº§å“</p>
<p>è¿™ç§æŠ½è±¡åŒ–çš„ç»“æœä½¿è¿™ç§ç»“æ„å¯ä»¥åœ¨ä¸ä¿®æ”¹ç°æœ‰æŠ½è±¡&#x2F;å…·ä½“å·¥å‚ç±»çš„æƒ…å†µä¸‹å¼•è¿›æ–°çš„äº§å“ï¼Œåªéœ€ä¸ºæ–°äº§å“æ–°å»ºä¸€ä¸ªå…·ä½“å·¥å‚ç±»</p>
<p>æ›´ç¬¦åˆå¼€é—­åŸåˆ™</p>
<p><img src="https://design-patterns.readthedocs.io/zh_CN/latest/_images/FactoryMethod.jpg" alt="../_images/FactoryMethod.jpg"></p>
<p><strong>è§’è‰²ï¼š</strong></p>
<ul>
<li>Product æŠ½è±¡äº§å“</li>
<li>ConcreteProduct å…·ä½“äº§å“</li>
<li>Factory æŠ½è±¡å·¥å‚</li>
<li>ConcreteFactory å…·ä½“å·¥å‚</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteFactory</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Factory</span>&#123;</span><br><span class="line">    <span class="title function_">factoryMethod</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ConcreteProduct</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>åŸºäºå·¥å‚è§’è‰²å’Œäº§å“è§’è‰²çš„å¤šæ€æ€§è®¾è®¡ï¼Œä½¿å·¥å‚å¯ä»¥è‡ªä¸»ç¡®å®šåˆ›å»ºä½•ç§äº§å“å¯¹è±¡ï¼Œè€Œå¦‚ä½•åˆ›å»ºè¿™ä¸ªå¯¹è±¡çš„ç»†èŠ‚åˆ™å®Œå…¨å°è£…åœ¨å…·ä½“å·¥å‚å†…éƒ¨ã€‚åˆè¢«ç§°ä¸ºå¤šæ€å·¥å‚æ¨¡å¼ï¼Œå› ä¸ºæ‰€æœ‰çš„å…·ä½“å·¥å‚ç±»éƒ½å…·æœ‰åŒä¸€æŠ½è±¡çˆ¶ç±»</li>
<li>ä¼˜ç‚¹ï¼šç¬¦åˆå¼€é—­åŸåˆ™ï¼Œç³»ç»Ÿä¸­åŠ å…¥æ–°äº§å“æ—¶æ— éœ€ä¿®æ”¹æŠ½è±¡å·¥å‚å’ŒæŠ½è±¡äº§å“&#x2F;å®¢æˆ·ç«¯&#x2F;å…¶ä»–çš„å…·ä½“å·¥å‚å’Œå…·ä½“äº§å“ï¼Œåªéœ€æ–°å¢ä¸€ä¸ªå…·ä½“å·¥å‚å’Œå…·ä½“äº§å“</li>
<li>ç¼ºç‚¹ï¼šç³»ç»Ÿä¸­ç±»çš„æ•°é‡ä¼šæ¯”è¾ƒå¤šï¼Œå¢åŠ äº†ç³»ç»Ÿå¤æ‚åº¦ï¼›å¼•å…¥æŠ½è±¡å±‚å¢åŠ äº†ç†è§£éš¾åº¦</li>
<li>é€‚ç”¨æƒ…å†µï¼š<ul>
<li>ä¸€ä¸ªç±»ä¸çŸ¥é“å®ƒæ‰€éœ€è¦çš„å¯¹è±¡çš„ç±»ï¼Œåªéœ€çŸ¥é“åˆ›å»ºå…·ä½“äº§å“çš„å·¥å‚ç±»</li>
<li>ä¸€ä¸ªç±»é€šè¿‡å…¶å­ç±»æ¥æŒ‡å®šåˆ›å»ºå“ªä¸ªå¯¹è±¡ï¼Œç¬¦åˆå¤šæ€æ€§å’Œé‡Œå¼æ›¿æ¢åŸåˆ™</li>
<li>å®¢æˆ·ç«¯åœ¨ä½¿ç”¨æ—¶å¯ä»¥æ— éœ€å…³å¿ƒæ˜¯å“ªä¸€ä¸ªå·¥å‚å­ç±»åˆ›å»ºäº§å“å­ç±»ï¼Œéœ€è¦æ—¶å†åŠ¨æ€æŒ‡å®š</li>
</ul>
</li>
</ul>
<h3 id="æŠ½è±¡å·¥å‚æ¨¡å¼"><a href="#æŠ½è±¡å·¥å‚æ¨¡å¼" class="headerlink" title="æŠ½è±¡å·¥å‚æ¨¡å¼"></a>æŠ½è±¡å·¥å‚æ¨¡å¼</h3><blockquote>
<p>äº§å“ç­‰çº§ç»“æ„ï¼šäº§å“çš„ç»§æ‰¿ç»“æ„</p>
<p>äº§å“æ—ï¼šç”±åŒä¸€ä¸ªå·¥å‚ç”Ÿäº§çš„ï¼Œä½äºä¸åŒäº§å“ç­‰çº§ç»“æ„ä¸­çš„ä¸€ç»„äº§å“</p>
</blockquote>
<p>å½“ç³»ç»Ÿæ‰€æä¾›çš„å·¥å‚æ‰€éœ€ç”Ÿäº§çš„å…·ä½“äº§å“å¹¶ä¸æ˜¯ä¸€ä¸ªç®€å•çš„å¯¹è±¡ï¼Œè€Œæ˜¯å¤šä¸ªä½äºä¸åŒäº§å“ç­‰çº§ç»“æ„ä¸­å±äºä¸åŒç±»å‹çš„å…·ä½“äº§å“æ—¶éœ€è¦ä½¿ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼</p>
<p>å·¥å‚æ–¹æ³•æ¨¡å¼é’ˆå¯¹çš„æ˜¯ä¸€ä¸ªäº§å“ç­‰çº§ç»“æ„ï¼Œè€ŒæŠ½è±¡å·¥å‚æ¨¡å¼åˆ™éœ€è¦é¢å¯¹å¤šä¸ªäº§å“ç­‰çº§ç»“æ„</p>
<p><img src="https://design-patterns.readthedocs.io/zh_CN/latest/_images/AbatractFactory.jpg" alt="../_images/AbatractFactory.jpg"></p>
<p><strong>è§’è‰²ï¼š</strong></p>
<ul>
<li>Product å…·ä½“äº§å“</li>
<li>AbstractProduct æŠ½è±¡äº§å“</li>
<li>ConcreteFactory å…·ä½“å·¥å‚</li>
<li>AbstractFactory æŠ½è±¡å·¥å‚</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteFactory1</span> <span class="keyword">extends</span> <span class="title class_ inherited__">AbstractFactory</span> &#123;</span><br><span class="line">    <span class="title function_">createProductA</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ProductA1</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">createProductB</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ProductB1</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteFactory2</span> <span class="keyword">extends</span> <span class="title class_ inherited__">AbstractFactory</span> &#123;</span><br><span class="line">    <span class="title function_">createProductA</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ProductA2</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">createProductB</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ProductB2</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ï¼ˆA&#x2F;Bä»£è¡¨ä¸€ä¸ªäº§å“æ—ï¼ŒæŠ½è±¡å·¥å‚å¯ä»¥å¤„ç†å¤šä¸ªäº§å“æ—ï¼Œè€Œå·¥å‚æ–¹æ³•åªèƒ½å¤„ç†ä¸€ä¸ªäº§å“æ—ï¼‰</p>
<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>ä¼˜ç‚¹ï¼šéš”ç¦»äº†å…·ä½“ç±»çš„ç”Ÿæˆï¼Œä½¿å¾—å®¢æˆ·å¹¶ä¸éœ€è¦çŸ¥é“ä»€ä¹ˆè¢«åˆ›å»ºï¼›æ¯æ¬¡å¯ä»¥é€šè¿‡å…·ä½“å·¥å‚ç±»åˆ›å»ºä¸€ä¸ªäº§å“æ—ä¸­çš„å¤šä¸ªå¯¹è±¡ï¼Œå¢åŠ æˆ–æ›¿æ¢äº§å“æ—æ¯”è¾ƒæ–¹ä¾¿</li>
<li>ç¼ºç‚¹ï¼šå¢åŠ æ–°çš„äº§å“ç­‰çº§ç»“æ„å¾ˆå¤æ‚ï¼Œéœ€è¦ä¿®æ”¹æŠ½è±¡å·¥å‚å’Œæ‰€æœ‰çš„å…·ä½“å·¥å‚ç±»ï¼Œå¯¹å¼€é—­åŸåˆ™çš„æ”¯æŒå‘ˆç°å€¾æ–œæ€§ï¼ˆå³å¢åŠ æ–°çš„äº§å“æ—æ¯”è¾ƒæ–¹ä¾¿ï¼Œä½†å¢åŠ æ–°çš„äº§å“ç­‰çº§ç»“æ„å¾ˆå¤æ‚ï¼‰</li>
<li>é€‚ç”¨æƒ…å†µï¼š<ul>
<li>ç³»ç»Ÿä¸­æœ‰å¤šä¸ªäº§å“æ—ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­æŸä¸€æ—ï¼›</li>
<li>å±äºåŒä¸€ä¸ªäº§å“æ—çš„äº§å“å°†åœ¨ä¸€èµ·ä½¿ç”¨ï¼›</li>
<li>ç³»ç»Ÿæä¾›ä¸€ä¸ªäº§å“ç±»çš„åº“ï¼Œæ‰€æœ‰çš„äº§å“ä»¥åŒæ ·çš„æ¥å£å‡ºç°ï¼Œä»è€Œä½¿å®¢æˆ·ç«¯ä¸ä¾èµ–äºå…·ä½“å®ç°</li>
</ul>
</li>
</ul>
<h3 id="å»ºé€ è€…æ¨¡å¼"><a href="#å»ºé€ è€…æ¨¡å¼" class="headerlink" title="å»ºé€ è€…æ¨¡å¼"></a>å»ºé€ è€…æ¨¡å¼</h3><p>å¤æ‚å¯¹è±¡ï¼ˆæ±½è½¦ï¼‰ï¼Œæœ‰å¾ˆå¤šå±æ€§ï¼ˆæ±½è½¦éƒ¨ä»¶ ï¼‰ï¼Œå¯¹äºç”¨æˆ·è€Œè¨€æ— éœ€çŸ¥é“è¿™äº›ç»†èŠ‚ï¼Œåªæƒ³ä½¿ç”¨ä¸€è¾†å®Œæ•´æ±½è½¦ï¼Œå› æ­¤å°†å»ºé€ ï¼ˆç»„åˆéƒ¨ä»¶ï¼‰è¿‡ç¨‹å¤–éƒ¨åŒ–åˆ°ä¸€ä¸ªç§°ä½œå»ºé€ è€…çš„å¯¹è±¡ä¸­</p>
<p>ç”¨æˆ·åªéœ€æŒ‡å®šå¤æ‚å¯¹è±¡çš„ç±»å‹å’Œå†…å®¹å°±å¯ä»¥æ„å»ºå®ƒä»¬ï¼Œä¸éœ€è¦çŸ¥é“å†…éƒ¨çš„å…·ä½“æ„å»ºç»†èŠ‚</p>
<p><img src="https://design-patterns.readthedocs.io/zh_CN/latest/_images/Builder.jpg" alt="../_images/Builder.jpg"></p>
<p><strong>è§’è‰²ï¼š</strong></p>
<ul>
<li>Builder æŠ½è±¡å»ºé€ è€…ï¼šå®šä¹‰äº§å“çš„åˆ›å»ºæ–¹æ³•å’Œè¿”å›æ–¹æ³•</li>
<li>ConcreteBuilder å…·ä½“å»ºé€ è€…</li>
<li>Director æŒ‡æŒ¥è€…ï¼šéš”ç¦»å®¢æˆ·ä¸ç”Ÿäº§è¿‡ç¨‹ï¼Œæ§åˆ¶äº§å“çš„ç”Ÿæˆè¿‡ç¨‹ã€‚æŒ‡æŒ¥è€…é’ˆå¯¹æŠ½è±¡å»ºé€ è€…ç¼–ç¨‹ï¼Œå®¢æˆ·åªéœ€è¦çŸ¥é“å…·ä½“å»ºé€ è€…çš„ç±»å‹ï¼Œå³å¯é€šè¿‡æŒ‡æŒ¥è€…è°ƒç”¨å»ºé€ è€…çš„ç›¸å…³æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªå®Œæ•´çš„äº§å“å¯¹è±¡</li>
<li>Product äº§å“</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteBuilder</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Builder</span> &#123;</span><br><span class="line">    <span class="title function_">buildPartA</span>(<span class="params"></span>) &#123;</span><br><span class="line">        m_prod.<span class="title function_">setA</span>(<span class="string">&quot;A Style &quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">buildPartB</span>(<span class="params"></span>) &#123;</span><br><span class="line">        m_prod.<span class="title function_">setB</span>(<span class="string">&quot;B Style &quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">buildPartC</span>(<span class="params"></span>) &#123;</span><br><span class="line">        m_prod.<span class="title function_">setC</span>(<span class="string">&quot;C Style &quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Diector</span> &#123;</span><br><span class="line">    <span class="title function_">construct</span>(<span class="params"></span>) &#123;</span><br><span class="line">        m_pbuilder.<span class="title function_">buildPartA</span>()</span><br><span class="line">        m_pbuilder.<span class="title function_">buildPartB</span>()</span><br><span class="line">        m_pbuilder.<span class="title function_">buildPartC</span>()</span><br><span class="line">        <span class="keyword">return</span> m_pbuilder.<span class="title function_">getResult</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">setBuilder</span>(<span class="params">builder</span>) &#123;</span><br><span class="line">        m_pbuilder = builder</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”¨æˆ·è°ƒç”¨</span></span><br><span class="line"><span class="keyword">const</span> builder = <span class="keyword">new</span> <span class="title class_">ConcreteBuilder</span>()</span><br><span class="line"><span class="keyword">const</span> director = <span class="keyword">new</span> <span class="title class_">Diector</span>()</span><br><span class="line">director.<span class="title function_">setBuilder</span>(builder)</span><br><span class="line"><span class="keyword">const</span> product = director.<span class="title function_">construct</span>()</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li><p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>å°†äº§å“æœ¬èº«ä¸äº§å“çš„åˆ›å»ºè¿‡ç¨‹è§£è€¦ï¼Œä½¿å¾—ç›¸åŒçš„åˆ›å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„äº§å“å¯¹è±¡ï¼›</li>
<li>å…·ä½“å»ºé€ è€…ä¹‹é—´ç›¸å¯¹ç‹¬ç«‹ï¼Œç”¨æˆ·ä½¿ç”¨ä¸åŒçš„å…·ä½“å»ºé€ è€…å³å¯å¾—åˆ°ä¸åŒçš„äº§å“å¯¹è±¡ï¼›</li>
<li>å¯ä»¥æ›´åŠ ç²¾ç»†åœ°æ§åˆ¶äº§å“çš„åˆ›å»ºè¿‡ç¨‹ï¼›</li>
<li>å¢åŠ æ–°çš„å…·ä½“å»ºé€ è€…æ— éœ€ä¿®æ”¹åŸæœ‰ç±»åº“çš„ä»£ç ï¼ŒæŒ‡æŒ¥è€…ç±»é’ˆå¯¹çš„æ˜¯æŠ½è±¡å»ºé€ è€…ç¼–ç¨‹ï¼Œç¬¦åˆå¼€é—­åŸåˆ™</li>
</ul>
</li>
<li><p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>å»ºé€ è€…æ¨¡å¼é€‚ç”¨äºäº§å“æ¯”è¾ƒç›¸ä¼¼çš„æƒ…å†µï¼Œäº§å“ä¹‹é—´çš„å·®å¼‚æ€§å¾ˆå¤§æ—¶ä¸é€‚åˆä½¿ç”¨å»ºé€ è€…æ¨¡å¼ï¼›</li>
<li>å¦‚æœäº§å“å†…éƒ¨å˜åŒ–å¤æ‚ï¼Œå¯èƒ½ä¼šå¯¼è‡´éœ€è¦å®šä¹‰å¾ˆå¤šå…·ä½“å»ºé€ è€…æ¥å®ç°è¿™ç§å˜åŒ–ï¼Œå¯¼è‡´ç³»ç»Ÿå˜å¾—å¾ˆåºå¤§</li>
</ul>
</li>
<li><p>é€‚ç”¨ç¯å¢ƒï¼š</p>
<ul>
<li>éœ€è¦ç”Ÿæˆçš„äº§å“å¯¹è±¡æœ‰å¤æ‚çš„å†…éƒ¨ç»“æ„ï¼Œé€šå¸¸åŒ…å«å¤šä¸ªæˆå‘˜å±æ€§ï¼›</li>
<li>éœ€è¦ç”Ÿæˆçš„äº§å“å¯¹è±¡çš„å±æ€§ç›¸äº’ä¾èµ–ï¼Œéœ€è¦æŒ‡å®šå…¶ç”Ÿæˆé¡ºåºï¼›</li>
<li>å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ç‹¬ç«‹äºåˆ›å»ºè¯¥å¯¹è±¡çš„ç±»ï¼Œå¼•å…¥æŒ‡æŒ¥è€…ï¼›</li>
<li>éš”ç¦»å¤æ‚å¯¹è±¡çš„åˆ›å»ºå’Œä½¿ç”¨ï¼Œå¹¶ä½¿å¾—ç›¸åŒçš„åˆ›å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„äº§å“</li>
</ul>
</li>
<li><p>ç®€åŒ–ï¼šå¦‚æœç³»ç»Ÿä¸­åªéœ€ä¸€ä¸ªå…·ä½“å»ºé€ è€…æ—¶ï¼Œå¯çœç•¥æŠ½è±¡å»ºé€ è€…ï¼Œçœç•¥æŒ‡æŒ¥è€…</p>
</li>
<li><p>ä¸æŠ½è±¡å·¥å‚æ¨¡å¼æ¯”è¾ƒï¼š</p>
<ul>
<li>å»ºé€ è€…æ¨¡å¼è¿”å›ä¸€ä¸ªç»„è£…å¥½çš„å®Œæˆäº§å“ï¼Œè€ŒæŠ½è±¡å·¥å‚æ¨¡å¼è¿”å›ä¸€ç³»åˆ—ç›¸å…³çš„äº§å“ï¼ˆäº§å“æ—ï¼‰ï¼›</li>
<li>æŠ½è±¡å·¥å‚ä¸­å®¢æˆ·ç«¯éœ€è¦å®ä¾‹åŒ–å·¥å‚ç±»ç„¶åè°ƒç”¨å·¥å‚æ–¹æ³•å–å¾—æ‰€éœ€å¯¹è±¡ï¼Œå»ºé€ è€…æ¨¡å¼å¯ä»¥ä¸è°ƒç”¨å»ºé€ è€…çš„ç›¸å…³æ–¹æ³•ï¼Œè€Œæ˜¯é€šè¿‡æŒ‡æŒ¥è€…ç±»ï¼›</li>
<li>æŠ½è±¡å·¥å‚æ¨¡å¼ï¼šæ±½è½¦é…ä»¶ç”Ÿäº§å·¥å‚ï¼Œç”Ÿäº§ä¸€ä¸ªäº§å“æ—çš„äº§å“ï¼›å»ºé€ è€…æ¨¡å¼ï¼šæ±½è½¦ç»„è£…å·¥å‚ï¼Œè¿”å›ä¸€è¾†å®Œæ•´çš„æ±½è½¦</li>
</ul>
</li>
</ul>
<h3 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h3><p>ä¿è¯ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹å¹¶ä¸”è¿™ä¸ªå®ä¾‹æ˜“äºè¢«è®¿é—®ï¼šè®©ç±»è‡ªèº«è´Ÿè´£ä¿å­˜å®ƒçš„å”¯ä¸€å®ä¾‹ï¼Œè¿™ä¸ªç±»å¯ä»¥ä¿è¯æ²¡æœ‰å…¶ä»–å®ä¾‹è¢«åˆ›å»ºï¼Œå¹¶ä¸”å®ƒå¯ä»¥æä¾›ä¸€ä¸ªè®¿é—®è¯¥å®ä¾‹çš„æ–¹æ³•</p>
<p>è¦ç‚¹ï¼šæŸä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹ï¼›å®ƒå¿…é¡»è‡ªè¡Œåˆ›å»ºè¿™ä¸ªå®ä¾‹ï¼›å®ƒå¿…é¡»è‡ªè¡Œå‘æ•´ä¸ªç³»ç»Ÿæä¾›è¿™ä¸ªå®ä¾‹</p>
<p><img src="https://design-patterns.readthedocs.io/zh_CN/latest/_images/Singleton.jpg" alt="../_images/Singleton.jpg"></p>
<p><strong>è§’è‰²ï¼š</strong></p>
<ul>
<li>Singleton å•ä¾‹</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ€ç®€å•çš„å•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="keyword">let</span> timeTool = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;å¤„ç†æ—¶é—´å·¥å…·åº“&#x27;</span>,</span><br><span class="line">    <span class="attr">getISODate</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">getUTCDate</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€ç®€å•çš„å•ä¾‹æ¨¡å¼å®ç°ï¼Œç”¨ js çš„å¯¹è±¡å­—é¢é‡å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œå› ä¸º let ä¸å…è®¸é‡å¤å£°æ˜æ‰€ä»¥ <code>timeTool</code> ä¸èƒ½è¢«é‡æ–°è¦†ç›–</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æƒ°æ€§å•ä¾‹</span></span><br><span class="line"><span class="comment">// åªåœ¨éœ€è¦çš„æ—¶å€™è¿›è¡Œå•ä¾‹çš„åˆ›å»º</span></span><br><span class="line"><span class="comment">// å¦‚æœå†æ¬¡è°ƒç”¨ï¼Œè¿”å›çš„æ°¸è¿œæ˜¯ç¬¬ä¸€æ¬¡å®ä¾‹åŒ–çš„å•ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="keyword">let</span> timeTool = (<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> _instance = <span class="literal">null</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">init</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// ç§æœ‰å˜é‡</span></span><br><span class="line">        <span class="keyword">let</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line">        <span class="comment">// å…¬ç”¨å±æ€§å’Œæ–¹æ³•</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&#x27;å¤„ç†æ—¶é—´å·¥å…·åº“&#x27;</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">getISODate</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> now.<span class="title function_">toISOString</span>()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">getUTCDate</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> now.<span class="title function_">toUTCString</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!_instance) &#123;</span><br><span class="line">            _instance = <span class="keyword">new</span> <span class="title function_">init</span>()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> _instance</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// singleton in es6</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SingletonApple</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">name, creator, products</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">creator</span> = creator</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">products</span> = products</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="title function_">getInstance</span>(<span class="params">name, creator, products</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">instance</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">instance</span> = <span class="keyword">new</span> <span class="title class_">SingletonApple</span>(name, creator, products)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">instance</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>es6 çš„ export å‡ºçš„å®ä¾‹å³æ˜¯å•ä¾‹</p>
<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>ä¼˜ç‚¹ï¼šæä¾›äº†å¯¹å”¯ä¸€å®ä¾‹çš„å—æ§è®¿é—®å¹¶å¯ä»¥èŠ‚çº¦ç³»ç»Ÿèµ„æº</li>
<li>ç¼ºç‚¹ï¼šå› ä¸ºç¼ºå°‘æŠ½è±¡å±‚è€Œéš¾ä»¥æ‰©å±•ï¼Œä¸”å•ä¾‹ç±»èŒè´£è¿‡é‡</li>
</ul>
<h2 id="ç»“æ„å‹æ¨¡å¼"><a href="#ç»“æ„å‹æ¨¡å¼" class="headerlink" title="ç»“æ„å‹æ¨¡å¼"></a>ç»“æ„å‹æ¨¡å¼</h2><p>æè¿°å¦‚ä½•å°†ç±»æˆ–è€…å¯¹è±¡ç»“åˆåœ¨ä¸€èµ·å½¢æˆæ›´å¤§çš„ç»“æ„</p>
<p>åˆ†ä¸ºç±»ç»“æ„å‹æ¨¡å¼å’Œå¯¹è±¡ç»“æ„å‹æ¨¡å¼</p>
<ul>
<li>ç±»ç»“æ„å‹æ¨¡å¼ï¼šå…³å¿ƒç±»çš„ç»„åˆï¼Œç”±å¤šä¸ªç±»å¯ä»¥ç»„åˆæˆä¸€ä¸ªæ›´å¤§çš„ç³»ç»Ÿï¼Œåœ¨ç±»ç»“æ„å‹æ¨¡å¼ä¸­ä¸€èˆ¬åªå­˜åœ¨ç»§æ‰¿å…³ç³»å’Œå®ç°å…³ç³»</li>
<li>å¯¹è±¡ç»“æ„å‹æ¨¡å¼ï¼šå…³å¿ƒç±»ä¸å¯¹è±¡çš„ç»„åˆï¼Œé€šè¿‡å…³è”å…³ç³»ä½¿å¾—åœ¨ä¸€ä¸ªç±»ä¸­å®šä¹‰å¦ä¸€ä¸ªç±»çš„å®ä¾‹å¯¹è±¡ï¼Œç„¶åé€šè¿‡è¯¥å¯¹è±¡è°ƒç”¨å…¶æ–¹æ³•ã€‚ï¼ˆç»„åˆå¤ç”¨åŸåˆ™ï¼šåœ¨ç³»ç»Ÿä¸­åº”å°½é‡ä½¿ç”¨å…³è”å…³ç³»æ¥æ›¿ä»£ç»§æ‰¿å…³ç³»ï¼‰</li>
</ul>
<h3 id="é€‚é…å™¨æ¨¡å¼"><a href="#é€‚é…å™¨æ¨¡å¼" class="headerlink" title="é€‚é…å™¨æ¨¡å¼"></a>é€‚é…å™¨æ¨¡å¼</h3><p>å°†ä¸€ä¸ªå€Ÿå£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦ä¸€ä¸ªæ¥å£ï¼ˆç°æœ‰çš„ç±»å¯ä»¥æ»¡è¶³å®¢æˆ·ç±»çš„åŠŸèƒ½éœ€è¦ï¼Œä½†æ¥å£ä¸ä¸€å®šæ˜¯å®¢æˆ·ç±»æ‰€æœŸæœ›çš„ï¼‰</p>
<p>é€‚é…å™¨çš„å®ç°å°±æ˜¯æŠŠå®¢æˆ·ç±»çš„è¯·æ±‚è½¬åŒ–ä¸ºå¯¹é€‚é…è€…çš„ç›¸åº”æ¥å£çš„è°ƒç”¨</p>
<p>å¯¹è±¡é€‚é…å™¨ï¼š</p>
<p><img src="https://design-patterns.readthedocs.io/zh_CN/latest/_images/Adapter.jpg" alt="../_images/Adapter.jpg"></p>
<p>ç±»é€‚é…å™¨ï¼š</p>
<p><img src="https://design-patterns.readthedocs.io/zh_CN/latest/_images/Adapter_classModel.jpg" alt="../_images/Adapter_classModel.jpg"></p>
<p><strong>è§’è‰²ï¼š</strong></p>
<ul>
<li>Target ç›®æ ‡æŠ½è±¡ç±»</li>
<li>Adapeter é€‚é…å™¨ç±»</li>
<li>Adaptee é€‚é…è€…ç±»ï¼ˆè¢«é€‚é…çš„åŸå¯¹è±¡ç±»ï¼‰</li>
<li>Client å®¢æˆ·ç±»</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Adapter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Target</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">adaptee</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_pAdaptee</span> = adaptee</span><br><span class="line">        <span class="comment">// å‡†ç¡®æ¥è¯´ï¼Œè¿™ä¸ª m_pAdaptee åº”å½“å®šä¹‰ä¸ºç§æœ‰å˜é‡</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">request</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_pAdaptee</span>.<span class="title function_">specificRequest</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li><p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>å°†ç›®æ ‡ç±»å’Œé€‚é…è€…ç±»è§£è€¦ï¼Œé€šè¿‡å¼•å…¥ä¸€ä¸ªé€‚é…å™¨ç±»æ¥é‡ç”¨ç°æœ‰çš„é€‚é…è€…ç±»ï¼Œè€Œæ— éœ€ä¿®æ”¹åŸæœ‰ä»£ç </li>
<li>å¢åŠ äº†ç±»çš„é€æ˜æ€§å’Œå¤ç”¨æ€§ï¼Œå°†å…·ä½“çš„å®ç°å°è£…åœ¨é€‚é…è€…ç±»ä¸­ï¼Œå¯¹äºå®¢æˆ·ç«¯ç±»æ¥è¯´æ˜¯é€æ˜çš„ï¼Œè€Œä¸”æé«˜äº†é€‚é…è€…çš„å¤ç”¨æ€§</li>
<li>çµæ´»æ€§å’Œæ‰©å±•æ€§éƒ½éå¸¸å¥½ï¼Œé€šè¿‡ä½¿ç”¨é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ›´æ¢é€‚é…å™¨ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸ä¿®æ”¹åŸæœ‰ä»£ç çš„åŸºç¡€ä¸Šå¢åŠ æ–°çš„é€‚é…å™¨ç±»ï¼Œå®Œå…¨ç¬¦åˆâ€œå¼€é—­åŸåˆ™â€</li>
<li>ç±»é€‚é…å™¨ï¼šå› ä¸ºé€‚é…å™¨æ˜¯é€‚é…è€…ç±»çš„å­ç±»ï¼Œå› æ­¤å¯ä»¥åœ¨é€‚é…å™¨ç±»ä¸­ç½®æ¢ä¸€äº›é€‚é…è€…çš„æ–¹æ³•ï¼Œä½¿å¾—é€‚é…å™¨çš„çµæ´»æ€§æ›´å¼º</li>
<li>å¯¹è±¡é€‚é…å™¨ï¼šä¸€ä¸ªå¯¹è±¡é€‚é…å™¨å¯ä»¥æŠŠå¤šä¸ªä¸åŒçš„é€‚é…è€…é€‚é…åˆ°åŒä¸€ä¸ªç›®æ ‡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒä¸€ä¸ªé€‚é…å™¨å¯ä»¥æŠŠé€‚é…è€…ç±»å’Œå®ƒçš„å­ç±»éƒ½é€‚é…åˆ°ç›®æ ‡æ¥å£</li>
</ul>
</li>
<li><p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>ç±»é€‚é…å™¨ï¼šå¯¹äºä¸æ”¯æŒå¤šé‡ç»§æ‰¿çš„è¯­è¨€ï¼Œä¸€æ¬¡æœ€å¤šåªèƒ½é€‚é…ä¸€ä¸ªé€‚é…è€…ç±»ï¼Œè€Œä¸” Target åªèƒ½ä¸ºæŠ½è±¡ç±»ä¸èƒ½ä¸ºå…·ä½“ç±»ï¼Œå…¶ä½¿ç”¨æœ‰ä¸€å®šçš„å±€é™æ€§</li>
<li>å¯¹è±¡é€‚é…å™¨ï¼šæƒ³ç½®æ¢é€‚é…è€…ç±»çš„æ–¹æ³•ä¸å®¹æ˜“</li>
</ul>
</li>
<li><p>æ‰©å±•ï¼šé»˜è®¤é€‚é…å™¨æ¨¡å¼</p>
<p>å…ˆè®¾è®¡ä¸€ä¸ªæŠ½è±¡ç±»å®ç°æ¥å£ï¼Œå¹¶ä¸ºè¯¥æ¥å£ä¸­çš„æ¯ä¸ªæ–¹æ³•æä¾›ä¸€ä¸ªé»˜è®¤å®ç°ï¼ˆç©ºæ–¹æ³•ï¼‰ï¼Œé‚£ä¹ˆè¯¥æŠ½è±¡ç±»çš„å­ç±»å¯æœ‰é€‰æ‹©åœ°è¦†ç›–çˆ¶ç±»çš„æŸäº›æ–¹æ³•æ¥å®ç°éœ€æ±‚ï¼Œé€‚ç”¨äºä¸€ä¸ªæ¥å£ä¸æƒ³ä½¿ç”¨å…¶æ‰€æœ‰çš„æ–¹æ³•çš„æƒ…å†µ</p>
</li>
</ul>
<h3 id="æ¡¥æ¥æ¨¡å¼"><a href="#æ¡¥æ¥æ¨¡å¼" class="headerlink" title="æ¡¥æ¥æ¨¡å¼"></a>æ¡¥æ¥æ¨¡å¼</h3><p>å°†æŠ½è±¡éƒ¨åˆ†ä¸å®ƒçš„å®ç°éƒ¨åˆ†åˆ†ç¦»ï¼ˆç”±åŸæ¥çš„ç»§æ‰¿å…³ç³»æ”¹ä¸ºå…³è”å…³ç³»ï¼Œå¼ºå…³è”æ”¹ä¸ºå¼±å…³è”ï¼‰ï¼Œä½¿ä»–ä»¬éƒ½å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ–</p>
<p><img src="https://design-patterns.readthedocs.io/zh_CN/latest/_images/Bridge.jpg" alt="../_images/Bridge.jpg"></p>
<p><strong>è§’è‰²ï¼š</strong></p>
<ul>
<li>Abstraction æŠ½è±¡ç±»ï¼šå®šä¹‰ä¸€ä¸ªå®ç°ç±»æ¥å£ç±»å‹çš„å¯¹è±¡å¹¶å¯ä»¥ç»´æŠ¤è¯¥å¯¹è±¡</li>
<li>RefinedAbstraction æ‰©å……æŠ½è±¡ç±»ï¼šæ‰©å……æŠ½è±¡ç±»å®šä¹‰çš„æ¥å£ï¼Œå®ç°åœ¨æŠ½è±¡ç±»ä¸­å®šä¹‰çš„æŠ½è±¡ä¸šåŠ¡æ–¹æ³•</li>
<li>Implementor å®ç°ç±»æ¥å£ï¼šä»…æä¾›åŸºæœ¬æ“ä½œ</li>
<li>ConcreteImplementor å…·ä½“å®ç°ç±»ï¼šå®ç°äº†å®ç°ç±»çš„æ¥å£å¹¶å…·ä½“å®ç°å®ƒï¼Œåœ¨ä¸åŒçš„å…·ä½“å®ç°ç±»ä¸­æä¾›åŸºæœ¬æ“ä½œçš„ä¸åŒå®ç°</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç”±äº JavaScript ä¸æ”¯æŒæŠ½è±¡ç±»ï¼Œæ‰€ä»¥æ²¡æœ‰ Abstraction å’Œ Implementor</span></span><br><span class="line"><span class="comment">// ä¸‹é¢å®ç° RefinedAbstraction å’Œ ConcreteImplementor</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RefinedAbstraction</span> &#123;</span><br><span class="line">    <span class="title function_">constuctor</span>(<span class="params">imp</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_pImp</span> = imp</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">operation</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_pImp</span>.<span class="title function_">operationImp</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteImplementor</span> &#123;</span><br><span class="line">    <span class="title function_">operationImp</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// å…·ä½“å®ç°</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li><p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>æ¯”å¦‚æœ‰ä¸¤ä¸ªå˜åŒ–ç»´åº¦çš„ç³»ç»Ÿï¼Œé‡‡ç”¨æ¡¥æ¥æ¨¡å¼å¯ä»¥æé«˜å¯æ‰©å……æ€§ï¼ˆä»»æ„æ‰©å±•ä¸€ä¸ªç»´åº¦éƒ½ä¸éœ€è¦ä¿®æ”¹åŸæœ‰ç³»ç»Ÿï¼‰ï¼›</li>
<li>æœ‰æ—¶ç±»ä¼¼å¤šç»§æ‰¿ï¼Œä½†å¤šç»§æ‰¿æ–¹æ¡ˆè¿èƒŒäº†ç±»çš„å•ä¸€èŒè´£åŸåˆ™ï¼Œå¤ç”¨æ€§æ¯”è¾ƒå·®ï¼Œä¸”ç±»çš„ä¸ªæ•°éå¸¸åºå¤§</li>
</ul>
</li>
<li><p>ç¼ºç‚¹ï¼šå¢åŠ ç³»ç»Ÿçš„ç†è§£ä¸è®¾è®¡éš¾åº¦ï¼Œè¦æ±‚é’ˆå¯¹æŠ½è±¡è¿›è¡Œè®¾è®¡ä¸ç¼–ç¨‹</p>
</li>
<li><p>é€‚ç”¨ï¼š</p>
<ul>
<li>æŠ½è±¡åŒ–è§’è‰²å’Œå…·ä½“åŒ–è§’è‰²ä¹‹é—´å¢åŠ æ›´å¤šçš„çµæ´»æ€§ï¼Œé¿å…åœ¨ä¸¤ä¸ªå±‚æ¬¡ä¹‹é—´å»ºç«‹é™æ€çš„ç»§æ‰¿è”ç³»ï¼Œåˆ™å¯ä»¥ç”¨æ¡¥æ¥æ¨¡å¼ä½¿å®ƒä»¬åœ¨æŠ½è±¡å±‚å»ºç«‹ä¸€ä¸ªå…³è”å…³ç³»</li>
<li>ä¸€ä¸ªç±»å­˜åœ¨ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ï¼Œä¸”è¿™ä¸¤ä¸ªç»´åº¦éƒ½éœ€è¦è¿›è¡Œæ‰©å±•</li>
<li>ç³»ç»Ÿéœ€è¦å¯¹æŠ½è±¡åŒ–è§’è‰²å’Œå®ç°åŒ–è§’è‰²è¿›è¡ŒåŠ¨æ€è€¦åˆ</li>
</ul>
</li>
</ul>
<h3 id="è£…é¥°æ¨¡å¼"><a href="#è£…é¥°æ¨¡å¼" class="headerlink" title="è£…é¥°æ¨¡å¼"></a>è£…é¥°æ¨¡å¼</h3><p>åŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡å¢åŠ ä¸€äº›é¢å¤–çš„èŒè´£ï¼Œä¸éœ€è¦åˆ›é€ æ›´å¤šå­ç±»è€Œå°†å¯¹è±¡çš„åŠŸèƒ½åŠ ä»¥æ‰©å±•â€˜</p>
<p>æ–¹å¼ä¸é€‚é…å™¨æ¨¡å¼ç›¸åŒï¼ŒæŠŠç»§æ‰¿å…³ç³»å˜æˆå…³è”å…³ç³»</p>
<p><img src="https://design-patterns.readthedocs.io/zh_CN/latest/_images/Decorator.jpg" alt="../_images/Decorator.jpg"></p>
<p><strong>è§’è‰²ï¼š</strong></p>
<ul>
<li>Component æŠ½è±¡æ„ä»¶</li>
<li>ConcreteComponent å…·ä½“æ„ä»¶</li>
<li>Decorator æŠ½è±¡è£…é¥°ç±»</li>
<li>ConcreteDecorator å…·ä½“è£…é¥°ç±»</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteDecorator</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">component</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_pComponent</span> = component</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">addBehavior</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">//å¢åŠ æ–°è¡Œä¸º</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">operation</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_pComponent</span>.<span class="title function_">operation</span>()</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">addBehavior</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>ä¼˜ç‚¹ï¼šæ¯”ç»§æ‰¿æ›´çµæ´»ï¼Œå¯ä»¥é€šè¿‡ä¸åŒçš„è£…é¥°ç±»ä»¥åŠè¿™äº›è£…é¥°ç±»çš„æ’åˆ—ç»„åˆï¼Œå¾—åˆ°å¾ˆå¤šç§ä¸åŒè¡Œä¸ºçš„å¯¹è±¡ï¼›ä¿®æ”¹æ—¶åªéœ€å¢åŠ æ–°çš„ ConcreteComponent å’Œ ConcreteDecoratorï¼Œç¬¦åˆå¼€é—­åŸåˆ™</li>
<li>ç¼ºç‚¹ï¼šä¼šäº§ç”Ÿå¾ˆå¤šå°å¯¹è±¡ï¼Œä»–ä»¬ä¹‹é—´çš„åŒºåˆ«åœ¨äºç›¸äº’è¿æ¥çš„æ–¹å¼ä¸åŒï¼Œè€Œä¸æ˜¯å®ƒä»¬çš„ç±»æˆ–è€…å±æ€§å€¼ä¸åŒï¼Œå¢åŠ ç³»ç»Ÿå¤æ‚åº¦ï¼ŒåŠ å¤§ç†è§£éš¾åº¦ï¼›æ›´çµæ´»ä¹Ÿå°±æ›´å®¹æ˜“å‡ºé”™ï¼Œéš¾ä»¥æ’æŸ¥</li>
<li>ä½¿ç”¨æ—¶å°½é‡ä¿æŒ ConcreteComponent ä½œä¸ºä¸€ä¸ªè½»ç±»ï¼Œä¸è¦åŒ…å«å¤ªå¤šçš„é€»è¾‘å’ŒçŠ¶æ€ï¼Œè€Œæ˜¯é€šè¿‡è£…é¥°ç±»å¯¹å…¶è¿›è¡Œæ‰©å±•</li>
</ul>
<h3 id="å¤–è§‚æ¨¡å¼"><a href="#å¤–è§‚æ¨¡å¼" class="headerlink" title="å¤–è§‚æ¨¡å¼"></a>å¤–è§‚æ¨¡å¼</h3><p>å¤–éƒ¨ä¸ä¸€ä¸ªå­ç³»ç»Ÿçš„é€šä¿¡å¿…é¡»é€šè¿‡ä¸€ä¸ªç»Ÿä¸€çš„å¤–è§‚å¯¹è±¡è¿›è¡Œï¼Œä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›äº†ä¸€ä¸ªä¸€è‡´çš„ç•Œé¢ï¼Œå¤–è§‚æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä½¿å¾—è¿™ä¸€å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“ä½¿ç”¨</p>
<p><img src="https://design-patterns.readthedocs.io/zh_CN/latest/_images/Facade.jpg" alt="../_images/Facade.jpg"></p>
<p><strong>è§’è‰²ï¼š</strong></p>
<ul>
<li>Facade å¤–è§‚</li>
<li>SubSystem å­ç³»ç»Ÿ</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Facade</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_SystemA</span> = <span class="keyword">new</span> <span class="title class_">SystemA</span>()</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_SystemB</span> = <span class="keyword">new</span> <span class="title class_">SystemB</span>()</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_SystemC</span> = <span class="keyword">new</span> <span class="title class_">SystemC</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">wrapOpration</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_SystemA</span>.<span class="title function_">operationA</span>()</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_SystemB</span>.<span class="title function_">operationB</span>()</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_SystemC</span>.<span class="title function_">operationC</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>åˆ’åˆ†å­ç³»ç»Ÿç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ï¼Œè€Œä¸ºäº†ä½¿å­ç³»ç»Ÿé—´çš„é€šä¿¡å’Œç›¸äº’ä¾èµ–å…³ç³»è¾¾åˆ°æœ€å°ï¼Œå°±å¯ä»¥å¼•å…¥ä¸€ä¸ªå¤–è§‚å¯¹è±¡</li>
<li>æ˜¯è¿ªç±³ç‰¹æ³•åˆ™çš„ä½“ç°ï¼Œé™ä½åŸæœ‰ç³»ç»Ÿçš„å¤æ‚åº¦ï¼Œé™ä½å®¢æˆ·ç±»ä¸å­ç³»ç»Ÿç±»çš„è€¦åˆåº¦</li>
<li>ä¼˜ç‚¹ï¼š<ul>
<li>å¯¹å®¢æˆ·å±è”½å­ç³»ç»Ÿç»„ä»¶ï¼Œå®¢æˆ·ä»£ç å˜å¾—ç®€å•</li>
<li>å­ç³»ç»Ÿä¸å®¢æˆ·æ¾æ•£è€¦åˆ</li>
<li>é™ä½å¤§å‹è½¯ä»¶ç³»ç»Ÿä¸­çš„ç¼–è¯‘ä¾èµ–æ€§ï¼Œç®€åŒ–äº†ç³»ç»Ÿåœ¨ä¸åŒå¹³å°ä¹‹é—´çš„ç§»æ¤è¿‡ç¨‹</li>
</ul>
</li>
<li>ç¼ºç‚¹ï¼š<ul>
<li>ä¸èƒ½å¾ˆå¥½åœ°é™åˆ¶å®¢æˆ·ä½¿ç”¨å­ç³»ç»Ÿç±»ï¼Œè€Œå¦‚æœå¯¹å®¢æˆ·è®¿é—®å­ç³»ç»Ÿç±»åšå¤ªå¤šçš„é™åˆ¶åˆ™å‡å°‘äº†å¯å˜æ€§å’Œçµæ´»æ€§</li>
<li>åœ¨ä¸å¼•å…¥æŠ½è±¡å¤–è§‚ç±»çš„æƒ…å†µä¸‹ï¼Œå¢åŠ æ–°çš„å­ç³»ç»Ÿå¯èƒ½éœ€è¦ä¿®æ”¹å¤–è§‚ç±»æˆ–å®¢æˆ·ç«¯çš„æºä»£ç ï¼Œè¿èƒŒäº†å¼€é—­åŸåˆ™</li>
</ul>
</li>
<li>æ‰©å±•ï¼š<ul>
<li>å¤šä¸ªå¤–è§‚ç±»</li>
<li>ä¸è¦è¯•å›¾é€šè¿‡å¤–è§‚ç±»ä¸ºå­ç³»ç»Ÿå¢åŠ æ–°è¡Œä¸º</li>
</ul>
</li>
</ul>
<h3 id="äº«å…ƒæ¨¡å¼"><a href="#äº«å…ƒæ¨¡å¼" class="headerlink" title="äº«å…ƒæ¨¡å¼"></a>äº«å…ƒæ¨¡å¼</h3><p>é€šè¿‡å…±äº«æŠ€æœ¯æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦å¯¹è±¡çš„å¤ç”¨ï¼Œç³»ç»Ÿåªä½¿ç”¨å°‘é‡çš„å¯¹è±¡ï¼Œè€Œè¿™äº›å¯¹è±¡éƒ½å¾ˆç›¸ä¼¼ï¼ŒçŠ¶æ€å˜åŒ–å¾ˆå°ï¼Œå¯ä»¥å®ç°å¯¹è±¡çš„å¤šæ¬¡å¤ç”¨</p>
<p><img src="https://design-patterns.readthedocs.io/zh_CN/latest/_images/Flyweight.jpg" alt="../_images/Flyweight.jpg"></p>
<p><strong>è§’è‰²ï¼š</strong></p>
<ul>
<li>Flyweight æŠ½è±¡äº«å…ƒç±»</li>
<li>ConcreteFlyweight å…·ä½“äº«å…ƒç±»</li>
<li>UnsharedConcreteFlyweight éå…±äº«å…·ä½“äº«å…ƒç±»</li>
<li>FlyweightFactory äº«å…ƒå·¥å‚ç±»ï¼šç»´æŠ¤ä¸€ä¸ªäº«å…ƒæ± ç”¨äºå­˜å‚¨å…·æœ‰ç›¸åŒå†…éƒ¨çŠ¶æ€çš„äº«å…ƒå¯¹è±¡</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">FlyweightFactory</span> &#123;</span><br><span class="line">    <span class="title function_">getFlyweight</span>(<span class="params">type</span>) &#123;</span><br><span class="line">        <span class="comment">// ä¼ªä»£ç ...</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">m_mpFlyweight</span>.<span class="title function_">find</span>(type)) &#123;</span><br><span class="line">            <span class="keyword">return</span> exist one</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> fw = <span class="keyword">new</span> <span class="title class_">ConcreteFlyweight</span>(type)</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">m_mpFlyweight</span>.<span class="title function_">push</span>(fw)</span><br><span class="line">            <span class="keyword">return</span> fw</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteFlyweight</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Flyweight</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">state</span>) &#123;</span><br><span class="line">        intrinsicState = state</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">operation</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// do operation</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>æ ¸å¿ƒåœ¨äºäº«å…ƒå·¥å‚ç±»ï¼ˆç»´æŠ¤çš„äº«å…ƒæ± ï¼‰</li>
<li>ä»¥å…±äº«çš„æ–¹å¼é«˜æ•ˆåœ°æ”¯æŒå¤§é‡çš„ç»†ç²’åº¦å¯¹è±¡ï¼Œäº«å…ƒå¯¹è±¡èƒ½åšåˆ°å…±äº«çš„å…³é”®æ˜¯åŒºåˆ†å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€<ul>
<li>å†…éƒ¨çŠ¶æ€æ˜¯å­˜å‚¨åœ¨äº«å…ƒå¯¹è±¡å†…éƒ¨å¹¶ä¸”ä¸ä¼šéšç¯å¢ƒæ”¹å˜è€Œæ”¹å˜çš„çŠ¶æ€ï¼Œå› æ­¤å†…éƒ¨çŠ¶æ€å¯ä»¥å…±äº«</li>
<li>å¤–éƒ¨çŠ¶æ€æ˜¯éšç¯å¢ƒæ”¹å˜è€Œæ”¹å˜çš„ã€ä¸å¯ä»¥å…±äº«çš„çŠ¶æ€ã€‚äº«å…ƒå¯¹è±¡çš„å¤–éƒ¨çŠ¶æ€å¿…é¡»ç”±å®¢æˆ·ç«¯ä¿å­˜ï¼Œå¹¶åœ¨äº«å…ƒå¯¹è±¡è¢«åˆ›å»ºä¹‹åï¼Œåœ¨éœ€è¦ä½¿ç”¨æ—¶å†ä¼ å…¥åˆ°äº«å…ƒå¯¹è±¡å†…éƒ¨ï¼Œä¸€ä¸ªå¤–éƒ¨çŠ¶æ€ä¸å¦ä¸€ä¸ªå¤–éƒ¨çŠ¶æ€ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„</li>
</ul>
</li>
<li>ä¼˜ç‚¹ï¼š<ul>
<li>æå¤§å‡å°‘å†…å­˜ä¸­å¯¹è±¡çš„æ•°é‡ï¼Œä½¿å¾—ç›¸åŒå¯¹è±¡æˆ–ç›¸ä¼¼å¯¹è±¡åœ¨å†…å­˜ä¸­åªä¿å­˜ä¸€ä»½</li>
<li>å¤–éƒ¨çŠ¶æ€ç›¸å¯¹ç‹¬ç«‹ï¼Œä¸ä¼šå½±å“å†…éƒ¨çŠ¶æ€ï¼Œä»è€Œä½¿å¾—äº«å…ƒå¯¹è±¡å¯ä»¥åœ¨ä¸åŒç¯å¢ƒä¸­è¢«å…±äº«</li>
</ul>
</li>
<li>ç¼ºç‚¹ï¼š<ul>
<li>ä½¿å¾—ç³»ç»Ÿæ›´åŠ å¤æ‚ï¼Œéœ€è¦åˆ†ç¦»å‡ºå†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€</li>
<li>è¯»å–å¤–éƒ¨çŠ¶æ€ä½¿å¾—è¿è¡Œæ—¶é—´å˜é•¿</li>
</ul>
</li>
<li>é€‚ç”¨ï¼š<ul>
<li>ä¸€ä¸ªç³»ç»Ÿæœ‰å¤§é‡ç›¸åŒæˆ–è€…ç›¸ä¼¼çš„å¯¹è±¡ï¼Œè¿™ç±»å¯¹è±¡çš„å¤§é‡é€‚ç”¨é€ æˆå†…å­˜çš„å¤§é‡è€—è´¹</li>
<li>å¯¹è±¡çš„å¤§éƒ¨åˆ†çŠ¶æ€éƒ½å¯ä»¥å¤–éƒ¨åŒ–ï¼Œå¯ä»¥å°†è¿™äº›å¤–éƒ¨çŠ¶æ€ä¼ å…¥å¯¹è±¡ä¸­</li>
<li>å› ä¸ºç»´æŠ¤äº«å…ƒæ± ä¼šè€—è´¹èµ„æºï¼Œæ‰€ä»¥åº”å½“åœ¨å¤šæ¬¡é‡å¤ä½¿ç”¨äº«å…ƒå¯¹è±¡æ—¶æ‰å€¼å¾—ä½¿ç”¨äº«å…ƒæ¨¡å¼</li>
</ul>
</li>
<li>æ‰©å±•ï¼š<ul>
<li>å•çº¯äº«å…ƒæ¨¡å¼ï¼šæ‰€æœ‰äº«å…ƒå¯¹è±¡éƒ½æ˜¯å¯ä»¥å…±äº«çš„ï¼Œä¸å­˜åœ¨éå…±äº«å…·ä½“äº«å…ƒç±»</li>
<li>å¤åˆäº«å…ƒæ¨¡å¼ï¼šå°†ä¸€äº›å•çº¯äº«å…ƒä½¿ç”¨ç»„åˆæ¨¡å¼åŠ ä»¥ç»„åˆï¼Œå¯ä»¥å½¢æˆå¤åˆäº«å…ƒå¯¹è±¡ï¼Œè¿™æ ·çš„å¤åˆäº«å…ƒå¯¹è±¡æœ¬èº«ä¸èƒ½å…±äº«ï¼Œä½†å®ƒä»¬å¯ä»¥åˆ†è§£æˆå•çº¯äº«å…ƒå¯¹è±¡ï¼Œè€Œåè€…åˆ™å¯ä»¥å…±äº«</li>
<li>äº«å…ƒå·¥å‚ç±»é€šå¸¸åªæœ‰å”¯ä¸€ä¸€ä¸ªï¼Œå¯ä»¥è®¾è®¡æˆå•ä¾‹</li>
</ul>
</li>
</ul>
<h3 id="ä»£ç†æ¨¡å¼"><a href="#ä»£ç†æ¨¡å¼" class="headerlink" title="ä»£ç†æ¨¡å¼"></a>ä»£ç†æ¨¡å¼</h3><p>ç»™æŸä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç†ï¼Œå¹¶ç”±ä»£ç†å¯¹è±¡æ§åˆ¶å¯¹åŸå¯¹è±¡çš„å¼•ç”¨</p>
<p>ä»£ç†å¯¹è±¡å¯ä»¥åœ¨å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸­ä»‹çš„ä½œç”¨ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ä»£ç†å¯¹è±¡å»æ‰å®¢æˆ·ä¸èƒ½çœ‹åˆ°çš„å†…å®¹å’ŒæœåŠ¡ï¼Œæˆ–è€…æ·»åŠ å®¢æˆ·éœ€è¦çš„é¢å¤–æœåŠ¡</p>
<p><img src="https://design-patterns.readthedocs.io/zh_CN/latest/_images/Proxy.jpg" alt="../_images/Proxy.jpg"></p>
<p><strong>è§’è‰²ï¼š</strong></p>
<ul>
<li>Subject æŠ½è±¡ä¸»é¢˜</li>
<li>Proxy ä»£ç†ä¸»é¢˜</li>
<li>RealSubject çœŸå®ä¸»é¢˜</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Proxy</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Subject</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_pRealSubject</span> = <span class="keyword">new</span> <span class="title class_">RealSubject</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">request</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">preRequest</span>() <span class="comment">// ä¸€äº›å…¶ä»–è¡Œä¸º</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_pRealSubject</span>.<span class="title function_">request</span>() <span class="comment">// çœŸæ­£å’ŒåŸå¯¹è±¡äº¤äº’</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">afterRequest</span>() <span class="comment">// ä¸€äº›å…¶ä»–è¡Œä¸º</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>ä¼˜ç‚¹ï¼šåè°ƒè°ƒç”¨è€…å’Œè¢«è°ƒç”¨è€…ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šé™ä½äº†ç³»ç»Ÿçš„è€¦åˆåº¦</li>
<li>ç¼ºç‚¹ï¼šæœ‰äº›ç±»å‹çš„ä»£ç†æ¨¡å¼å¯èƒ½ä¼šé€ æˆè¯·æ±‚çš„å¤„ç†é€Ÿåº¦å˜æ…¢ï¼›æœ‰äº›ä»£ç†çš„å®ç°æ¯”è¾ƒå¤æ‚ï¼Œéœ€è¦é¢å¤–çš„å·¥ä½œ</li>
<li>ä½¿ç”¨ï¼š<ul>
<li>è¿œç¨‹ï¼ˆremoteï¼‰ä»£ç†ï¼šä¸ºä¸€ä¸ªä½äºä¸åŒçš„åœ°å€ç©ºé—´çš„å¯¹è±¡æä¾›ä¸€ä¸ªæœ¬åœ°çš„ä»£ç†å¯¹è±¡ï¼Œè¿™ä¸ªä¸åŒçš„åœ°å€ç©ºé—´å¯ä»¥æ˜¯åœ¨åŒä¸€å°ä¸»æœºä¸­ï¼Œä¹Ÿå¯æ˜¯åœ¨å¦ä¸€å°ä¸»æœºä¸­</li>
<li>è™šæ‹Ÿï¼ˆvirtualï¼‰ä»£ç†ï¼šå¦‚æœéœ€è¦åˆ›å»ºä¸€ä¸ªèµ„æºæ¶ˆè€—è¾ƒå¤§çš„å¯¹è±¡ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªæ¶ˆè€—ç›¸å¯¹è¾ƒå°çš„å¯¹è±¡æ¥è¡¨ç¤ºï¼ŒçœŸå®å¯¹è±¡åªåœ¨éœ€è¦æ—¶æ‰ä¼šè¢«çœŸæ­£åˆ›å»º</li>
<li>Copy-on-Writeä»£ç†ï¼šæ˜¯è™šæ‹Ÿä»£ç†çš„ä¸€ç§ï¼ŒæŠŠå¤åˆ¶ï¼ˆå…‹éš†ï¼‰æ“ä½œå»¶è¿Ÿåˆ°åªæœ‰åœ¨å®¢æˆ·ç«¯çœŸæ­£éœ€è¦æ—¶æ‰æ‰§è¡Œï¼ˆå› ä¸ºæ·±å…‹éš†æ˜¯ä¸ªå¼€é”€è¾ƒå¤§çš„æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªä»£ç†è®©è¿™ä¸ªæ“ä½œå»¶è¿Ÿåˆ°åªæœ‰å¯¹è±¡è¢«ç”¨åˆ°æ—¶æ‰è¢«å…‹éš†ï¼‰</li>
<li>ä¿æŠ¤ï¼ˆProtect or Accessï¼‰ä»£ç†ï¼šæ§åˆ¶å¯¹ä¸€ä¸ªå¯¹è±¡çš„è®¿é—®ï¼Œå¯ä»¥ç»™ä¸åŒçš„ç”¨æˆ·æä¾›ä¸åŒçº§åˆ«çš„ä½¿ç”¨æƒé™</li>
<li>ç¼“å†²ï¼ˆCacheï¼‰ä»£ç†ï¼šä¸ºæŸä¸€ä¸ªç›®æ ‡æ“ä½œçš„ç»“æœæä¾›ä¸´æ—¶çš„å­˜å‚¨ç©ºé—´ï¼Œä»¥ä¾¿å¤šä¸ªå®¢æˆ·ç«¯å¯ä»¥å…±äº«è¿™äº›ç»“æœ</li>
<li>é˜²ç«å¢™ï¼ˆFirewallï¼‰ä»£ç†ï¼šä¿æŠ¤ç›®æ ‡ä¸è®©æ¶æ„ç”¨æˆ·æ¥è¿‘</li>
<li>åŒæ­¥åŒ–ï¼ˆSynchronizationï¼‰ä»£ç†ï¼šä½¿å‡ ä¸ªç”¨æˆ·èƒ½å¤ŸåŒæ—¶ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡è€Œæ²¡æœ‰å†²çª</li>
<li>æ™ºèƒ½å¼•ç”¨ï¼ˆSmart Referenceï¼‰ä»£ç†ï¼šå½“ä¸€ä¸ªå¯¹è±¡è¢«å¼•ç”¨æ—¶ï¼Œæä¾›ä¸€äº›é¢å¤–çš„æ“ä½œï¼Œå¦‚å°†æ­¤å¯¹è±¡è¢«è°ƒç”¨çš„æ¬¡æ•°è®°å½•ä¸‹æ¥ç­‰</li>
</ul>
</li>
</ul>
<h2 id="è¡Œä¸ºå‹æ¨¡å¼"><a href="#è¡Œä¸ºå‹æ¨¡å¼" class="headerlink" title="è¡Œä¸ºå‹æ¨¡å¼"></a>è¡Œä¸ºå‹æ¨¡å¼</h2><h3 id="å‘½ä»¤æ¨¡å¼"><a href="#å‘½ä»¤æ¨¡å¼" class="headerlink" title="å‘½ä»¤æ¨¡å¼"></a>å‘½ä»¤æ¨¡å¼</h3><p>å°†å‘é€è€…å’Œæ¥å—è€…å®Œå…¨è§£è€¦ï¼Œæ²¡æœ‰ç›´æ¥å¼•ç”¨å…³ç³»ï¼Œå‘é€è¯·æ±‚çš„å¯¹è±¡åªéœ€è¦çŸ¥é“å¦‚ä½•å‘é€è¯·æ±‚ï¼Œè€Œä¸å¿…çŸ¥é“å¦‚ä½•å®Œæˆè¯·æ±‚</p>
<p>å°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä½¿æˆ‘ä»¬å¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–</p>
<p><img src="https://design-patterns.readthedocs.io/zh_CN/latest/_images/Command.jpg" alt="../_images/Command.jpg"></p>
<p><strong>è§’è‰²ï¼š</strong></p>
<ul>
<li>Command æŠ½è±¡å‘½ä»¤ç±»</li>
<li>ConcreteCommand å…·ä½“å‘½ä»¤ç±»</li>
<li>Invoker è°ƒç”¨è€…</li>
<li>Receiver æ¥å—è€…</li>
<li>Client å®¢æˆ·ç±»</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Receiver</span> &#123;</span><br><span class="line">    <span class="title function_">action</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// å®šä¹‰æ¥æ”¶åˆ°å‘½ä»¤çš„è¡Œä¸º</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Invoker</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">command</span>) &#123;</span><br><span class="line">        <span class="comment">// è¿™é‡Œçš„ command æ˜¯æŠ½è±¡å‘½ä»¤æ¥å£ï¼Œå‘é€è€…é’ˆå¯¹æŠ½è±¡æ¥å£ç¼–ç¨‹</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_pCommand</span> = command</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">call</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// å‘å‡ºå‘½ä»¤</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_pCommand</span>.<span class="title function_">execute</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteCommand</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Command</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">receiver</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_pReceiver</span> = receiver</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">execute</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_pReceiver</span>.<span class="title function_">action</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>æœ¬è´¨æ˜¯å¯¹å‘½ä»¤è¿›è¡Œå°è£…ï¼Œå°†å‘å‡ºå‘½ä»¤çš„è´£ä»»å’Œæ‰§è¡Œå‘½ä»¤çš„è´£ä»»åˆ†å‰²å¼€ã€‚</li>
<li>ä¼˜ç‚¹ï¼š<ul>
<li>é™ä½ç³»ç»Ÿè€¦åˆåº¦</li>
<li>æ–°çš„å‘½ä»¤å¯ä»¥å¾ˆå®¹æ˜“åœ°åŠ å…¥åˆ°ç³»ç»Ÿä¸­ï¼Œå¯ä»¥æ¯”è¾ƒå®¹æ˜“åœ°è®¾è®¡ä¸€ä¸ªå‘½ä»¤é˜Ÿåˆ—å’Œå®å‘½ä»¤ï¼ˆç»„åˆå‘½ä»¤ï¼‰ï¼Œå¯ä»¥æ–¹ä¾¿åœ°å®ç°å¯¹è¯·æ±‚çš„ undo å’Œ redo</li>
</ul>
</li>
<li>ç¼ºç‚¹ï¼šå¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿä¸­æœ‰è¿‡å¤šçš„å…·ä½“å‘½ä»¤ç±»</li>
<li>é€‚ç”¨ï¼š<ul>
<li>ç³»ç»Ÿéœ€è¦å°†è¯·æ±‚è°ƒç”¨è€…å’Œè¯·æ±‚æ¥å—è€…è§£è€¦ï¼Œä½¿å¾—è°ƒç”¨è€…å’Œæ¥å—è€…ä¸ç›´æ¥äº¤äº’</li>
<li>ç³»ç»Ÿéœ€è¦åœ¨ä¸åŒçš„æ—¶é—´æŒ‡å®šè¯·æ±‚ã€å°†è¯·æ±‚æ’é˜Ÿã€æ‰§è¡Œè¯·æ±‚</li>
<li>ç³»ç»Ÿéœ€è¦æ”¯æŒå‘½ä»¤çš„æ’¤æ‰å’Œæ¢å¤æ“ä½œ</li>
<li>ç³»ç»Ÿéœ€è¦å°†ä¸€ç»„æ“ä½œç»„åˆåœ¨ä¸€èµ·ï¼Œå³æ”¯æŒå®å‘½ä»¤</li>
</ul>
</li>
<li>æ‰©å±•ï¼šå®å‘½ä»¤</li>
</ul>
<h3 id="ä¸­ä»‹è€…æ¨¡å¼"><a href="#ä¸­ä»‹è€…æ¨¡å¼" class="headerlink" title="ä¸­ä»‹è€…æ¨¡å¼"></a>ä¸­ä»‹è€…æ¨¡å¼</h3><p>ç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—çš„å¯¹è±¡äº¤äº’ï¼Œä¸­ä»‹è€…ä½¿å¾—å„å¯¹è±¡ä¸éœ€è¦æ˜¾å¼åœ°ç›¸äº’å¼•ç”¨ï¼Œä»è€Œä½¿å…¶è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’</p>
<p><img src="https://design-patterns.readthedocs.io/zh_CN/latest/_images/Mediator.jpg" alt="../_images/Mediator.jpg"></p>
<p><strong>è§’è‰²ï¼š</strong></p>
<ul>
<li>Mediator æŠ½è±¡ä¸­ä»‹è€…</li>
<li>ConcreteMediator å…·ä½“ä¸­ä»‹è€…</li>
<li>Colleague æŠ½è±¡åŒäº‹ç±»</li>
<li>ConcreteColleague å…·ä½“åŒäº‹ç±»</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteMediator</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Mediator</span> &#123;</span><br><span class="line">    <span class="comment">// ä¸€äº›ä¼ªä»£ç </span></span><br><span class="line">    <span class="title function_">operation</span>(<span class="params">to, msg</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_mpColleague</span>.<span class="title function_">find</span>(to).<span class="title function_">receivemsg</span>(msg)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">registered</span>(<span class="params">colleague</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">m_mpColleague</span>.<span class="title function_">find</span>(colleague)) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">m_mpColleague</span>.<span class="title function_">push</span>(colleague)</span><br><span class="line">            colleague.<span class="title function_">setMediator</span>(<span class="variable language_">this</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteColleague</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Colleague</span> &#123;</span><br><span class="line">    <span class="title function_">setMediator</span>(<span class="params">mediator</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_pMediator</span> = mediator</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">sendmsg</span>(<span class="params">to, msg</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_pMediator</span>.<span class="title function_">operation</span>(to, msg)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">receviemsg</span>(<span class="params">msg</span>) &#123;</span><br><span class="line">        <span class="comment">// æ”¶åˆ°æ¶ˆæ¯çš„æ“ä½œ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>ä¸­ä»‹è€…æ¨¡å¼å¯ä»¥ä½¿å¯¹è±¡ä¹‹é—´çš„å…³ç³»æ•°é‡æ€¥å‰§å‡å°‘ï¼Œä¸­ä»‹è€…æ‰¿æ‹…ä¸¤æ–¹é¢èŒè´£ï¼šä¸­è½¬ä½œç”¨ï¼ˆç»“æ„æ€§ï¼‰ï¼Œåè°ƒä½œç”¨ï¼ˆè¡Œä¸ºå‹ï¼‰</li>
<li>ä¼˜ç‚¹ï¼šç®€åŒ–å¯¹è±¡ä¹‹é—´äº¤äº’ï¼Œå„åŒäº‹è§£è€¦ï¼Œå‡å°‘å­ç±»ç”Ÿæˆï¼Œå¯ä»¥ç®€åŒ–å„åŒäº‹ç±»çš„è®¾è®¡å’Œå®ç°</li>
<li>ç¼ºç‚¹ï¼šåœ¨å…·ä½“ä¸­ä»‹è€…ç±»ä¸­åŒ…å«äº†åŒäº‹ä¹‹é—´çš„äº¤äº’ç»†èŠ‚ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…·ä½“ä¸­ä»‹è€…ç±»éå¸¸å¤æ‚ï¼Œä½¿å¾—ç³»ç»Ÿéš¾ä»¥ç»´æŠ¤</li>
<li>é€‚ç”¨ï¼š<ul>
<li>ç³»ç»Ÿä¸­å¯¹è±¡å­˜åœ¨å¤æ‚çš„å¼•ç”¨å…³ç³»ï¼Œäº§ç”Ÿçš„ç›¸äº’ä¾èµ–å…³ç³»ç»“æ„æ··ä¹±ä¸”éš¾ä»¥ç†è§£</li>
<li>ä¸€ä¸ªå¯¹è±¡ç”±äºå¼•ç”¨äº†å…¶ä»–å¾ˆå¤šå¯¹è±¡å¹¶ç›´æ¥å’Œè¿™äº›å¯¹è±¡é€šä¿¡ï¼Œå¯¼è‡´éš¾ä»¥å¤ç”¨è¯¥å¯¹è±¡</li>
<li>æƒ³é€šè¿‡ä¸€ä¸ªä¸­é—´ç±»æ¥å°è£…å¤šä¸ªç±»ä¸­çš„è¡Œä¸ºï¼Œè€Œåˆä¸æƒ³ç”Ÿæˆå¤ªå¤šçš„å­ç±»ï¼Œå¯ä»¥é€šè¿‡å¼•å…¥ä¸­ä»‹è€…ç±»å®ç°ï¼Œåœ¨ä¸­ä»‹è€…ä¸­å®šä¹‰å¯¹è±¡</li>
<li>äº¤äº’çš„å…¬å…±è¡Œä¸ºï¼Œå¦‚æœéœ€è¦æ”¹å˜è¡Œä¸ºåˆ™å¯ä»¥å¢åŠ æ–°çš„ä¸­ä»‹è€…ç±»</li>
</ul>
</li>
<li>æ‰©å±•ï¼š<ul>
<li>ä¾‹å¦‚ MVC ç»“æ„ä¸­çš„ Controllerï¼Œè´Ÿè´£æ§åˆ¶è§†å›¾å¯¹è±¡ View å’Œæ¨¡å‹å¯¹è±¡ Model ä¹‹é—´çš„äº¤äº’</li>
<li>ç¬¦åˆè¿ªç±³ç‰¹æ³•åˆ™</li>
</ul>
</li>
</ul>
<h3 id="è§‚å¯Ÿè€…æ¨¡å¼"><a href="#è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="è§‚å¯Ÿè€…æ¨¡å¼"></a>è§‚å¯Ÿè€…æ¨¡å¼</h3><p>å»ºç«‹ä¸€ç§å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼ˆä¸€å¯¹å¤šï¼‰ï¼Œä¸€ä¸ªå¯¹è±¡å‘ç”Ÿæ”¹å˜æ—¶å°†è‡ªåŠ¨é€šçŸ¥å…¶ä»–å¯¹è±¡ï¼Œå…¶ä»–å¯¹è±¡å°†ç›¸åº”åšå‡ºååº”</p>
<p><img src="https://design-patterns.readthedocs.io/zh_CN/latest/_images/Obeserver.jpg" alt="../_images/Obeserver.jpg"></p>
<p><strong>è§’è‰²ï¼š</strong></p>
<ul>
<li>Subject ç›®æ ‡</li>
<li>ConcreteSubject å…·ä½“ç›®æ ‡</li>
<li>Observer è§‚å¯Ÿè€…</li>
<li>ConcreteObserver å…·ä½“è§‚å¯Ÿè€…</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteSubject</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Subject</span> &#123;</span><br><span class="line">    <span class="title function_">attach</span>(<span class="params">observer</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_vtObj</span>.<span class="title function_">push</span>(observer)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">detach</span>(<span class="params">observer</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_vtObj</span>.<span class="title function_">splice</span>(<span class="variable language_">this</span>.<span class="property">m_vtObj</span>.<span class="title function_">findIndex</span>(<span class="function"><span class="params">e</span> =&gt;</span> e === observer), <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">notify</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_vtObj</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="title function_">update</span>(<span class="variable language_">this</span>))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">setState</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// æ”¹å˜è‡ªèº«çŠ¶æ€</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">notify</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">getState</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// æ–¹ä¾¿ observer è°ƒç”¨å–å¾—çŠ¶æ€</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConcretObserver</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Observer</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_objName</span> = name</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">update</span>(<span class="params">subject</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_observerState</span> = subject.<span class="title function_">getState</span>()</span><br><span class="line">        <span class="comment">// ä¸€äº›åŸºäº this.m_objName å’Œ this.m_observerState çš„æ“ä½œ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>ä¸€ä¸ªç›®æ ‡å¯ä»¥æœ‰å¤šä¸ªè§‚å¯Ÿè€…ï¼ˆç”¨ä¸€ä¸ªæ•°ç»„å­˜ï¼‰ï¼Œä¸€æ—¦ç›®æ ‡çŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œå°±éå†æ•°ç»„é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…ï¼›è§‚å¯Ÿè€…æ”¶åˆ°é€šçŸ¥è¿›è¡Œè‡ªèº«æ›´æ–°</li>
<li>ä¼˜ç‚¹ï¼š<ul>
<li>è¡¨ç¤ºå±‚ï¼ˆobserverï¼‰ä¸æ•°æ®é€»è¾‘å±‚ï¼ˆsubjectï¼‰çš„åˆ†ç¦»ï¼Œå®šä¹‰äº†ç¨³å®šçš„æ¶ˆæ¯æ›´æ–°ä¼ é€’æœºåˆ¶ï¼ŒæŠ½è±¡äº†æ›´æ–°æ¥å£ï¼Œä½¿å¾—å¯ä»¥ç”±å„ç§å„æ ·ä¸åŒçš„è¡¨ç¤ºå±‚ä½œä¸ºå…·ä½“è§‚å¯Ÿè€…è§’è‰²</li>
<li>è§‚å¯Ÿç›®æ ‡å’Œè§‚å¯Ÿè€…ä¹‹é—´æŠ½è±¡è€¦åˆ</li>
<li>æ”¯æŒå¹¿æ’­é€šä¿¡</li>
<li>ç¬¦åˆå¼€é—­åŸåˆ™</li>
</ul>
</li>
<li>ç¼ºç‚¹ï¼š<ul>
<li>å¦‚æœä¸€ä¸ª subject æœ‰å¾ˆå¤šç›´æ¥å’Œé—´æ¥çš„ observer çš„è¯ï¼Œé€šçŸ¥æ‰€æœ‰ observer ä¼šèŠ±è´¹å¾ˆå¤šæ—¶é—´</li>
<li>å¦‚æœ subject å’Œ observer ä¹‹é—´å­˜åœ¨å¾ªç¯ä¾èµ–ï¼Œä¼šå‘ç”Ÿå¾ªç¯è°ƒç”¨</li>
<li>è§‚å¯Ÿè€…æ¨¡å¼æ²¡æœ‰ç›¸åº”çš„æœºåˆ¶è®©è§‚å¯Ÿè€…çŸ¥é“ç›®æ ‡å¯¹è±¡æ˜¯æ€æ ·å‘ç”Ÿå˜åŒ–çš„ï¼Œè€Œä»…ä»…èƒ½çŸ¥é“å‘ç”Ÿäº†å˜åŒ–</li>
</ul>
</li>
<li>é€‚ç”¨ï¼š<ul>
<li>ä¸€ä¸ªæŠ½è±¡æ¨¡å‹æœ‰ä¸¤ä¸ªæ–¹é¢ï¼Œå…¶ä¸­ä¸€ä¸ªæ–¹é¢ä¾èµ–äºå¦ä¸€ä¸ªæ–¹é¢</li>
<li>ä¸€ä¸ªå¯¹è±¡çš„æ”¹å˜å°†å¯¼è‡´å…¶ä»–ä¸€ä¸ªæˆ–å¤šä¸ªå¯¹è±¡ä¹Ÿå‘ç”Ÿæ”¹å˜ï¼Œè€Œä¸çŸ¥é“å…·ä½“æœ‰å¤šå°‘å¯¹è±¡å°†å‘ç”Ÿæ”¹å˜</li>
<li>ä¸€ä¸ªå¯¹è±¡å¿…é¡»é€šçŸ¥å…¶ä»–å¯¹è±¡ï¼Œè€Œå¹¶ä¸çŸ¥é“è¿™äº›å¯¹è±¡æ˜¯è°</li>
<li>éœ€è¦åœ¨ç³»ç»Ÿä¸­åˆ›å»ºä¸€ä¸ªè§¦å‘é“¾ï¼ŒAå¯¹è±¡çš„è¡Œä¸ºå°†å½±å“Bï¼ŒBå¯¹è±¡çš„è¡Œä¸ºå°†å½±å“Câ€¦â€¦</li>
</ul>
</li>
<li>æ‰©å±•ï¼š<ul>
<li>MVCï¼šmodel - subjectï¼ˆè¢«è§‚å¯Ÿçš„ç›®æ ‡ï¼‰ï¼Œview - observerï¼ˆè§‚å¯Ÿè€…ï¼‰ï¼Œcontroller - å……å½“ä¸¤è€…ä¹‹é—´çš„ä¸­ä»‹è€… mediatorï¼Œé¿å…ä¸¤è€…ç›´æ¥å¼•ç”¨</li>
</ul>
</li>
</ul>
<h3 id="çŠ¶æ€æ¨¡å¼"><a href="#çŠ¶æ€æ¨¡å¼" class="headerlink" title="çŠ¶æ€æ¨¡å¼"></a>çŠ¶æ€æ¨¡å¼</h3><p>å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒçš„ç±»</p>
<p><img src="https://design-patterns.readthedocs.io/zh_CN/latest/_images/State.jpg" alt="../_images/State.jpg"></p>
<p><strong>è§’è‰²ï¼š</strong></p>
<ul>
<li>Context ç¯å¢ƒç±»ï¼šæ‹¥æœ‰çŠ¶æ€çš„å¯¹è±¡ï¼Œæœ‰æ—¶å€™å¯ä»¥å……å½“çŠ¶æ€ç®¡ç†å™¨çš„è§’è‰²ï¼Œå¯ä»¥åœ¨ç¯å¢ƒç±»ä¸­å¯¹çŠ¶æ€è¿›è¡Œåˆ‡æ¢æ“ä½œã€‚é’ˆå¯¹æŠ½è±¡çŠ¶æ€ç±»è¿›è¡Œç¼–ç¨‹</li>
<li>State æŠ½è±¡çŠ¶æ€ç±»ï¼šä¸“é—¨è¡¨ç¤ºå¯¹è±¡çš„çŠ¶æ€ï¼Œè€Œå¯¹è±¡çš„æ¯ä¸€ç§å…·ä½“çŠ¶æ€ç±»éƒ½ç»§æ‰¿äº†è¯¥ç±»ï¼Œå¹¶åœ¨ä¸åŒå…·ä½“çŠ¶æ€ç±»ä¸­å®ç°äº†ä¸åŒçŠ¶æ€çš„è¡Œä¸ºï¼ŒåŒ…æ‹¬å„ç§çŠ¶æ€ä¹‹é—´çš„è½¬æ¢ã€‚ç¯å¢ƒç±»å¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶å¯ä»¥æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒçš„ç±»ï¼Œè€Œå®é™…ä¸Šæ˜¯ç”±äºåˆ‡æ¢åˆ°ä¸åŒçš„å…·ä½“çŠ¶æ€ç±»å®ç°çš„</li>
<li>ConcreteState å…·ä½“çŠ¶æ€ç±»</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Context</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_pState</span> = <span class="keyword">new</span> <span class="title class_">ConcreteState</span>(<span class="variable language_">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">changeState</span>(<span class="params">state</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_pState</span> = state</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">request</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_pState</span>.<span class="title function_">handle</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteState</span> <span class="keyword">extends</span> <span class="title class_ inherited__">State</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">context</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">context</span> = context</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">handle</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// doing something in state</span></span><br><span class="line">        <span class="comment">// then change state</span></span><br><span class="line">        context.<span class="title function_">changeState</span>(<span class="keyword">new</span> <span class="title class_">ConcreteStateB</span>(<span class="variable language_">this</span>.<span class="property">context</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>ä¼˜ç‚¹ï¼š<ul>
<li>å°è£…äº†çŠ¶æ€è½¬æ¢è§„åˆ™ï¼ŒçŠ¶æ€è½¬æ¢é€»è¾‘ä¸çŠ¶æ€å¯¹è±¡åˆæˆä¸€ä½“</li>
<li>æšä¸¾å¯èƒ½çš„çŠ¶æ€</li>
<li>å°†æ‰€æœ‰ä¸æŸä¸ªçŠ¶æ€æœ‰å…³çš„è¡Œä¸ºæ”¾åˆ°ä¸€ä¸ªç±»ä¸­ï¼Œå¹¶ä¸”å¯ä»¥æ–¹ä¾¿åœ°å¢åŠ æ–°çš„çŠ¶æ€ï¼Œåªéœ€è¦æ”¹å˜å¯¹è±¡çŠ¶æ€å³å¯æ”¹å˜å¯¹è±¡è¡Œä¸º</li>
<li>å¯ä»¥è®©å¤šä¸ªç¯å¢ƒå¯¹è±¡å…±äº«ä¸€ä¸ªçŠ¶æ€å¯¹è±¡ï¼Œä»è€Œå‡å°‘ç³»ç»Ÿä¸­å¯¹è±¡çš„ä¸ªæ•°</li>
</ul>
</li>
<li>ç¼ºç‚¹ï¼š<ul>
<li>å¿…ç„¶ä¼šå¢åŠ ç³»ç»Ÿç±»å’Œå¯¹è±¡çš„ä¸ªæ•°</li>
<li>ç»“æ„å’Œå®ç°éƒ½è¾ƒä¸ºå¤æ‚ï¼Œå¦‚æœä½¿ç”¨ä¸å½“å°†å¯¼è‡´ç¨‹åºç»“æ„å’Œä»£ç çš„æ··ä¹±</li>
<li>ä¸ç¬¦åˆå¼€é—­åŸåˆ™ï¼Œæ–°å¢çŠ¶æ€éœ€è¦ä¿®æ”¹é‚£äº›è´Ÿè´£çŠ¶æ€è½¬æ¢çš„ä»£ç ï¼Œè€Œä¸”ä¿®æ”¹æŸä¸ªçŠ¶æ€ç±»çš„è¡Œä¸ºä¹Ÿéœ€è¦ä¿®æ”¹å¯¹åº”ç±»çš„ä»£ç </li>
</ul>
</li>
<li>é€‚ç”¨ï¼š<ul>
<li>å¯¹è±¡çš„è¡Œä¸ºä¾èµ–äºå®ƒçš„çŠ¶æ€å¹¶ä¸”å¯ä»¥æ ¹æ®å®ƒçš„çŠ¶æ€æ”¹å˜è€Œæ”¹å˜å®ƒçš„ç›¸å…³è¡Œä¸º</li>
<li>ä»£ç ä¸­åŒ…å«å¤§é‡ä¸å¯¹è±¡çŠ¶æ€æœ‰å…³çš„æ¡ä»¶è¯­å¥ï¼Œè¿™äº›æ¡ä»¶è¯­å¥çš„å‡ºç°ä¼šå¯¼è‡´ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œçµæ´»æ€§å˜å·®ï¼Œä¸èƒ½æ–¹ä¾¿åœ°å¢åŠ å’Œåˆ é™¤çŠ¶æ€ï¼Œä½¿å®¢æˆ·ç±»ä¸ç±»åº“ä¹‹é—´çš„è€¦åˆå¢å¼ºï¼›åœ¨è¿™äº›æ¡ä»¶è¯­å¥ä¸­åŒ…å«äº†å¯¹è±¡çš„è¡Œä¸ºï¼Œè€Œä¸”è¿™äº›æ¡ä»¶å¯¹åº”äºå¯¹è±¡çš„å„ç§çŠ¶æ€</li>
</ul>
</li>
<li>æ‰©å±•ï¼š<ul>
<li>å¤šä¸ªç¯å¢ƒå¯¹è±¡å…±äº«ä¸€ä¸ªæˆ–å¤šä¸ªçŠ¶æ€å¯¹è±¡ï¼Œéœ€è¦å°†è¿™äº›çŠ¶æ€å¯¹è±¡å®šä¹‰ä¸ºç¯å¢ƒçš„é™æ€æˆå‘˜å¯¹è±¡</li>
<li>ç®€å•çŠ¶æ€æ¨¡å¼ï¼šçŠ¶æ€ç›¸äº’ç‹¬ç«‹ï¼ŒçŠ¶æ€ä¹‹é—´æ— éœ€è¿›è¡Œè½¬æ¢ã€‚æ­¤æ—¶æ¯ä¸ªçŠ¶æ€ç±»éƒ½å°è£…ä¸çŠ¶æ€ç›¸å…³çš„æ“ä½œï¼Œè€Œæ— éœ€å…³å¿ƒçŠ¶æ€çš„åˆ‡æ¢ï¼Œå®¢æˆ·ç«¯ç›´æ¥å®ä¾‹çŠ¶æ€ç±»ç„¶åæŠŠçŠ¶æ€å¯¹è±¡è®¾ç½®åˆ°ç¯å¢ƒç±»ä¸­å³å¯ã€‚éµå¾ªå¼€é—­åŸåˆ™ï¼Œå®¢æˆ·ç«¯é’ˆå¯¹æŠ½è±¡çŠ¶æ€ç±»è¿›è¡Œç¼–ç¨‹ï¼Œå¢åŠ æ–°çš„çŠ¶æ€ç±»å¯¹åŸæœ‰ç³»ç»Ÿä¹Ÿä¸é€ æˆä»»ä½•å½±å“</li>
<li>å¯åˆ‡æ¢çŠ¶æ€çš„çŠ¶æ€æ¨¡å¼ï¼šåœ¨åˆ‡æ¢çŠ¶æ€æ—¶éœ€è¦åœ¨å…·ä½“çŠ¶æ€ç±»å†…éƒ¨è°ƒç”¨ context.changeState()ï¼Œå› æ­¤çŠ¶æ€ç±»ä¸ç¯å¢ƒç±»ä¹‹é—´è¿˜å­˜åœ¨å…³è”å…³ç³»æˆ–ä¾èµ–å…³ç³»ï¼Œé€šè¿‡åœ¨çŠ¶æ€ç±»ä¸­å¼•ç”¨ç¯å¢ƒç±»çš„å¯¹è±¡å®ç°è°ƒç”¨ã€‚è¿™ç§æ¨¡å¼ä¸‹å¢åŠ æ–°çš„çŠ¶æ€ç±»å¯èƒ½ä¼šéœ€è¦ä¿®æ”¹å…¶ä»–çŠ¶æ€ç±»ç”šè‡³ç¯å¢ƒç±»çš„æºä»£ç ï¼Œå¦åˆ™æ— æ³•åˆ‡æ¢</li>
</ul>
</li>
</ul>
<h3 id="ç­–ç•¥æ¨¡å¼"><a href="#ç­–ç•¥æ¨¡å¼" class="headerlink" title="ç­–ç•¥æ¨¡å¼"></a>ç­–ç•¥æ¨¡å¼</h3><p>å®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼Œå°†æ¯ä¸€ä¸ªç®—æ³•å°è£…èµ·æ¥ï¼Œå¹¶è®©å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ï¼Œç­–ç•¥æ¨¡å¼è®©ç®—æ³•ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„å®¢æˆ·è€Œå˜åŒ–</p>
<p><img src="https://design-patterns.readthedocs.io/zh_CN/latest/_images/Strategy.jpg" alt="../_images/Strategy.jpg"></p>
<p><strong>è§’è‰²ï¼š</strong></p>
<ul>
<li>Context ç¯å¢ƒç±»</li>
<li>Strategy æŠ½è±¡ç­–ç•¥ç±»</li>
<li>ConcreteStrategy å…·ä½“ç­–ç•¥ç±»</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Context</span> &#123;</span><br><span class="line">    <span class="title function_">algorithm</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_pStrategy</span>.<span class="title function_">algorithm</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">setStrategy</span>(<span class="params">strategy</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">m_pStrategy</span> = strategy</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ConcreteStrategy</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Strategy</span> &#123;</span><br><span class="line">    <span class="title function_">algorithm</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// å…·ä½“ç®—æ³•</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åˆ†æï¼š</strong></p>
<ul>
<li>æŠŠç®—æ³•çš„è´£ä»»å’Œç®—æ³•æœ¬èº«åˆ†éš”å¼€ï¼Œå§”æ´¾ç»™ä¸åŒçš„å¯¹è±¡ç®¡ç†ã€‚â€œå‡†å¤‡ä¸€ç»„ç®—æ³•ï¼Œå¹¶å°†æ¯ä¸€ä¸ªç®—æ³•å°è£…èµ·æ¥ï¼Œä½¿å¾—å®ƒä»¬å¯ä»¥äº’æ¢â€</li>
<li>å®¢æˆ·ç«¯è‡ªå·±å†³å®šåœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨ä»€ä¹ˆå…·ä½“ç­–ç•¥è§’è‰²ï¼Œç­–ç•¥æ¨¡å¼ä»…ä»…å°è£…ç®—æ³•</li>
<li>ä¼˜ç‚¹ï¼š<ul>
<li>å®Œç¾æ”¯æŒâ€œå¼€é—­åŸåˆ™â€ï¼Œç”¨æˆ·å¯ä»¥åœ¨ä¸ä¿®æ”¹åŸæœ‰ç³»ç»Ÿçš„åŸºç¡€ä¸Šé€‰æ‹©ç®—æ³•æˆ–è¡Œä¸ºï¼Œä¹Ÿå¯ä»¥çµæ´»åœ°å¢åŠ æ–°çš„ç®—æ³•æˆ–è¡Œä¸º</li>
<li>æä¾›ç®¡ç†ç›¸å…³ç®—æ³•æ—çš„åŠæ³•</li>
<li>æä¾›å¯ä»¥æ›¿æ¢ç»§æ‰¿å…³ç³»çš„åŠæ³•</li>
<li>å¯ä»¥é¿å…ä½¿ç”¨å¤šé‡æ¡ä»¶è½¬ç§»è¯­å¥</li>
</ul>
</li>
<li>ç¼ºç‚¹ï¼š<ul>
<li>å®¢æˆ·ç«¯å¿…é¡»çŸ¥é“æ‰€æœ‰çš„ç­–ç•¥ç±»ï¼Œå¹¶è‡ªè¡Œå†³å®šä½¿ç”¨å“ªä¸€ä¸ªç­–ç•¥ç±»</li>
<li>å°†é€ æˆå¾ˆå¤šç­–ç•¥ç±»ï¼Œå¯ä»¥é€šè¿‡äº«å…ƒæ¨¡å¼åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘å¯¹è±¡çš„æ•°é‡</li>
</ul>
</li>
<li>é€‚ç”¨ï¼š<ul>
<li>å¦‚æœä¸€ä¸ªç³»ç»Ÿé‡Œé¢æœ‰è®¸å¤šç±»ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ä»…åœ¨äºå®ƒä»¬çš„è¡Œä¸ºï¼Œé‚£ä¹ˆä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥åŠ¨æ€åœ°è®©ä¸€ä¸ªå¯¹è±¡åœ¨è®¸å¤šè¡Œä¸ºä¸­é€‰æ‹©ä¸€ç§è¡Œä¸º</li>
<li>åœ¨å…·ä½“ç­–ç•¥ç±»ä¸­å°è£…ç®—æ³•å’Œç›¸å…³æ•°æ®ç»“æ„ï¼Œæé«˜ç®—æ³•çš„ä¿å¯†æ€§å’Œå®‰å…¨æ€§</li>
</ul>
</li>
<li>æ‰©å±•ï¼šç­–ç•¥æ¨¡å¼ä¸çŠ¶æ€æ¨¡å¼<ul>
<li>å¯ä»¥é€šè¿‡ç¯å¢ƒç±»çŠ¶æ€çš„ä¸ªæ•°æ¥å†³å®šæ˜¯ä½¿ç”¨ç­–ç•¥æ¨¡å¼è¿˜æ˜¯çŠ¶æ€æ¨¡å¼</li>
<li>ç­–ç•¥æ¨¡å¼çš„ç¯å¢ƒç±»è‡ªå·±é€‰æ‹©ä¸€ä¸ªå…·ä½“ç­–ç•¥ç±»ï¼Œå…·ä½“ç­–ç•¥ç±»æ— éœ€å…³å¿ƒç¯å¢ƒç±»ï¼›è€ŒçŠ¶æ€æ¨¡å¼çš„ç¯å¢ƒç±»ç”±äºå¤–åœ¨å› ç´ éœ€è¦æ”¾è¿›ä¸€ä¸ªå…·ä½“çŠ¶æ€ä¸­ï¼Œä»¥ä¾¿é€šè¿‡å…¶æ–¹æ³•å®ç°çŠ¶æ€çš„åˆ‡æ¢ï¼Œå› æ­¤ç¯å¢ƒç±»å’ŒçŠ¶æ€ç±»ä¹‹é—´å­˜åœ¨ä¸€ç§åŒå‘çš„å…³è”å…³ç³»</li>
<li>ç­–ç•¥æ¨¡å¼å®¢æˆ·ç«¯éœ€è¦çŸ¥é“æ‰€é€‰çš„å…·ä½“ç­–ç•¥æ˜¯å“ªä¸€ä¸ªï¼›çŠ¶æ€æ¨¡å¼å®¢æˆ·ç«¯æ— éœ€å…³å¿ƒå…·ä½“çŠ¶æ€ï¼Œç¯å¢ƒç±»çš„çŠ¶æ€ä¼šæ ¹æ®ç”¨æˆ·çš„æ“ä½œè‡ªåŠ¨è½¬æ¢</li>
<li>å¦‚æœç³»ç»Ÿä¸­æŸä¸ªç±»çš„å¯¹è±¡å­˜åœ¨å¤šç§çŠ¶æ€ï¼Œä¸åŒçŠ¶æ€ä¸‹è¡Œä¸ºæœ‰å·®å¼‚ï¼Œè€Œä¸”è¿™äº›çŠ¶æ€ä¹‹é—´å¯ä»¥å‘ç”Ÿè½¬æ¢æ—¶ä½¿ç”¨çŠ¶æ€æ¨¡å¼ï¼›å¦‚æœç³»ç»Ÿä¸­æŸä¸ªç±»çš„æŸä¸€è¡Œä¸ºå­˜åœ¨å¤šç§å®ç°æ–¹å¼ï¼Œè€Œä¸”è¿™äº›å®ç°æ–¹å¼å¯ä»¥äº’æ¢æ—¶ä½¿ç”¨ç­–ç•¥æ¨¡å¼</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="ce">
    <link itemprop="mainEntityOfPage" href="https://hayahayao.github.io/2020/04/20/React%E5%85%A5%E9%97%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="hayahayao">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ã•ãŠã‚Šã®Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/20/React%E5%85%A5%E9%97%A8/" class="post-title-link" itemprop="url">ç¬”è®°Reactå…¥é—¨</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-20 15:13:00" itemprop="dateCreated datePublished" datetime="2020-04-20T15:13:00+08:00">2020-04-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-08-23 01:32:57" itemprop="dateModified" datetime="2023-08-23T01:32:57+08:00">2023-08-23</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="React"><a href="#React" class="headerlink" title="React"></a>React</h1><h2 id="JSX"><a href="#JSX" class="headerlink" title="JSX"></a>JSX</h2><p>JSX -&gt; React å…ƒç´  -&gt; DOM</p>
<p><code>&#123;&#125;</code> å¤§æ‹¬å·ä¸­å¯ä»¥æ”¾ç½®ä»»ä½•æœ‰æ•ˆçš„ js è¡¨è¾¾å¼</p>
<p>JSX æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸ªè¡¨è¾¾å¼ï¼Œç¼–è¯‘åä¼šè¢«è½¬ä¸º <code>React.createElement()</code> è¿™ç§æ™®é€šå‡½æ•°è°ƒç”¨</p>
<h2 id="å…ƒç´ æ¸²æŸ“"><a href="#å…ƒç´ æ¸²æŸ“" class="headerlink" title="å…ƒç´ æ¸²æŸ“"></a>å…ƒç´ æ¸²æŸ“</h2><p>å…ƒç´ æ˜¯æ„æˆ React åº”ç”¨çš„æœ€å°ç –å—</p>
<p>å…ƒç´ æè¿°äº†ä½ åœ¨å±å¹•ä¸Šæƒ³çœ‹åˆ°çš„å†…å®¹ï¼Œä¸æ™®é€š DOM ä¸åŒï¼ŒReact æ˜¯å¼€é”€æå°çš„æ™®é€šå¯¹è±¡ï¼ŒReact DOM ä¼šè´Ÿè´£æ›´æ–° DOM æ¥ä¸ React å…ƒç´ ä¿æŒä¸€è‡´ï¼ˆè¿™ä¸ªæ›´æ–°ç®—æ³•æ˜¯é«˜æ•ˆçš„ï¼Œåªä¼šè¿›è¡Œå¿…è¦çš„æ›´æ–°ï¼‰</p>
<p>ç»„ä»¶æ˜¯ç”±å…ƒç´ ç»„æˆçš„</p>
<p>React å…ƒç´ æ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œä¸€æ—¦è¢«åˆ›å»ºï¼Œå°±æ— æ³•æ›´æ”¹å®ƒçš„å­å…ƒç´ æˆ–è€…å±æ€§ï¼ˆä»£è¡¨äº†æŸä¸ªç‰¹å®šæ—¶åˆ»çš„ UIï¼‰ã€‚æ›´æ–° UI çš„æ–¹å¼ä¹‹ä¸€æ˜¯åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å…ƒç´ ï¼Œå¹¶å°†å…¶ä¼ å…¥ <code>ReactDOM.render()</code></p>
<h2 id="ç»„ä»¶-Props"><a href="#ç»„ä»¶-Props" class="headerlink" title="ç»„ä»¶ &amp; Props"></a>ç»„ä»¶ &amp; Props</h2><p>ç»„ä»¶å…è®¸ä½ å°† UI æ‹†åˆ†ä¸ºç‹¬ç«‹å¯å¤ç”¨çš„ä»£ç ç‰‡æ®µï¼Œå¹¶å¯¹æ¯ä¸ªç‰‡æ®µè¿›è¡Œç‹¬ç«‹æ„æ€ã€‚</p>
<p>å‡½æ•°ç»„ä»¶ï¼šå‚æ•° propsï¼Œè¿”å› react å…ƒç´ </p>
<p>classç»„ä»¶ï¼šes6 çš„ class è¯­æ³•ï¼Œåœ¨ react ä¸­å’Œå‡½æ•°ç»„ä»¶æ˜¯ç­‰æ•ˆçš„</p>
<p>çº¯å‡½æ•°ï¼šä¸æ›´æ”¹å…¥å‚ï¼Œä¸”å¤šæ¬¡æƒ…å†µä¸‹è°ƒç”¨ç›¸åŒçš„å…¥å‚å§‹ç»ˆè¿”å›ç›¸åŒçš„ç»“æœ</p>
<p><strong>æ‰€æœ‰çš„ React ç»„ä»¶éƒ½å¿…é¡»åƒçº¯å‡½æ•°ä¸€æ ·ä¿æŠ¤å®ƒä»¬çš„ props ä¸è¢«æ›´æ”¹</strong></p>
<h2 id="State-ç”Ÿå‘½å‘¨æœŸ"><a href="#State-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="State &amp; ç”Ÿå‘½å‘¨æœŸ"></a>State &amp; ç”Ÿå‘½å‘¨æœŸ</h2><p>stateï¼šç§æœ‰çš„ï¼Œå®Œå…¨å—æ§äºå½“å‰ç»„ä»¶</p>
<p><code>this.props</code> å’Œ <code>this.state</code> æ˜¯ React æœ¬èº«è®¾ç½®çš„æœ‰ç‰¹æ®Šå«ä¹‰çš„å±æ€§ï¼Œä½†å…¶å®ä¹Ÿå¯ä»¥å‘ class ä¸­éšæ„æ·»åŠ ï¼ˆä¸å‚ä¸æ•°æ®æµçš„ï¼‰å…¶ä»–å­—æ®µ</p>
<p>ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼š</p>
<ul>
<li><code>componentDidMount()</code> &#x3D; vue çš„ mounted</li>
<li><code>componentWillUnmount()</code> &#x3D; vue çš„ beforeDestory</li>
</ul>
<p>æ›´æ–° UI çš„æ–¹å¼ä¹‹äºŒï¼šstate é‡Œé¢ï¼ˆé€šè¿‡<code>setState()</code>ï¼‰ä¿®æ”¹æ•°æ®ï¼Œä»è€Œ React èƒ½å¤ŸçŸ¥é“state å˜åŒ–ï¼Œæ¯æ¬¡æ›´æ–°æ—¶éƒ½è°ƒç”¨ç»„ä»¶çš„ render æ–¹æ³•</p>
<p>æ­£ç¡®ä½¿ç”¨ Stateï¼š</p>
<ul>
<li><p>é™¤äº†åœ¨æ„é€ å‡½æ•°ä¸­å…¶ä»–åœ°æ–¹éƒ½ä¸è¦ç›´æ¥ç»™ state èµ‹å€¼çš„æ–¹å¼ä¿®æ”¹å®ƒï¼Œåº”è¯¥ä½¿ç”¨ <code>setState()</code></p>
</li>
<li><p>state çš„æ›´æ–°å¯èƒ½æ˜¯å¼‚æ­¥çš„ï¼ŒReact å¯èƒ½ä¼šæŠŠå¤šä¸ª <code>setState()</code> è°ƒç”¨åˆå¹¶æˆä¸€ä¸ªè°ƒç”¨ï¼ˆå’Œ vue ç±»ä¼¼ï¼‰</p>
<p>æ‰€ä»¥ä¸è¦ä¾èµ– <code>this.state</code> æˆ– <code>this.props</code> çš„å€¼æ¥æ›´æ–°ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œå¦‚æœéœ€è¦ï¼Œå¯ä»¥åœ¨ <code>setState()</code> ä¸­ä¼ å…¥ä¸€ä¸ªå‡½æ•° <code>(state, props) =&gt; &#123;&#125;</code> ï¼Œå…¶ä¸­ state æ˜¯ä¸Šä¸€ä¸ª stateï¼Œprops æ˜¯æ­¤æ¬¡æ›´æ–°æ—¶è¢«åº”ç”¨çš„ props</p>
</li>
<li><p>stateçš„æ›´æ–°ä¼šè¢«åˆå¹¶ï¼Œ<code>setState()</code> ä¼ å…¥çš„å¯¹è±¡ä¼š assign åˆ°ç°æœ‰çš„ state ä¸Šï¼ŒåŒæ ·ä¹Ÿæ˜¯æµ…åˆå¹¶</p>
</li>
</ul>
<p><strong>æ•°æ®æ˜¯å‘ä¸‹æµåŠ¨çš„</strong>ï¼Œstate åªèƒ½ç”±æœ¬ç»„ä»¶è®¿é—®ï¼Œå¯ä»¥é€šè¿‡ props çš„æ–¹å¼å‘ä¸‹ä¼ é€’ï¼Œå•å‘æ•°æ®æµ</p>
<h2 id="äº‹ä»¶å¤„ç†"><a href="#äº‹ä»¶å¤„ç†" class="headerlink" title="äº‹ä»¶å¤„ç†"></a>äº‹ä»¶å¤„ç†</h2><p>this è¦æ‰‹åŠ¨æ·»åŠ ç»‘å®šï¼ˆè§£é‡Šå¯ä»¥å‚è€ƒ <a target="_blank" rel="noopener" href="https://blog.csdn.net/corner2030/article/details/97802475?depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1&utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1">è¿™ä¸€ç¯‡</a>ï¼‰</p>
<h2 id="æ¡ä»¶æ¸²æŸ“"><a href="#æ¡ä»¶æ¸²æŸ“" class="headerlink" title="æ¡ä»¶æ¸²æŸ“"></a>æ¡ä»¶æ¸²æŸ“</h2><ul>
<li>if</li>
<li>å¯ä»¥ç”¨å˜é‡å‚¨å­˜å…ƒç´ </li>
<li>åˆ©ç”¨ js çš„ <code>&amp;&amp;</code> è¿ç®—ç¬¦</li>
<li>åˆ©ç”¨ js çš„ä¸‰ç›®è¿ç®—ç¬¦</li>
</ul>
<p>é˜»æ­¢ç»„ä»¶æ¸²æŸ“ï¼š<code>render</code> è¿”å› null</p>
<h2 id="åˆ—è¡¨-Key"><a href="#åˆ—è¡¨-Key" class="headerlink" title="åˆ—è¡¨ &amp; Key"></a>åˆ—è¡¨ &amp; Key</h2><p>æ¸²æŸ“å¤šä¸ªç»„ä»¶ï¼šæ„å»ºå…ƒç´ æ•°ç»„ï¼Œç„¶åå°†æ•°ç»„åŠ å…¥ JSX ä¸­</p>
<p>keyï¼ˆåŒ vueï¼‰ï¼š</p>
<ul>
<li>åœ¨æ•°ç»„çš„ä¸Šä¸‹æ–‡ä¸­æŒ‡å®šï¼ˆé€šå¸¸æ˜¯åœ¨ <code>map</code> æ–¹æ³•ä¸­çš„å…ƒç´ ï¼‰</li>
<li>key åªæ˜¯åœ¨å…„å¼ŸèŠ‚ç‚¹ä¹‹é—´å¿…é¡»å”¯ä¸€</li>
</ul>
<h2 id="è¡¨å•"><a href="#è¡¨å•" class="headerlink" title="è¡¨å•"></a>è¡¨å•</h2><p>å—æ§ç»„ä»¶ï¼šstate æ˜¯å”¯ä¸€æ•°æ®æºï¼ˆä¸ v-model ç±»ä¼¼ï¼Œè¡¨å•é¡¹çš„ <code>value</code> èµ‹å€¼ä¸º <code>state</code> ä¸­çš„å€¼ï¼Œè¾“å…¥äº‹ä»¶æŒ‡å®šä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°å†…ä½¿ç”¨ <code>setState()</code> æ”¹å˜ state -&gt; ä»è€Œä½¿å¾— value å€¼å‘ç”Ÿæ”¹å˜ï¼‰</p>
<p>å¦‚æœåœ¨å—æ§ç»„ä»¶ä¸ŠæŠŠ value æŒ‡å®šæˆäº† prop åˆ™ä¼šé˜»æ­¢ç”¨æˆ·æ›´æ”¹è¾“å…¥</p>
<p>ä½†æ˜¯å¯¹äºåƒ <code>&lt;input type=&quot;file&quot; /&gt;</code> è¿™ç§ value åªè¯»çš„ç»„ä»¶ï¼Œå±äºéå—æ§ç»„ä»¶</p>
<h2 id="çŠ¶æ€æå‡"><a href="#çŠ¶æ€æå‡" class="headerlink" title="çŠ¶æ€æå‡"></a>çŠ¶æ€æå‡</h2><p>å°†å¤šä¸ªç»„ä»¶ä¸­éœ€è¦å…±äº«çš„ state å‘ä¸Šç§»åŠ¨åˆ°å®ƒä»¬çš„æœ€è¿‘å…±åŒçˆ¶ç»„ä»¶ä¸­</p>
<p>å’Œå—æ§ç»„ä»¶ä¸€æ ·ï¼Œçˆ¶ç»„ä»¶æä¾› value å’Œ onChangeï¼ˆæˆ–è€…ä»»ä½•å‘½åï¼‰ï¼Œä½œä¸º props ä¼ é€’ç»™å­ç»„ä»¶ï¼Œå­ç»„ä»¶åªè´Ÿè´£å±•ç¤º+ç›‘å¬å€¼å˜åŒ–æ—¶é€šè¿‡è°ƒç”¨çˆ¶ç»„ä»¶ä¼ æ¥çš„å¤„ç†å‡½æ•°æŠŠå€¼ä¼ ä¸Šå»</p>
<p>ä»»ä½•å¯å˜æ•°æ®åº”å½“åªæœ‰ä¸€ä¸ªç›¸å¯¹åº”çš„å”¯ä¸€æ•°æ®æºï¼Œåº”å½“ä¾é è‡ªä¸Šè€Œä¸‹çš„æ•°æ®æµï¼Œè€Œä¸æ˜¯å°è¯•åœ¨ä¸åŒç»„ä»¶é—´åŒæ­¥ state</p>
<p>å¦‚æœæŸäº›æ•°æ®å¯ä»¥ç”± props æˆ– state æ¨å¯¼å¾—å‡ºï¼Œé‚£ä¹ˆå®ƒå°±ä¸åº”è¯¥å­˜åœ¨äº state ä¸­</p>
<h2 id="ç»„åˆ-vs-ç»§æ‰¿"><a href="#ç»„åˆ-vs-ç»§æ‰¿" class="headerlink" title="ç»„åˆ vs ç»§æ‰¿"></a>ç»„åˆ vs ç»§æ‰¿</h2><ul>
<li><p>åŒ…å«å…³ç³»ï¼šç»„åˆ</p>
<p>props.childrenï¼ˆç±»ä¼¼äº vue åŒ¿å slotï¼‰ï¼›æˆ–è€…è‡ªå·±å‘½å propsï¼ˆç±»ä¼¼äº vue å…·å slotï¼‰</p>
</li>
<li><p>ç‰¹ä¾‹å…³ç³»ï¼šprops</p>
<p>é€šè¿‡ç»™ä¸€èˆ¬ç»„ä»¶æŒ‡å®š props æ¥å®šåˆ¶ç‰¹æ®Šç»„ä»¶</p>
</li>
<li><p>ç»§æ‰¿å…³ç³»ï¼šReact ä¸éœ€è¦ç»§æ‰¿æ¥æ„å»ºç»„ä»¶å±‚æ¬¡ï¼Œprops å’Œç»„åˆèƒ½å¤Ÿå®Œæˆç»„ä»¶é—´å¤ç”¨ uiï¼ˆåŒ…æ‹¬å¤–è§‚å’Œè¡Œä¸ºï¼‰ï¼Œå¦‚æœéœ€è¦å¤ç”¨é ui çš„åŠŸèƒ½ï¼Œå»ºè®®å°†å…¶æå–ä¸ºä¸€ä¸ªå•ç‹¬çš„ js æ¨¡å—ï¼Œç»„ä»¶å¯ä»¥ç›´æ¥ import è€Œæ— éœ€é€šè¿‡ extend ç»§æ‰¿å®ƒä»¬</p>
</li>
</ul>
<h2 id="React-å“²å­¦"><a href="#React-å“²å­¦" class="headerlink" title="React å“²å­¦"></a>React å“²å­¦</h2><ol>
<li><p>å°†è®¾è®¡å¥½çš„ UI åˆ’åˆ†ä¸ºç»„ä»¶å±‚çº§</p>
<p>åœˆå‡ºæ¯ä¸ªç»„ä»¶ï¼Œå¹¶ä»¥åˆé€‚çš„åç§°å‘½å</p>
<p>åˆ’åˆ†ç»„ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œæ ¹æ®å•ä¸€åŠŸèƒ½åŸåˆ™åˆ¤å®šç»„ä»¶çš„èŒƒå›´</p>
</li>
<li><p>ç”¨ React åˆ›å»ºä¸€ä¸ªé™æ€ç‰ˆæœ¬</p>
<p>å…ˆç”¨å·²æœ‰çš„æ•°æ®æ¨¡å‹æ¸²æŸ“ä¸€ä¸ªä¸åŒ…å«äº¤äº’åŠŸèƒ½çš„ UIï¼ˆç¼–å†™ä¸€ä¸ªåº”ç”¨çš„é™æ€ç‰ˆæœ¬æ—¶ï¼Œå¾€å¾€éœ€è¦ç¼–å†™å¤§é‡ä»£ç è€Œä¸éœ€è¦è€ƒè™‘å¤ªå¤šäº¤äº’ç»†èŠ‚ï¼›æ·»åŠ äº¤äº’åŠŸèƒ½æ—¶åˆ™è¦è€ƒè™‘å¤§é‡ç»†èŠ‚è€Œä¸éœ€è¦ç¼–å†™å¤ªå¤šä»£ç ï¼‰</p>
<p>åªä½¿ç”¨ propsï¼Œå®Œå…¨ä¸åº”è¯¥ä½¿ç”¨ state æ„å»ºé™æ€ç‰ˆæœ¬ï¼ˆstate ä»£è¡¨äº†éšæ—¶é—´ä¼šäº§ç”Ÿå˜åŒ–çš„æ•°æ®ï¼Œåº”å½“ä»…åœ¨å®ç°äº¤äº’æ—¶ä½¿ç”¨ï¼‰</p>
<p>è¿™äº›ç»„ä»¶ç›®å‰åªéœ€æä¾› <code>render()</code> æ–¹æ³•ç”¨äºæ¸²æŸ“ï¼Œæœ€é¡¶å±‚çš„ç»„ä»¶é€šè¿‡ props æ¥å—æ•°æ®æ¨¡å‹ï¼Œ<strong>å•å‘æ•°æ®æµ</strong></p>
</li>
<li><p>ç¡®å®š UI state çš„æœ€å°ï¼ˆä¸”å®Œæ•´ï¼‰è¡¨ç¤º</p>
<p>DRY: Donâ€™t Repeat Yourselfï¼Œåªä¿ç•™åº”ç”¨æ‰€éœ€çš„å¯å˜ state çš„æœ€å°é›†åˆï¼Œå…¶ä»–æ•°æ®å‡ç”±å®ƒä»¬è®¡ç®—äº§ç”Ÿ</p>
<p>éçˆ¶ç»„ä»¶ props ä¼ é€’æ¥çš„ã€éšç€æ—¶é—´æ¨ç§»æ”¹å˜çš„ã€ä¸èƒ½æ ¹æ®å…¶ä»– state æˆ– props è®¡ç®—å‡ºè¯¥æ•°æ®çš„å€¼ &#x3D;&gt; æ˜¯ state</p>
</li>
<li><p>ç¡®å®š state æ”¾ç½®çš„ä½ç½®</p>
<p>æ‰¾åˆ°æ ¹æ®è¿™ä¸ª state è¿›è¡Œæ¸²æŸ“çš„æ‰€æœ‰ç»„ä»¶ -&gt; æ‰¾åˆ°ä»–ä»¬çš„å…±åŒæ‰€æœ‰è€…ç»„ä»¶ï¼ˆåœ¨ç»„ä»¶å±‚çº§ä¸Šé«˜äºæ‰€æœ‰éœ€è¦è¯¥ state çš„ç»„ä»¶ï¼‰-&gt; è¯¥å…±åŒæ‰€æœ‰è€…æˆ–è€…æ¯”å®ƒå±‚çº§æ›´é«˜çš„ç»„ä»¶åº”è¯¥æ‹¥æœ‰è¯¥ state -&gt; å¦‚æœä½ æ‰¾ä¸åˆ°ä¸€ä¸ªåˆé€‚çš„ä½ç½®æ¥å­˜æ”¾è¯¥ stateï¼Œå¯ä»¥ç›´æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç»„ä»¶æ¥å­˜æ”¾ï¼Œå¹¶å°†è¿™ä¸€æ–°ç»„ä»¶ç½®äºé«˜äºå…±åŒæ‰€æœ‰è€…ç»„ä»¶å±‚çº§çš„ä½ç½®</p>
</li>
<li><p>æ·»åŠ åå‘æ•°æ®æµ</p>
<p>å¼€å§‹è‡ªä¸‹è€Œä¸Šè°ƒ callback ä¼ é€’æ•°æ®ä¸Šå»ç»™ state æ‰€åœ¨</p>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="ce">
    <link itemprop="mainEntityOfPage" href="https://hayahayao.github.io/2020/04/04/Git%E5%8E%9F%E7%90%86&%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="hayahayao">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ã•ãŠã‚Šã®Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/04/Git%E5%8E%9F%E7%90%86&%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" class="post-title-link" itemprop="url">GitåŸç†&å¸¸ç”¨å‘½ä»¤</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-04 18:59:00" itemprop="dateCreated datePublished" datetime="2020-04-04T18:59:00+08:00">2020-04-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-08-23 01:33:23" itemprop="dateModified" datetime="2023-08-23T01:33:23+08:00">2023-08-23</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Git"><a href="#Git" class="headerlink" title="Git"></a>Git</h1><h2 id="å·¥ä½œåŸç†"><a href="#å·¥ä½œåŸç†" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h2><p>git ç»´æŠ¤ä¸‰æ£µæ ‘ï¼š</p>
<ul>
<li>working directoryï¼šå·¥ä½œç›®å½•</li>
<li>stage(index)ï¼šç¼“å­˜</li>
<li>historyï¼šcommit å†å²</li>
</ul>
<p>å¯ä»¥å‚è€ƒè¿™ä¸ª <a target="_blank" rel="noopener" href="https://github.com/geeeeeeeeek/git-recipes/wiki/4.1-%E5%9B%BE%E8%A7%A3-Git-%E5%91%BD%E4%BB%A4">å›¾è§£ Git å‘½ä»¤</a></p>
<h2 id="è·å–-åˆ›å»ºé¡¹ç›®"><a href="#è·å–-åˆ›å»ºé¡¹ç›®" class="headerlink" title="è·å–&#x2F;åˆ›å»ºé¡¹ç›®"></a>è·å–&#x2F;åˆ›å»ºé¡¹ç›®</h2><h3 id="init"><a href="#init" class="headerlink" title="init"></a>init</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init &lt;directory&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init <span class="literal">--bare</span> &lt;directory&gt;</span><br></pre></td></tr></table></figure>

<p>åˆå§‹åŒ–ä¸€ä¸ªè£¸çš„ï¼ˆæ²¡æœ‰å·¥ä½œç›®å½•çš„ï¼‰ Git ä»“åº“ï¼Œä¸­å¤®ä»“åº“åº”è¯¥æ€»æ˜¯ç”¨ â€“bare æ ‡è®°åˆ›å»ºï¼Œå› ä¸ºå‘éè£¸ä»“åº“æ¨é€åˆ†æ”¯æœ‰å¯èƒ½ä¼šè¦†ç›–å·²æœ‰çš„ä»£ç å˜åŠ¨ã€‚å°† bare çœ‹ä½œæ˜¯å°†ä»“åº“æ ‡è®°ä¸ºå‚¨å­˜è®¾æ–½è€Œä¸æ˜¯å¼€å‘ç¯å¢ƒï¼Œä¸­å¤®ä»“åº“æ˜¯è£¸ä»“åº“ï¼Œå¼€å‘è€…çš„æœ¬åœ°ä»“åº“æ˜¯éè£¸ä»“åº“ã€‚</p>
<h3 id="clone"><a href="#clone" class="headerlink" title="clone"></a>clone</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†ä½äº &lt;repo&gt; çš„ä»“åº“å…‹éš†åˆ°æœ¬åœ°æœºå™¨</span></span><br><span class="line">git clone &lt;repo&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†ä½äº &lt;repo&gt; çš„ä»“åº“å…‹éš†åˆ°æœ¬åœ°æœºå™¨ä¸Šçš„ &lt;directory&gt; ç›®å½•</span></span><br><span class="line">git clone &lt;repo&gt; &lt;directory&gt;</span><br></pre></td></tr></table></figure>

<h4 id="LF-CRLF"><a href="#LF-CRLF" class="headerlink" title="LF CRLF"></a>LF CRLF</h4><p>clone ä¸‹æ¥çš„ä¸œè¥¿æŠ¥ lf crlf çš„é”™è¯¯ï¼Œæ˜¯ç”±äº git clone çš„æ—¶å€™è‡ªåŠ¨è¿›è¡Œäº†è½¬æ¢ï¼Œå¯ä»¥å¦‚ä¸‹è®¾ç½®å…³é—­</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config <span class="literal">--global</span> core.autocrlf false</span><br></pre></td></tr></table></figure>

<h3 id="submodule"><a href="#submodule" class="headerlink" title="submodule"></a>submodule</h3><p>å¯ä»¥é€šè¿‡ git submodule é…ç½®å­æ¨¡å—ï¼Œgit ä¼šåœ¨çˆ¶çº§ç›®å½•ä¸­ç”¨ .gitmodules æ–‡ä»¶è®°å½•</p>
<h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><h3 id="config"><a href="#config" class="headerlink" title="config"></a>config</h3><p>å¸¸è§é…ç½®</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">git config user.name &lt;name&gt;</span><br><span class="line">git config <span class="literal">--global</span> user.name &lt;name&gt;</span><br><span class="line">git config <span class="literal">--global</span> user.email &lt;email&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸º git å‘½ä»¤åˆ›å»ºä¸€ä¸ªå¿«æ·æ–¹å¼ï¼ˆåˆ«åï¼‰</span></span><br><span class="line">git config <span class="literal">--global</span> alias.&lt;alias<span class="literal">-name</span>&gt; &lt;git<span class="literal">-command</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰å½“å‰æœºå™¨æ‰€æœ‰ç”¨æˆ·ä½¿ç”¨å‘½ä»¤æ—¶ç”¨åˆ°çš„æ–‡æœ¬ç¼–è¾‘å™¨</span></span><br><span class="line">git config <span class="literal">--system</span> core.editor &lt;editor&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å…¨å±€é…ç½®æ–‡ä»¶ï¼Œæ‰‹åŠ¨ç¼–è¾‘</span></span><br><span class="line">git config <span class="literal">--global</span> <span class="literal">--edit</span></span><br></pre></td></tr></table></figure>

<p>git çš„é…ç½®é¡¹å­˜å‚¨ä½ç½®ï¼š</p>
<ul>
<li>&#x2F;.git&#x2F;config â€“ ç‰¹å®šä»“åº“çš„è®¾ç½®ã€‚</li>
<li>~&#x2F;.gitconfig â€“ ç‰¹å®šç”¨æˆ·çš„è®¾ç½®ã€‚è¿™ä¹Ÿæ˜¯ <code>--global</code> æ ‡è®°çš„è®¾ç½®é¡¹å­˜æ”¾çš„ä½ç½®ã€‚</li>
<li>$(prefix)&#x2F;etc&#x2F;gitconfig â€“ ç³»ç»Ÿå±‚é¢çš„è®¾ç½®ã€‚</li>
</ul>
<h4 id="å¿½ç•¥ç‰¹å®šæ–‡ä»¶"><a href="#å¿½ç•¥ç‰¹å®šæ–‡ä»¶" class="headerlink" title="å¿½ç•¥ç‰¹å®šæ–‡ä»¶"></a>å¿½ç•¥ç‰¹å®šæ–‡ä»¶</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">update-index</span> <span class="literal">--assume-unchanged</span> PATH</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœæƒ³æ’¤é”€è¿™ä¸ªæ“ä½œ</span></span><br><span class="line">git <span class="built_in">update-index</span> <span class="literal">--no-assume-unchanged</span> PATH</span><br></pre></td></tr></table></figure>

<h2 id="åŸºæœ¬å¿«ç…§æ“ä½œ"><a href="#åŸºæœ¬å¿«ç…§æ“ä½œ" class="headerlink" title="åŸºæœ¬å¿«ç…§æ“ä½œ"></a>åŸºæœ¬å¿«ç…§æ“ä½œ</h2><h3 id="add"><a href="#add" class="headerlink" title="add"></a>add</h3><p>å°†å·¥ä½œç›®å½•ä¸­çš„å˜åŒ–æ·»åŠ åˆ°ç¼“å†²åŒºï¼Œç¼“å­˜æ›´æ”¹</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">git add &lt;file&gt;</span><br><span class="line">git add &lt;directory&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># äº¤äº’å¼çš„ç¼“å­˜</span></span><br><span class="line">git add <span class="literal">-p</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯ä»¥æ§åˆ¶é‚£äº›è¡Œè¢«åŠ è¿›å»</span></span><br><span class="line">git add <span class="literal">--edit</span></span><br></pre></td></tr></table></figure>

<h3 id="commit"><a href="#commit" class="headerlink" title="commit"></a>commit</h3><p>å°†ç¼“å­˜çš„å¿«ç…§æäº¤åˆ°é¡¹ç›®å†å²</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿è¡Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œç­‰å¾…è¾“å…¥æäº¤ä¿¡æ¯</span></span><br><span class="line">git commit</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°† &lt;message&gt; ä½œä¸ºæäº¤ä¿¡æ¯</span></span><br><span class="line">git commit <span class="literal">-m</span> <span class="string">&quot;&lt;message&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªåŠ¨æ·»åŠ ç¼“å†²å’Œæäº¤ï¼Œé™¤äº† new files</span></span><br><span class="line">git commit <span class="literal">-a</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå¹¶ index å’Œä¸Šä¸€æ¬¡ commit æäº¤ï¼Œä¸”ä¸ä¿®æ”¹ commit message</span></span><br><span class="line"><span class="comment"># amend ä¼šä¿®æ”¹ commit çš„ hash å€¼ï¼Œæ— è®ºæœ‰æ²¡æœ‰å®é™…æ–‡ä»¶å˜åŒ–/message å˜åŒ–</span></span><br><span class="line">git commit <span class="literal">--amend</span> <span class="literal">--no-edit</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼ºåˆ¶è®¾å®š commit æ—¥æœŸ</span></span><br><span class="line">git commit <span class="literal">--date</span>=&lt;date&gt;</span><br></pre></td></tr></table></figure>

<h3 id="status"><a href="#status" class="headerlink" title="status"></a>status</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git status</span><br></pre></td></tr></table></figure>

<p>æ–‡ä»¶çŠ¶æ€ï¼š</p>
<ul>
<li>modified, to be commitedï¼šå·²ç¼“å­˜</li>
<li>not staged for commitï¼šæœªç¼“å­˜</li>
<li>untrackedï¼šæœªè¿½è¸ª</li>
</ul>
<h3 id="rm"><a href="#rm" class="headerlink" title="rm"></a>rm</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># = rm ä¸”é»˜è®¤ï¼ˆ-fï¼‰add file</span></span><br><span class="line"><span class="comment"># ä» index å’Œæœ¬åœ°éƒ½åˆ é™¤</span></span><br><span class="line"><span class="comment"># ä¸‹æ¬¡ commit æ—¶ä¼šä¿®æ”¹ git ä»“åº“</span></span><br><span class="line">git <span class="built_in">rm</span> &lt;file&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä» index é‡Œé¢åˆ é™¤æ–‡ä»¶ï¼Œä½†æœ¬åœ°çš„æ–‡ä»¶è¿˜ä¿ç•™</span></span><br><span class="line"><span class="comment"># å³â€œåœæ­¢è·Ÿè¸ªâ€è¿™äº›æ–‡ä»¶</span></span><br><span class="line">git <span class="built_in">rm</span> <span class="literal">--cached</span> file</span><br></pre></td></tr></table></figure>

<h3 id="mv"><a href="#mv" class="headerlink" title="mv"></a>mv</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é‡å‘½åä¸€ä¸ªæ–‡ä»¶</span></span><br><span class="line">git <span class="built_in">mv</span> &lt;source&gt; &lt;destination&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç§»åŠ¨ä¸€ä¸ªæ–‡ä»¶</span></span><br><span class="line">git <span class="built_in">mv</span> &lt;source&gt; &lt;destination directory&gt;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ git mv å»ç§»åŠ¨ç›¸å½“äºè‡ªåŠ¨ add åˆ° stage ä¸­ï¼Œä¸ç”¨æ‰‹åŠ¨ git add</p>
<h3 id="reset"><a href="#reset" class="headerlink" title="reset"></a>reset</h3><p>æ”¹å˜ HEAD æŒ‡å‘çš„ commitï¼Œå¹¶æœ‰é€‰æ‹©åœ°å˜åŠ¨ working directory å’Œ indexï¼›ä¹Ÿç”¨æ¥åœ¨ä»  commit å†å²ä¸­å¤åˆ¶æ–‡ä»¶åˆ° indexï¼Œè€Œä¸åŠ¨ working directory</p>
<p>reset å¯ä»¥ç†è§£ä¸ºé‡è®¾ï¼Œè€Œ revert æ˜¯æ’¤é”€ï¼šreset ç§»é™¤æ‰åé¢æ‰€æœ‰çš„ commitï¼Œå¦‚æœæƒ³æ¢å¤åªèƒ½è‡ªå·±é‡æ–°æäº¤ï¼Œè¿™ä¸ªé‡è®¾æ˜¯æ°¸è¿œçš„ï¼Œæ”¹äº†å°±å†ä¹Ÿæ‰¾ä¸å›æ¥äº†ï¼Œæ‰€ä»¥è¦å°å¿ƒï¼Œæœ€å¥½åªç”¨åœ¨æœ¬åœ°ä¿®æ”¹</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å½“å‰ HEAD æŒ‡å‘ &lt;commit&gt;</span></span><br><span class="line"><span class="comment"># æœ‰å‡ ç§å¸¸ç”¨ mode</span></span><br><span class="line"><span class="comment"># --softï¼šä¸æ”¹å˜ index å’Œ working tree</span></span><br><span class="line"><span class="comment"># --mixedï¼šæ”¹å˜ indexï¼Œä¸æ”¹å˜ working tree</span></span><br><span class="line"><span class="comment"># --hardï¼šæ”¹å˜ index å’Œ working tree</span></span><br><span class="line">git reset [&lt;<span class="type">mode</span>&gt;] [&lt;<span class="type">commit</span>&gt;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ²¡æœ‰ç»™å‡º commit ç‰ˆæœ¬åˆ™é»˜è®¤ HEAD</span></span><br><span class="line"><span class="comment"># mode ä¸ä¸º soft çš„æ—¶å€™éƒ½æ˜¯æ”¹å˜ index ä½†ä¸æ”¹å˜ working tree</span></span><br><span class="line">git reset</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŠŠ tree-ish(commit) ä¸­çš„ file å¤åˆ¶åˆ°å½“å‰ index</span></span><br><span class="line">git reset &lt;tree<span class="literal">-ish</span>&gt; <span class="literal">--</span> &lt;files&gt;</span><br></pre></td></tr></table></figure>

<h3 id="restore"><a href="#restore" class="headerlink" title="restore"></a>restore</h3><p>å¯ä»¥é€šè¿‡ git reflog æŸ¥çœ‹æ—¥å¿—ï¼Œæ‰¾åˆ° reset å‰çš„ commitï¼Œç„¶åç”¨ restore å°† working directory æ¢å¤ï¼ˆä½†æ˜¯commit ä¸ä¼šæ¢å¤ï¼Œè¦é‡æ–°æäº¤ï¼‰</p>
<h2 id="åˆ†æ”¯ä¸åˆå¹¶"><a href="#åˆ†æ”¯ä¸åˆå¹¶" class="headerlink" title="åˆ†æ”¯ä¸åˆå¹¶"></a>åˆ†æ”¯ä¸åˆå¹¶</h2><h3 id="branch"><a href="#branch" class="headerlink" title="branch"></a>branch</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ—å‡ºï¼ˆæœ¬åœ°ï¼‰ä»“åº“ä¸­æ‰€æœ‰åˆ†æ”¯</span></span><br><span class="line">git branch</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line">git branch <span class="literal">-r</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªåä¸º branch çš„åˆ†æ”¯ï¼ˆä½†ä¸ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°é‚£ä¸ªåˆ†æ”¯ï¼‰</span></span><br><span class="line">git branch &lt;branch&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤æŒ‡å®šåˆ†æ”¯</span></span><br><span class="line"><span class="comment"># å®‰å…¨æ“ä½œï¼ŒGit ä¼šé˜»æ­¢ä½ åˆ é™¤æœªåˆå¹¶æ›´æ”¹çš„åˆ†æ”¯</span></span><br><span class="line">git branch <span class="literal">-d</span> &lt;branch&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼ºåˆ¶åˆ é™¤æŒ‡å®šåˆ†æ”¯ï¼Œå³ä½¿åŒ…å«æœªåˆå¹¶æ›´æ”¹</span></span><br><span class="line">git branch <span class="literal">-D</span> &lt;branch&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†å½“å‰åˆ†æ”¯å‘½åä¸º branch</span></span><br><span class="line">git branch <span class="literal">-m</span> &lt;branch&gt;</span><br></pre></td></tr></table></figure>

<p>Git çš„åˆ†æ”¯å®é™…ä¸Šæ˜¯æŒ‡å‘ commit çš„æŒ‡é’ˆï¼Œä»£è¡¨äº†ä¸€ç³»åˆ— commit çš„é¡¶ç«¯ï¼Œè€Œä¸æ˜¯ commit çš„å®¹å™¨ã€‚åˆ†æ”¯å†å²é€šè¿‡æäº¤ä¹‹é—´çš„å…³ç³»æ¥æ¨æ–­</p>
<p>æ‰€ä»¥ Git çš„åˆå¹¶å…¶å®æ˜¯å°†ä¸¤ä¸ªç‹¬ç«‹çš„ commit å†å²è¿æ¥èµ·æ¥ï¼Œè€Œä¸æ˜¯åŸºäºæ–‡ä»¶çš„æ“ä½œ</p>
<p>å› ä¸ºåˆ†æ”¯æœ¬è´¨æ˜¯ä¸ªæŒ‡é’ˆï¼Œæ‰€ä»¥åˆ›å»º&#x2F;åˆ é™¤åˆ†æ”¯éƒ½ä¸ä¼šå½±å“åˆ°ä»“åº“å†å²</p>
<p>åˆ é™¤åˆ†æ”¯æ—¶ Git ä¼šæ£€æŸ¥è¿™ä¸ªåˆ†æ”¯æ˜¯å¦å·²ç»è¢«åˆå¹¶ï¼Œå¦‚æœè¿˜æ²¡è¢«åˆå¹¶å°±åˆ é™¤ï¼Œé‚£å°±ç›¸å½“äºä¸¢å¤±äº†è¿™æ®µå¼€å‘çº¿çš„å…¥å£ï¼ˆæŒ‡é’ˆï¼‰ï¼Œæ‰€ä»¥ Git ä¼šåšå‡ºé”™è¯¯æç¤º</p>
<h3 id="checkout"><a href="#checkout" class="headerlink" title="checkout"></a>checkout</h3><p>ä» commit history æˆ– index ä¸­æ‹·è´æ–‡ä»¶åˆ° working directoryï¼›æˆ–åˆ‡æ¢åˆ†æ”¯</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä»æŒ‡å®šçš„ commit ä¸­æ‹·è´æ–‡ä»¶åˆ° working directory</span></span><br><span class="line"><span class="comment"># å¦‚æœä¸æŒ‡å®š tree-ish åˆ™ä¼šä» index ä¸­æ‹·è´ç¼“å­˜çš„å†…å®¹åˆ° working directory</span></span><br><span class="line">git checkout &lt;tree<span class="literal">-ish</span>&gt; <span class="literal">--</span> &lt;files&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># HEAD ç§»åŠ¨åˆ° branch</span></span><br><span class="line"><span class="comment"># index å’Œ working directory ä¼šå’Œ HEAD å¯¹åº”çš„ commit èŠ‚ç‚¹ä¸€è‡´</span></span><br><span class="line"><span class="comment"># æ–° commit èŠ‚ç‚¹ä¸­æ‰€æœ‰æ–‡ä»¶éƒ½ä¼šè¢«å¤åˆ¶åˆ° index å’Œ working directory ä¸­</span></span><br><span class="line"><span class="comment"># åªå­˜åœ¨äºè€çš„ commit èŠ‚ç‚¹ä¸­çš„æ–‡ä»¶ä¼šè¢«åˆ é™¤</span></span><br><span class="line"><span class="comment"># ä¸å±äºä¸¤è€…çš„æ–‡ä»¶ä¼šè¢«å¿½ç•¥ï¼Œä¸å—å½±å“</span></span><br><span class="line">git checkout &lt;branch&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœä¸æŒ‡å®šæ–‡ä»¶å/åˆ†æ”¯åï¼Œè€Œæ˜¯ä¸€ä¸ªæ ‡ç­¾/è¿œç¨‹åˆ†æ”¯/SHA-1å€¼ï¼Œå°±ä¼šå¾—åˆ°ä¸€ä¸ªåŒ¿ååˆ†æ”¯</span></span><br><span class="line"><span class="comment"># ç§°ä½œ detached HEADï¼ˆåˆ†ç¦»çš„ HEADï¼‰</span></span><br><span class="line"><span class="comment"># åˆ†ç¦»çŠ¶æ€ï¼šæäº¤æ“ä½œå¯ä»¥æ­£å¸¸è¿›è¡Œï¼Œä½†æ˜¯ä¸ä¼šæ›´æ–°ä»»ä½•å·²å‘½åçš„åˆ†æ”¯ï¼ˆå…¶å®æ˜¯åœ¨æ›´æ–°åŒ¿ååˆ†æ”¯ï¼‰</span></span><br><span class="line"><span class="comment"># æ­¤åä¸€æ—¦åˆ‡æ¢åˆ°åˆ«çš„åˆ†æ”¯ï¼Œé‚£ä¹ˆè¿™ä¸ªæäº¤èŠ‚ç‚¹å› ä¸ºä¸ä¼šè¢«å¼•ç”¨æ‰ï¼Œæ‰€ä»¥å°±è¢«ä¸¢å¼ƒäº†</span></span><br><span class="line"><span class="comment"># å¦‚æœæƒ³è¦ä¿å­˜è¿™ä¸ªçŠ¶æ€ï¼Œå¯ä»¥é€šè¿‡ checkout -b name åˆ›å»ºä¸€ä¸ªæ–°çš„æœ‰åå­—çš„åˆ†æ”¯</span></span><br></pre></td></tr></table></figure>

<h4 id="é¡¹ç›®ä¸­å¯èƒ½å‡ºç°çš„æƒ…å†µ"><a href="#é¡¹ç›®ä¸­å¯èƒ½å‡ºç°çš„æƒ…å†µ" class="headerlink" title="é¡¹ç›®ä¸­å¯èƒ½å‡ºç°çš„æƒ…å†µ"></a>é¡¹ç›®ä¸­å¯èƒ½å‡ºç°çš„æƒ…å†µ</h4><p>ç”±äºå¸¸ç”¨çš„<code>npm run dev</code> ä¸€èˆ¬æ˜¯å¢é‡ç¼–è¯‘é…ç½®ï¼Œæ‰€ä»¥æœ‰æ—¶å€™åœ¨ä¸€ä¸ªåˆ†æ”¯ç¼–è¯‘å®Œ checkout åˆ°å¦ä¸€ä¸ªåˆ†æ”¯ï¼Œä½† &#x2F;dist é‡Œçš„ä¸œè¥¿ç”±äºè¢« ignore æ‰€ä»¥è¿˜ä¿ç•™ç€åŸåˆ†æ”¯çš„ä¸€äº›ä¿¡æ¯ï¼Œæœ€å¥½ checkout ä¹‹å rm &#x2F;dist å†é‡æ–°ç¼–è¯‘</p>
<h3 id="merge"><a href="#merge" class="headerlink" title="merge"></a>merge</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†æŒ‡å®šåˆ†æ”¯å¹¶å…¥å½“å‰åˆ†æ”¯</span></span><br><span class="line">git merge &lt;branch&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†åˆ¶å®šåˆ†æ”¯å¹¶å…¥å½“å‰åˆ†æ”¯</span></span><br><span class="line"><span class="comment"># ä½†æ€»æ˜¯ç”Ÿæˆä¸€ä¸ªåˆå¹¶æäº¤ï¼ˆå³ä½¿æ˜¯å¿«é€Ÿå‘å‰åˆå¹¶ï¼‰</span></span><br><span class="line">git merge <span class="literal">--no-ff</span> &lt;branch&gt;</span><br></pre></td></tr></table></figure>

<p>å½“å‰åˆ†æ”¯ä¼šè¢«æ›´æ–°ï¼Œä½†ç›®æ ‡åˆ†æ”¯å®Œå…¨ä¸å—å½±å“</p>
<p>åˆå¹¶ç®—æ³•ï¼š</p>
<ul>
<li>å¿«é€Ÿå‘å‰åˆå¹¶ï¼šå½“å½“å‰åˆ†æ”¯é¡¶ç«¯åˆ°ç›®æ ‡åˆ†æ”¯è·¯å¾„æ˜¯çº¿æ€§æ—¶ï¼ŒGit åªéœ€è¦å°†å½“æœŸåˆ†æ”¯é¡¶ç«¯ï¼ˆå¿«é€Ÿå‘å‰åœ°ï¼‰ç§»åŠ¨åˆ°ç›®æ ‡åˆ†æ”¯é¡¶ç«¯ï¼Œå³å¯æ•´åˆä¸¤ä¸ªåˆ†æ”¯çš„å†å²ï¼Œè€Œä¸éœ€è¦â€œçœŸæ­£â€åˆå¹¶åˆ†æ”¯ã€‚åœ¨æ•ˆæœä¸Šåˆå¹¶äº†å†å²ï¼Œå› ä¸ºç›®æ ‡åˆ†æ”¯ä¸Šçš„ commit ç°åœ¨åœ¨å½“å‰åˆ†æ”¯å¯ä»¥è®¿é—®åˆ°</li>
<li>ä¸‰è·¯åˆå¹¶ï¼šä½¿ç”¨ä¸€ä¸ªä¸“é—¨çš„ commit æ¥åˆå¹¶ä¸¤ä¸ªåˆ†æ”¯çš„å†å²ï¼ˆGit å®é™…ä¸Šä½¿ç”¨ä¸‰ä¸ª commit æ¥ç”Ÿæˆå®ƒï¼Œåˆ†åˆ«æ˜¯ä¸¤ä¸ªåˆ†æ”¯é¡¶ç«¯å’Œå®ƒä»¬å…±åŒçš„ç¥–å…ˆï¼‰</li>
</ul>
<p>é€šå¸¸ç”¨å¿«é€Ÿå‘å‰åˆå¹¶æ­é… rebase æ¥åˆå¹¶å¾®å°çš„åŠŸèƒ½æˆ–è€…ä¿®å¤ bugï¼Œä½¿ç”¨ä¸‰è·¯åˆå¹¶æ¥æ•´åˆé•¿æœŸè¿è¡Œçš„åŠŸèƒ½</p>
<h4 id="è§£å†³å†²çª"><a href="#è§£å†³å†²çª" class="headerlink" title="è§£å†³å†²çª"></a>è§£å†³å†²çª</h4><p>æ‰‹åŠ¨è§£å†³ï¼šmerge å‘ç°é”™è¯¯ -&gt; è‡ªå·±ä¿®å¤ -&gt; git add -&gt; git commit ç”Ÿæˆåˆå¹¶æäº¤</p>
<h3 id="stash"><a href="#stash" class="headerlink" title="stash"></a>stash</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">git stash</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ  meassage</span></span><br><span class="line">git stash push <span class="literal">-m</span> &lt;message&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼¹å‡ºä¸€ä¸ªå­˜å‚¨çš„ state</span></span><br><span class="line">git stash pop</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç±»ä¼¼äº stack peekï¼ŒæŸ¥çœ‹ä½†ä¸å¼¹å‡º</span></span><br><span class="line">git stash apply</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ—å‡ºç°æœ‰çš„ stash</span></span><br><span class="line">git stash list</span><br></pre></td></tr></table></figure>

<p>æŠŠç°åœ¨çš„ working directory å’Œ index å­˜èµ·æ¥ï¼Œä½†æ˜¯ä¸ commit åˆ° history ä»¥å…æ±¡æŸ“å†å²</p>
<h4 id="æ‰¾å›ä¸å°å¿ƒ-pop-drop-æ‰çš„-stash"><a href="#æ‰¾å›ä¸å°å¿ƒ-pop-drop-æ‰çš„-stash" class="headerlink" title="æ‰¾å›ä¸å°å¿ƒ pop&#x2F;drop æ‰çš„ stash"></a>æ‰¾å›ä¸å°å¿ƒ pop&#x2F;drop æ‰çš„ stash</h4><p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/89332/how-to-recover-a-dropped-stash-in-git#34666995">å‡ºå¤„</a></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> gitk <span class="literal">--all</span> <span class="variable">$</span>(git fsck <span class="literal">--no-reflog</span> | <span class="built_in">Select-String</span> <span class="string">&quot;(dangling commit )(.*)</span></span><br><span class="line"><span class="string">&quot;</span> | %&#123; <span class="variable">$_</span>.Line.Split(<span class="string">&#x27; &#x27;</span>)[<span class="number">2</span>] &#125;)</span><br></pre></td></tr></table></figure>

<p>ä¹‹åä¼šæ‰“å¼€ä¸€ä¸ª GUI ç•Œé¢ï¼Œåœ¨é‡Œé¢æ‰¾åˆ°ä½ ä¸¢å¤±æ‰çš„é‚£ä¸ª commit å€¼ä¹‹å <code>git stash apply &lt;commit&gt;</code> å³å¯</p>
<h3 id="tag"><a href="#tag" class="headerlink" title="tag"></a>tag</h3><p>é€šå¸¸åœ¨å‘å¸ƒç‰ˆæœ¬æ—¶æ‰“ä¸€ä¸ª tagï¼Œtag ä¼šè®°å½•ç‰ˆæœ¬çš„ commi å·ï¼Œæ–¹ä¾¿åæœŸå›æº¯</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ—å‡ºå·²æœ‰ tag</span></span><br><span class="line">git tag</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–°å»º tag</span></span><br><span class="line">git tag &lt;tagname&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¸¦å¤‡æ³¨çš„ tag</span></span><br><span class="line">git tag <span class="literal">-a</span> &lt;tagname&gt; <span class="literal">-m</span> &lt;msg&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»™æŒ‡å®šçš„æŸä¸ª commit åŠ  tag</span></span><br><span class="line">git tag <span class="literal">-a</span> &lt;tagname&gt; &lt;commit&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ tag è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">git show &lt;tagname&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°† tag åŒæ­¥åˆ°è¿œç¨‹æœåŠ¡å™¨</span></span><br><span class="line">git push origin &lt;tagname&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ‡æ¢ tag</span></span><br><span class="line"><span class="comment"># å½“ branch å’Œ tagname é‡åæ—¶å€™å¯ä»¥æŒ‡å®š tags/tagname</span></span><br><span class="line">git checkout &lt;tagname&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤ tag</span></span><br><span class="line">git tag <span class="literal">-d</span> &lt;tagname&gt;</span><br></pre></td></tr></table></figure>

<h2 id="åˆ†äº«æ›´æ–°é¡¹ç›®"><a href="#åˆ†äº«æ›´æ–°é¡¹ç›®" class="headerlink" title="åˆ†äº«æ›´æ–°é¡¹ç›®"></a>åˆ†äº«æ›´æ–°é¡¹ç›®</h2><h3 id="remote"><a href="#remote" class="headerlink" title="remote"></a>remote</h3><p>ç®¡ç†ä¸å…¶ä»–ä»“åº“ä¹‹é—´çš„è¿æ¥ï¼Œç”¨ä¹¦ç­¾ï¼ˆåˆ«åï¼‰çš„æ–¹å¼å»å¼•ç”¨å…¶ä»–ä»“åº“çš„ url è¿æ¥</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ—å‡ºè¿œç¨‹è¿æ¥åˆ—è¡¨</span></span><br><span class="line">git remote</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¸¦ url çš„åˆ—è¡¨</span></span><br><span class="line">git remote <span class="literal">-v</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ /åˆ é™¤è¿œç¨‹è¿æ¥</span></span><br><span class="line">git remote add &lt;name&gt; &lt;url&gt;</span><br><span class="line">git remote <span class="built_in">rm</span> &lt;name&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å‘½å</span></span><br><span class="line">git remote rename &lt;old<span class="literal">-name</span>&gt; &lt;<span class="built_in">new-name</span>&gt;</span><br></pre></td></tr></table></figure>

<p>git clone æ—¶ï¼Œè‡ªåŠ¨åˆ›å»ºäº†ä¸€ä¸ªåä¸º origin çš„è¿œç¨‹è¿æ¥ï¼ŒæŒ‡å‘è¢«å…‹éš†çš„ repoï¼ˆåŸºæœ¬ä¸Šéƒ½æ˜¯ä¸­å¤®ä»“åº“ï¼‰</p>
<p>http æˆ– ssh åè®®</p>
<h3 id="fetch"><a href="#fetch" class="headerlink" title="fetch"></a>fetch</h3><p>å°†è¿œç¨‹ä»“åº“çš„æäº¤æ‹‰åˆ°æœ¬åœ°ä»“åº“ï¼Œæ‹‰ä¸‹æ¥çš„æäº¤å‚¨å­˜ä¸ºè¿œç¨‹åˆ†æ”¯ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬ä¸€ç›´ç”¨çš„æ™®é€šçš„æœ¬åœ°åˆ†æ”¯</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‹‰å–ä»“åº“ä¸­çš„æ‰€æœ‰åˆ†æ”¯</span></span><br><span class="line">git fetch &lt;remote&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åªæ‹‰å–æŒ‡å®šåˆ†æ”¯</span></span><br><span class="line">git fetch &lt;remote&gt; &lt;branch&gt;</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æ‹‰ä¸‹æ¥çš„è¿œç¨‹åˆ†æ”¯æ—¶ï¼Œä¼šåƒ checkout ä¸€æ ·å¤„äºåˆ†ç¦» HEAD çŠ¶æ€ï¼ˆåŸºæœ¬ä¸Šå¯ä»¥è§†ä½œåªè¯»ï¼‰</p>
<p>å¦‚æœæ¥å—è¿œç¨‹åˆ†æ”¯åŒ…å«çš„æ›´æ”¹ï¼Œå¯ä»¥ç”¨ <code>git merge</code> å°†å®ƒå¹¶å…¥æœ¬åœ°åˆ†æ”¯</p>
<h3 id="pull"><a href="#pull" class="headerlink" title="pull"></a>pull</h3><p>&#x3D; fetch + merge</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># = fetch + merge origin/.</span></span><br><span class="line">git pull &lt;remote&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸ä¸Šä¸€ä¸ªå‘½ä»¤ç›¸åŒï¼Œä½†ä½¿ç”¨ rebase åˆå¹¶è¿œç¨‹åˆ†æ”¯ä¸æœ¬åœ°åˆ†æ”¯ï¼Œè€Œä¸æ˜¯ merge</span></span><br><span class="line"><span class="comment"># rebase å¯ä»¥ç”¨æ¥ä¿è¯é¡¹ç›®çš„çº¿æ€§å†å²ï¼Œ</span></span><br><span class="line">git pull <span class="literal">--rebase</span> &lt;remote&gt;</span><br></pre></td></tr></table></figure>

<h3 id="push"><a href="#push" class="headerlink" title="push"></a>push</h3><p>å°†æäº¤å¯¼å‡ºåˆ°è¿œç¨‹åˆ†æ”¯</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†æŒ‡å®šçš„åˆ†æ”¯æ¨é€åˆ° remote ä¸Š</span></span><br><span class="line"><span class="comment"># å¦‚æœå¯¼è‡´ç›®æ ‡ä»“åº“éå¿«é€Ÿå‘å‰åˆå¹¶æ—¶ï¼Œgit ä¸å…è®¸ push</span></span><br><span class="line"><span class="comment"># éå¿«é€Ÿå‘å‰åˆå¹¶æŒ‡çš„å°±æ˜¯è¦çœŸæ­£å‘ç”Ÿ merge çš„æƒ…å†µï¼ˆå³å·²ç»åˆ†å‰ï¼‰</span></span><br><span class="line">git push &lt;remote&gt; &lt;branch&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å³ä½¿ä¼šå¯¼è‡´éå¿«é€Ÿå‘å‰åˆå¹¶ä¹Ÿå¼ºåˆ¶æ¨é€</span></span><br><span class="line">git push &lt;remote&gt; <span class="literal">--force</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨é€æ‰€æœ‰æœ¬åœ°åˆ†æ”¯</span></span><br><span class="line">git push &lt;remote&gt; <span class="literal">--all</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†æ‰€æœ‰æœ¬åœ°æ ‡ç­¾æ¨é€åˆ°è¿œç¨‹ä»“åº“</span></span><br><span class="line"><span class="comment"># ä¸Šé¢çš„å†™æ³•éƒ½ä¸ä¼šè‡ªåŠ¨æ¨é€æ ‡ç­¾</span></span><br><span class="line">git push &lt;remote&gt; <span class="literal">--tags</span></span><br></pre></td></tr></table></figure>

<p>push å…¶å®ç›¸å½“äºåœ¨è¿œç¨‹ä»“åº“å†…éƒ¨è¿è¡Œ <code>git merge</code></p>
<p>åªåº”è¯¥æ¨é€åˆ°é‚£äº›ç”¨ â€“bare åˆå§‹åŒ–çš„ä»“åº“ï¼ˆè£¸ä»“åº“ï¼Œæ²¡æœ‰å·¥ä½œç›®å½•ï¼‰ã€‚å› ä¸º push ä¼šå¼„ä¹±è¿œç¨‹åˆ†æ”¯ç»“æ„ï¼Œæ‰€ä»¥æ°¸è¿œä¸è¦æ¨é€åˆ°å…¶ä»–å¼€å‘è€…çš„ä»“åº“</p>
<h4 id="å¼€å‘æ ‡å‡†åšæ³•"><a href="#å¼€å‘æ ‡å‡†åšæ³•" class="headerlink" title="å¼€å‘æ ‡å‡†åšæ³•"></a>å¼€å‘æ ‡å‡†åšæ³•</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git checkout master <span class="comment"># å‚è€ƒ checkout ä¸­çš„è§£é‡Šï¼Œæ³¨æ„å¹¶ä¸ä¼šé€ æˆå·¥ä½œä¸¢å¤±ï¼</span></span><br><span class="line">git fetch origin master <span class="comment"># ç¡®ä¿æœ¬åœ° master å’Œä¸­å¤®ä»“åº“ä¸€è‡´</span></span><br><span class="line">git rebase <span class="literal">-i</span> origin/master <span class="comment"># äº¤äº’å¼ rebaseï¼Œæ¸…ç† commit</span></span><br><span class="line">git push origin master <span class="comment"># ç¡®å®šæœ¬åœ° master æ˜¯æœ€æ–°çš„ï¼Œèƒ½å¤Ÿå¿«é€Ÿå‘å‰åˆå¹¶</span></span><br></pre></td></tr></table></figure>

<h2 id="å®¡æŸ¥æ¯”è¾ƒ"><a href="#å®¡æŸ¥æ¯”è¾ƒ" class="headerlink" title="å®¡æŸ¥æ¯”è¾ƒ"></a>å®¡æŸ¥æ¯”è¾ƒ</h2><h3 id="diff"><a href="#diff" class="headerlink" title="diff"></a>diff</h3><h4 id="è¡Œå·"><a href="#è¡Œå·" class="headerlink" title="è¡Œå·"></a>è¡Œå·</h4><p>git diff ä¸èƒ½ç›´æ¥å¾—åˆ°è¡Œå·ä¿¡æ¯ï¼Œè€Œæ˜¯ä¼šç»™å‡ºä¸€ä¸ª <a target="_blank" rel="noopener" href="http://www.gnu.org/software/diffutils/manual/html_node/Detailed-Unified.html#Detailed-Unified">unified-diff format</a> æ ¼å¼çš„ä¸œè¥¿ï¼š</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">@</span><span class="selector-tag">@</span> <span class="literal">-start</span>,count +<span class="built_in">start</span>,count <span class="selector-tag">@</span><span class="selector-tag">@</span></span><br></pre></td></tr></table></figure>

<p><code>-</code> æ ‡è®°çš„ä»£è¡¨åŸçŠ¶æ€çš„ä¿¡æ¯ï¼Œ<code>+</code> æ ‡è®°çš„ä»£è¡¨ç°çŠ¶æ€çš„ä¿¡æ¯</p>
<p><code>start</code> ä»£è¡¨åŸçŠ¶æ€&#x2F;ç°çŠ¶æ€çš„å¼€å§‹è¡Œå·ï¼Œ<code>count</code> ä»£è¡¨ä» start å¼€å§‹æœ‰å¤šå°‘è¡Œè¢«ä¿®æ”¹äº†</p>
<p>å®é™…æ•°èµ·æ¥æ˜¯è¿™æ ·çš„ï¼ˆä¾‹å­æ¥è‡ª <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/24455377/git-diff-with-line-numbers-git-log-with-line-numbers">stack overflow çš„è¿™ä¸ªå›ç­”</a>ï¼‰</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">diff</span> <span class="literal">--git</span> a/osx/.gitconfig b/osx/.gitconfig</span><br><span class="line">index <span class="number">4</span>fd8f04..fcd220c <span class="number">100644</span></span><br><span class="line"><span class="literal">---</span> a/osx/.gitconfig</span><br><span class="line">+++ b/osx/.gitconfig</span><br><span class="line"><span class="selector-tag">@</span><span class="selector-tag">@</span> <span class="literal">-11</span>,<span class="number">7</span> +<span class="number">11</span>,<span class="number">7</span> <span class="selector-tag">@</span><span class="selector-tag">@</span> &lt;== HERE!</span><br><span class="line"> [<span class="type">color</span> <span class="string">&quot;branch&quot;</span>]</span><br><span class="line">        upstream = cyan</span><br><span class="line"> [<span class="type">color</span> <span class="string">&quot;diff&quot;</span>]</span><br><span class="line">-       meta = yellow</span><br><span class="line">+       meta = cyan</span><br><span class="line">        plain = white dim</span><br><span class="line">        old = red bold</span><br><span class="line">        new = green bold</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„ 11 ä»£è¡¨ä¸‹é¢æ˜¾ç¤ºçš„è¿™äº›ä»£ç ä»ç¬¬ 11 è¡Œå¼€å§‹ï¼ŒåŒ…æ‹¬ 7 è¡Œï¼Œæ‰€ä»¥åŸæ–‡ä»¶ä¸­çš„è¡Œå·å…¶å®æ˜¯è¿™æ ·çš„</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">11</span>  [<span class="type">color</span> <span class="string">&quot;branch&quot;</span>]</span><br><span class="line"><span class="number">12</span>         upstream = cyan</span><br><span class="line"><span class="number">13</span>  [<span class="type">color</span> <span class="string">&quot;diff&quot;</span>]</span><br><span class="line"><span class="number">14</span> -       meta = yellow</span><br><span class="line"><span class="number">14</span> +       meta = cyan</span><br><span class="line"><span class="number">15</span>         plain = white dim</span><br><span class="line"><span class="number">16</span>         old = red bold</span><br><span class="line"><span class="number">17</span>         new = green bold</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥å®é™…è¢«ä¿®æ”¹çš„æ˜¯ç¬¬ 14 è¡Œã€‚</p>
<h2 id="æ‰“è¡¥ä¸"><a href="#æ‰“è¡¥ä¸" class="headerlink" title="æ‰“è¡¥ä¸"></a>æ‰“è¡¥ä¸</h2><h3 id="rebase"><a href="#rebase" class="headerlink" title="rebase"></a>rebase</h3><p>å°†åˆ†æ”¯ç§»åˆ°ä¸€ä¸ªæ–°çš„åŸº commit çš„è¿‡ç¨‹</p>
<p>rebase è¿™ä¸ªâ€œåŸºâ€ï¼ŒæŒ‡çš„æ˜¯ä¸‰è·¯åˆå¹¶æ—¶çš„é‚£ä¸ªåŸº commit</p>
<p>ä»å†…å®¹çš„è§’åº¦çœ‹ï¼Œrebase åªä¸è¿‡æ˜¯å°†åˆ†æ”¯ä»ä¸€ä¸ª commit ç§»åˆ°äº†å¦ä¸€ä¸ªï¼›ä½†æ˜¯ä»å†…éƒ¨æœºåˆ¶æ¥çœ‹ï¼Œ Git æ˜¯é€šè¿‡åœ¨é€‰å®šçš„åŸºä¸Šåˆ›å»ºæ–° commit æ¥å®Œæˆè¿™ä»¶äº‹çš„ï¼Œäº‹å®ä¸Šé‡å†™äº†é¡¹ç›®å†å²</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†å½“å‰åˆ†æ”¯ rebase åˆ° base</span></span><br><span class="line"><span class="comment"># base å¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„ commit å¼•ç”¨ï¼šIDã€åˆ†æ”¯åã€æ ‡ç­¾ã€æˆ–æ˜¯ HEAD çš„ç›¸å¯¹å¼•ç”¨</span></span><br><span class="line">git rebase &lt;base&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># äº¤äº’å¼çš„ rebase</span></span><br><span class="line"><span class="comment"># åœ¨è¿‡ç¨‹ä¸­å¯ä»¥ä¿®æ”¹æ¯ä¸ª commitï¼Œæ§åˆ¶å®ƒä»¬æ€æ ·è½¬ç§»åˆ°æ–°çš„åŸºä¸Šå»ï¼Œä¹Ÿå¯ä»¥å¯¹å®ƒä»¬è¿›è¡Œæ’åº</span></span><br><span class="line">git rebase <span class="literal">-i</span> &lt;base&gt;</span><br></pre></td></tr></table></figure>

<p>rebase çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†ä¿æŒä¸€ä¸ªçº¿æ€§çš„é¡¹ç›®å†å²</p>
<p>å°†è‡ªå·±çš„ feature åˆ†æ”¯æ•´åˆè¿› master åˆ†æ”¯ï¼Œæœ‰ä¸¤ä¸ªé€‰æ‹©ï¼š</p>
<ul>
<li>ç›´æ¥ mergeï¼Œä¼šäº§ç”Ÿä¸€ä¸ªä¸‰è·¯åˆå¹¶å’Œä¸€ä¸ªåˆå¹¶æäº¤</li>
<li>å…ˆ rebase åˆ° master HEAD å† mergeï¼Œäº§ç”Ÿä¸€ä¸ªå¿«é€Ÿå‘å‰çš„åˆå¹¶ä»¥åŠå®Œç¾çš„çº¿æ€§å†å²</li>
</ul>
<p>rebase æ˜¯å°†ä¸Šæ¸¸æ›´æ”¹åˆå¹¶è¿›æœ¬åœ°ä»“åº“çš„é€šå¸¸æ–¹æ³•ï¼Œâ€œæˆ‘æƒ³å°†æˆ‘çš„æ›´æ”¹å»ºç«‹åœ¨å…¶ä»–äººçš„è¿›å±•ä¹‹ä¸Šâ€çš„æ„Ÿè§‰</p>
<p>æœ¬è´¨ä¸Šæ˜¯çº¿æ€§åŒ–çš„è‡ªåŠ¨çš„ cherry-pick</p>
<h3 id="revert"><a href="#revert" class="headerlink" title="revert"></a>revert</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”Ÿæˆä¸€ä¸ªæ’¤é”€äº† commit å¼•å…¥çš„ä¿®æ”¹çš„æ–°æäº¤ï¼Œç„¶ååº”ç”¨åˆ°å½“å‰åˆ†æ”¯</span></span><br><span class="line">git revert &lt;commit&gt;</span><br></pre></td></tr></table></figure>

<p>åº”è¯¥ç”¨åœ¨æƒ³è¦åœ¨é¡¹ç›®å†å²ä¸­ç§»é™¤ä¸€æ•´ä¸ªæäº¤ï¼ˆé€šå¸¸æ˜¯å› ä¸ºè¿™ä¸ªæäº¤é€ æˆ bugï¼‰çš„æ—¶å€™</p>
<p>è¢«æ’¤é”€çš„æäº¤ä¾ç„¶åœ¨é¡¹ç›®å†å²ä¸­ï¼Œgit revert åœ¨åé¢å¢åŠ äº†ä¸€ä¸ªæäº¤æ¥æ’¤é”€ä¿®æ”¹ï¼Œè€Œä¸æ˜¯åˆ é™¤å®ƒ</p>
<h3 id="cherry-pick"><a href="#cherry-pick" class="headerlink" title="cherry-pick"></a>cherry-pick</h3><p>â€œå¤åˆ¶ä¸€ä¸ª commit èŠ‚ç‚¹å¹¶åœ¨å½“å‰åˆ†æ”¯åšä¸€æ¬¡å®Œå…¨ä¸€æ ·çš„æ–°æäº¤</p>
<h2 id="debug"><a href="#debug" class="headerlink" title="debug"></a>debug</h2><h3 id="blame"><a href="#blame" class="headerlink" title="blame"></a>blame</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git blame <span class="literal">--</span> &lt;file&gt;</span><br></pre></td></tr></table></figure>

<p>æ˜¾ç¤ºè¯¥æ–‡ä»¶çš„ä¿®æ”¹ï¼Œä»¥åŠæ¯ä¸ªä¿®æ”¹çš„ä½œè€…</p>
<h3 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h3><p>æ‰“å°å‡ºç¬¦åˆæŒ‡å®š pattern çš„è¡Œæ•°</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git grep &lt;pattern&gt; <span class="literal">--</span> &lt;files&gt;</span><br></pre></td></tr></table></figure>

<h3 id="bisect"><a href="#bisect" class="headerlink" title="bisect"></a>bisect</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git bisect &lt;subcommand&gt; &lt;options&gt;</span><br></pre></td></tr></table></figure>

<p>ç”¨äºŒåˆ†æŸ¥æ‰¾çš„æ–¹å¼æ‰¾å‡º bug æ¥è‡ªäºå“ªä¸ª commitï¼Œå…·ä½“è§ <a target="_blank" rel="noopener" href="https://git-scm.com/docs/git-bisect">å®˜æ–¹æ–‡æ¡£</a></p>
<h2 id="ç®¡ç†"><a href="#ç®¡ç†" class="headerlink" title="ç®¡ç†"></a>ç®¡ç†</h2><h3 id="reflog"><a href="#reflog" class="headerlink" title="reflog"></a>reflog</h3><p>æŸ¥çœ‹æ—¥å¿—</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">hayahayao</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">8</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">hayahayao</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
